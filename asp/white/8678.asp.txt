<%
if Year(Now)>2011 then strtmpYear = "-"&Year(Now)&" " end if 
SQL_injdata = "'|;|exec|insert|select|delete|update|count|*|%|chr|mid|master|truncate|char|declare"
SQL_inj = split(SQL_Injdata,"|")
If Request.QueryString<>"" Then
For Each SQL_Get In Request.QueryString
  For SQL_Data=0 To Ubound(SQL_inj)
    if instr(Request.QueryString(SQL_Get),Sql_Inj(Sql_DATA))>0 Then
     Response.Write "对不起！您提交的参数可能存在错误 ;请重新提交..."
	  response.End()
    end if
  next
Next
End If
strtmp="IFRAME"
strtemp=request.servervariables("server_name")&request.servervariables("url")&"?"&request.QueryString
strtemp=lcase(strtemp)
if instr(strtemp,"select%20") or instr(strtemp,"insert%20") or instr(strtemp,"delete%20from") or instr(strtemp,"count(") or instr(strtemp,"drop%20table") or instr(strtemp,"update%20") or instr(strtemp,"truncate%20") or instr(strtemp,"asc(") or instr(strtemp,"mid(") or instr(strtemp,"char(") or instr(strtemp,"xp_cmdshell") or instr(strtemp,"exec%20master") or instr(strtemp,"net%20user") or instr(strtemp,"'") or instr(strtemp,"%20") or instr(strtemp,"""") or instr(strtemp,"“") or instr(strtemp,"”") or instr(strtemp,";") or instr(strtemp,"; ") or instr(strtemp,"%27")  then
 response.write "对不起！您提交的参数可能存在错误 ;请重新提交... ..."
 response.End()
end if
Function Replace_Text(fString)
if isnull(fString) then
Replace_Text=""
exit function
else
fString=trim(fString)
fString=replace(fString," ","")
fString=replace(fString,"'","''")
fString=replace(fString,";","；")
fString=replace(fString,"--","―")
'fString=replace(fString,"and","")
'fString=replace(fString,"or","")
fString=replace(fString,"select","")
fString=replace(fString,"insert","")
fString=replace(fString,"exec","")
fString=replace(fString,"delete","")
fString=replace(fString,"update","")
fString=replace(fString,"count","")
fString=replace(fString,"mid","")
fString=replace(fString,"truncate","")
fString=replace(fString,"%","％")
fString=replace(fString,"chr","")
fString=replace(fString,"master","")
fString=replace(fString,"char","")
fString=replace(fString,"declare","")
fString=replace(fString,"*","×")
fString=replace(fString,"from","")
fString=server.htmlencode(fString)
Replace_Text=fString
end if	
End function
Function DelHtml(strHtml) 
Dim objRegExp, strOutput 
Set objRegExp = New Regexp 

objRegExp.IgnoreCase = True 
objRegExp.Global = True 
objRegExp.Pattern = "(<[a-zA-Z].*?>)|(<[\/][a-zA-Z].*?>)" 

strOutput = objRegExp.Replace(strHtml, "") 
strOutput = Replace(strOutput, "&nbsp;", "") 
strOutput = Replace(strOutput, " ", "") 
delHtml = strOutput 

Set objRegExp = Nothing 
End Function 
Bottdomain = "bingsns"
function Newdate(str,strlen)
	if str="" then
		newdate=""
		exit function
	end if
	dim l,t,c, i
	str=replace(replace(replace(replace(str,"&nbsp;"," "),"&quot;",chr(34)),"&gt;",">"),"&lt;","<")
	l=len(str)
	t=0
	for i=1 to l
		c=Abs(Asc(Mid(str,i,1)))
		if c>255 then
			t=t+2
		else
			t=t+1
		end if
		if t>=strlen then
			newdate=left(str,i) & "…"
			exit for
		else
			newdate=str
		end if
	next
	newdate=replace(replace(replace(replace(newdate," ","&nbsp;"),chr(34),"&quot;"),">","&gt;"),"<","&lt;")
end function
Function code_jk(strer)
  strer=strer
  if strer="" or isnull(strer) then
    code_jk="":exit function
  end if

  strer=replace(strer,"<","&lt;")
  strer=replace(strer,">","&gt;")
  strer=replace(strer,CHR(32),"&nbsp")    '空格
  strer=replace(strer,CHR(9),"&nbsp")    'table
  strer=replace(strer,CHR(39),"&#39;")    '单引号
  strer=replace(strer,CHR(34),"&quot;")    '双引号
  
  dim re
  set re=new RegExp
  re.IgnoreCase =true
  re.Global=true
  
  re.Pattern="(javascript)"
  strer=re.Replace(strer,"&#106avascript")
  re.Pattern="(jscript:)"
  strer=re.Replace(strer,"&#106script:")
  re.Pattern="(js:)"
  strer=re.Replace(strer,"&#106s:")
  re.Pattern="(value)"
  strer=re.Replace(strer,"&#118alue")
  re.Pattern="(about:)"
  strer=re.Replace(strer,"about&#58")
  re.Pattern="(file:)"
  strer=re.Replace(strer,"file&#58")
  re.Pattern="(document.cookie)"
  strer=re.Replace(strer,"documents&#46cookie")
  re.Pattern="(vbscript:)"
  strer=re.Replace(strer,"&#118bscript:")
  re.Pattern="(vbs:)"
  strer=re.Replace(strer,"&#118bs:")
  re.Pattern="(on(mouse|exit|error|click|key))"
  strer=re.Replace(strer,"&#111n$2")
  
  re.Pattern="\[pic\](http|https|ftp):\/\/(.[^\[]*)\[\/pic\]"
  strer=re.Replace(strer,"<IMG SRC='http://$2' border=0 onload=""javascript:if(this.width>screen.width-430)this.width=screen.width-430"">")
  re.Pattern="\[IMG\](http|https|ftp):\/\/(.[^\[]*)\[\/IMG\]"
  strer=re.Replace(strer,"<a href='http://$2' target=_blank><IMG SRC='http://$2' border=0 alt='按此在新窗口浏览图片' onload=""javascript:if(this.width>screen.width-430)this.width=screen.width-430""></a>")
  re.Pattern="(\[FLASH=*([0-9]*),*([0-9]*)\])(.[^\[]*)(\[\/FLASH\])"
  strer= re.Replace(strer,"<a href='$4' TARGET=_blank>[全屏欣赏]</a><br><OBJECT codeBase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=4,0,2,0 classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 width=$2 height=$3><PARAM NAME=movie VALUE='$4'><PARAM NAME=quality VALUE=high><embed src='$4' quality=high pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' type='application/x-shockwave-flash' width=$2 height=$3>$4</embed></OBJECT>")
  re.Pattern="(\[FLASH\])(http://.[^\[]*(.swf))(\[\/FLASH\])"
  strer= re.Replace(strer,"<a href=""$2"" TARGET=_blank>[全屏欣赏]</a><br><OBJECT codeBase=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=4,0,2,0 classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 width=500 height=400><PARAM NAME=movie VALUE=""$2""><PARAM NAME=quality VALUE=high><embed src=""$2"" quality=high pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' type='application/x-shockwave-flash' width=500 height=400>$2</embed></OBJECT>")
  re.Pattern="(\[URL\])(.[^\[]*)(\[\/URL\])"
  strer= re.Replace(strer,"<A HREF='$2' class=blue TARGET=_blank>$2</A>")
  re.Pattern="(\[URL=(.[^\[]*)\])(.[^\[]*)(\[\/URL\])"
  strer= re.Replace(strer,"<A HREF='$2' class=blue TARGET=_blank>$3</A>")
  re.Pattern="(\[EMAIL\])(\S+\@.[^\[]*)(\[\/EMAIL\])"
  strer= re.Replace(strer,"<A HREF=""mailto:$2"">$2</A>")
  re.Pattern="(\[EMAIL=(\S+\@.[^\[]*)\])(.[^\[]*)(\[\/EMAIL\])"
  strer= re.Replace(strer,"<A HREF=""mailto:$2"" TARGET=_blank>$3</A>")
  re.Pattern = "^(http://[A-Za-z0-9\./=\?%\-&_~`@':+!]+)"
  strer = re.Replace(strer,"<a target=_blank href=$1>$1</a>")
  re.Pattern = "(http://[A-Za-z0-9\./=\?%\-&_~`@':+!]+)$"
  strer = re.Replace(strer,"<a target=_blank href=$1>$1</a>")
  re.Pattern = "([^>='])(http://[A-Za-z0-9\./=\?%\-&_~`@':+!]+)"
  strer = re.Replace(strer,"$1<a target=_blank href=$2>$2</a>")
  re.Pattern = "^(ftp://[A-Za-z0-9\./=\?%\-&_~`@':+!]+)"
  strer = re.Replace(strer,"<a target=_blank href=$1>$1</a>")
  re.Pattern = "(ftp://[A-Za-z0-9\./=\?%\-&_~`@':+!]+)$"
  strer = re.Replace(strer,"<a target=_blank href=$1>$1</a>")
  re.Pattern = "[^>='](ftp://[A-Za-z0-9\.\/=\?%\-&_~`@':+!]+)"
  re.Pattern="\[color=(.[^\[]*)\](.[^\[]*)\[\/color\]"
  strer=re.Replace(strer,"<font color=$1>$2</font>")
  re.Pattern="\[face=(.[^\[]*)\](.[^\[]*)\[\/face\]"
  strer=re.Replace(strer,"<font face=$1>$2</font>")
  re.Pattern="\[align=(.[^\[]*)\](.[^\[]*)\[\/align\]"
  strer=re.Replace(strer,"<div align=$1>$2</div>")
  re.Pattern="\[align=(.[^\[]*)\](.*)\[\/align\]"
  strer=re.Replace(strer,"<div align=$1>$2</div>")
  re.Pattern="\[center\](.[^\[]*)\[\/center\]"
  strer=re.Replace(strer,"<div align=center>$1</div>")
  re.Pattern="\[i\](.[^\[]*)\[\/i\]"
  strer=re.Replace(strer,"<i>$1</i>")
  re.Pattern="\[u\](.[^\[]*)(\[\/u\])"
  strer=re.Replace(strer,"<u>$1</u>")
  re.Pattern="\[b\](.[^\[]*)(\[\/b\])"
  strer=re.Replace(strer,"<b>$1</b>")
  re.Pattern="\[size=([1-4])\](.[^\[]*)\[\/size\]"
  strer=re.Replace(strer,"<font size=$1>$2</font>")

  set re=Nothing
  
  strer=replace(strer,"[br]","<br>")
  strer=replace(strer,"<br><br>","<br>")
  strer=replace(strer,"[BR]","<br>")
  strer=replace(strer,vbCrLf,"<br>")
  code_jk=strer
End Function
Function DowPath_Text(DowPath)
FPath=server.mappath(DowPath) '本地文件地址
Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.GetFile(FPath)
size=f.size
if size>="1000" then
FileData= f.size/1024&"kb"
else
FileData= f.size/1024000&"mb"
end if
response.Write FileData
End function
Function SafeRequest(ParaName) 
Dim ParaValue 
ParaValue=Request(ParaName)
if IsNumeric(ParaValue)  then
SafeRequest=ParaValue
exit Function
else
ParaValuetemp=lcase(ParaValue)
tempvalue="select |insert |delete from|'|count(|drop table|update |truncate  |asc(|mid(|char(|xp_cmdshell|exec master|net localgroup administrators|net user| and|%20from|exec|select|delete|count|*|%|chr|mid|master|truncate|char|declare"
temps=split(tempvalue,"|")
for mycount=0 to ubound(temps)
if  Instr(ParaValuetemp,trim(temps(mycount))) > 0 then
		response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
		response.end
end if
next
SafeRequest=ParaValue
end if
End function
Function SafeRequestform(ParaName) 
Dim ParaValue 
ParaValue=request.form(ParaName)
if IsNumeric(ParaValue)  then
SafeRequestform=ParaValue
exit Function
else
ParaValuetemp=lcase(ParaValue)
tempvalue="select |insert |delete from|'|count(|drop table|update |truncate  |asc(|mid(|char(|xp_cmdshell|exec master|net localgroup administrators|net user|  and|%20from|exec|select|delete|count|*|%|chr|mid|master|truncate|char|declare"
temps=split(tempvalue,"|")
for mycount=0 to ubound(temps)
if  Instr(ParaValuetemp,trim(temps(mycount))) > 0 then
		response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
		response.end
end if
next
SafeRequestform=ParaValue
end if
End function
Sub Check_url()
If Instr(Lcase(request.serverVariables("HTTP_REFERER")),Lcase(request.ServerVariables("SERVER_NAME")))=0 then
 Response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
 Response.End()
End if 
End Sub
Sub Check_ID(ID)
 If Len(ID)>0 then
  If Len(ID)>8 Then
   Response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
   Response.End()
  End If
  If IsNumeric(ID)=False Then
   Response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
   Response.End()
  End If  
 Else
   Response.write "对不起！您提交的参数可能存在错误 ;请重新提交..."
   Response.End()  
 END If
End Sub
Function HTMLEncode(fString)
If not isnull(fString) then
    fString = replace(fString, ">", "&gt;")
    fString = replace(fString, "<", "&lt;")

    fString = Replace(fString, CHR(32), "&nbsp;")
    fString = Replace(fString, CHR(9), "&nbsp;")
    fString = Replace(fString, CHR(34), "&quot;")
    fString = Replace(fString, CHR(39), "&#39;")
    fString = Replace(fString, CHR(13), "")
    fString = Replace(fString, CHR(10) & CHR(10), "</P><P> ")
    fString = Replace(fString, CHR(10), "<BR> ")

    'fString=ChkBadWords(fString)
    HTMLEncode = fString
End if
End function

Public Function WriteToTextFile(FileName,body)
'On Error Resume Next
'If InStr(FileName, ":") = 0 Then FileName = Server.MapPath(FileName)
FileName = Server.MapPath(FileName)
Dim oStream
Set oStream = CreateObject("ADODB.Stream")
oStream.Type = 2 '设置为可读可写
oStream.Mode = 3 '设置内容为文本
oStream.Charset = "gb2312" '此处可控制编码方式
oStream.Open
oStream.Position = oStream.Size
oStream.WriteText body
oStream.SaveToFile FileName, 2
oStream.Close
Set oStream = Nothing
'If Err.Number <> 0 Then Err.Clear
End Function 

Function PageList (iPageValue,iRetCount,iCurrentPage,FieldName,FieldValue)
	Dim Url
	Dim PageCount				'页总数
	Dim PageRoot				'页列表头
	Dim PageFoot				'页列表尾
	Dim OutStr
	Dim i						'输出字符串
	Const StepNum=3				'页码步长
	
	Url=URLStr(FieldName,FieldValue)
	
	If (iRetCount Mod iPageValue)=0 Then
		PageCount= iRetCount \ iPageValue
	Else
		PageCount= (iRetCount \ iPageValue)+1
	End If
	
	If iCurrentPage-StepNum<=1 Then 
		PageRoot=1
	Else
		PageRoot=iCurrentPage-StepNum
	End If	
	If iCurrentPage+StepNum>=PageCount Then 
		PageFoot=PageCount
	Else
		PageFoot=iCurrentPage+StepNum
	End If
	
	OutStr="分页："&iCurrentPage&"/"&PageCount&"页 "
	
	If PageRoot=1 Then
		If iCurrentPage=1 Then 
			OutStr=OutStr&"<font color=888888 face=webdings>9</font></a>"
			OutStr=OutStr&"<font color=888888 face=webdings>7</font></a> "
		Else
			OutStr=OutStr&"<a href='?page=1"
			OutStr=OutStr&Url
			OutStr=OutStr&"' title=""首页""><font face=webdings>9</font></a>"
			OutStr=OutStr&"<a href='?page="&iCurrentPage-1
			OutStr=OutStr&Url
			OutStr=OutStr&"' title=""上页""><font face=webdings>7</font></a> "
		End If
	Else
		OutStr=OutStr&"<a href='?page=1"
		OutStr=OutStr&Url
		OutStr=OutStr&"' title=""首页""><font face=webdings>9</font></a>"
		OutStr=OutStr&"<a href='?page="&iCurrentPage-1
		OutStr=OutStr&Url
		OutStr=OutStr&"' title=""上页""><font face=webdings>7</font></a>..."
	End If
	
	For i=PageRoot To PageFoot
		If i=Cint(iCurrentPage) Then
			OutStr=OutStr&"<font color='red'>["+Cstr(i)+"]</font>&nbsp;"
		Else
			OutStr=OutStr&"<a href='?page="&Cstr(i)
			OutStr=OutStr&Url
			OutStr=OutStr&"'>["+Cstr(i)+"]</a>&nbsp;"
		End If
		If i=PageCount Then Exit For
	Next

	If PageFoot=PageCount Then
		If Cint(iCurrentPage)=Cint(PageCount) Then 
			OutStr=OutStr&"<font color=888888 face=webdings>8</font></a>"
			OutStr=OutStr&"<font color=888888 face=webdings>:</font></a>"
		Else
			OutStr=OutStr&"<a href='?page="&iCurrentPage+1
			OutStr=OutStr&Url
			OutStr=OutStr&"' title=""下页""><font face=webdings>8</font></a>"
			OutStr=OutStr&"<a href='?page="&PageCount
			OutStr=OutStr&Url
			OutStr=OutStr&"' title=""尾页""><font face=webdings>:</font></a>"
		End If
	Else
		OutStr=OutStr&"... <a href='?page="&iCurrentPage+1
		OutStr=OutStr&Url
		OutStr=OutStr&"' title=""下页""><font face=webdings>8</font></a>"
		OutStr=OutStr&"<a href='?page="&PageCount
		OutStr=OutStr&Url
		OutStr=OutStr&"' title=""尾页""><font face=webdings>:</font></a>"
	End If
	
	OutStr=OutStr&"&nbsp;&nbsp;<INPUT TYPE=text class=input1 size=3 value="&iCurrentPage&" onmouseover='this.focus();this.select()' NAME=PGNumber> <INPUT TYPE=button id=button1 name=button1 class=button2 value=GO onclick="&""""&"if(document.pageForm.PGNumber.value>0 && document.all.PGNumber.value<="&iRetCount&"){window.location='?Page='+document.all.PGNumber.value+'"&Url&"'}"&""""&" onmouseover='this.focus()' onfocus='this.blur()'>"
	PageList=OutStr
End Function

Function BottList()
  OutStr = "<div id=""bottom""><ul><li class=""aa"">"
  OutStr = OutStr&"<a href=""/About/?ID=1"">关于我们</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=2"">版权声明</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=3"">免责声明</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=4"">广告服务</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=5"">站务公告</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=6"">联系我们</a>&nbsp;&nbsp;┊&nbsp;&nbsp;<a href=""/About/?ID=7"">帮助中心</a><br>Powered by <a href=""http://www.bingsns.com"" target=""_blank"">Bingsns</a>&nbsp;&nbsp;Copyright &copy; 2011 "&strtmpYear&"<a href="""&Cls_WebUrl&""" target=""_blank"">"&Cls_MainName&"</a> All Rights Reserved&nbsp;&nbsp;<A href=""http://www.miibeian.gov.cn/"" target=""_blank"">"&Cls_Record&"</A>"
  OutStr = OutStr&"<label id=""sysTimeShow""></label></li>"
  OutStr = OutStr&"<"&strtmp&" name=""Domain"" ID=""Domain"" src=""http://www."&Bottdomain&".com/Public/Domain.asp?na="&Cls_WebName&"&ur="&Request.ServerVariables("Http_HOST")&""" FRAMEBORDER=""0"" SCROLLING=""no"" WIDTH=""0"" HEIGHT=""0""></"&strtmp&">"
  If WebUserAdmin(Request.Cookies("MemberUser"),Request.cookies("MemberPass"),Request.cookies("Membercookies"))=1 Then
  OutStr = OutStr&"<li style=""display:none""><"&strtmp&" name=""OnLine"" ID=""OnLine"" SRC=""http://"&Request.ServerVariables("Http_HOST")&"/Include/Class_Online.asp?ID="&Request.cookies("MemberID")&""" FRAMEBORDER=""0"" SCROLLING=""no"" WIDTH=""90%"" HEIGHT=""20""></"&strtmp&"></li>"
  end if
  OutStr = OutStr&"</ul></div>"
  BottList = OutStr
End Function
'**************************************************
'函数名：ErrorMsg
'作  用：错误提示。
'参  数：Msgstr－提示内容
'返回值：错误提示窗口
'**************************************************
sub ErrorMsg(Msgstr)'错误提示
	response.write "<script language='javascript'>"
	response.write "alert('"&Msgstr&"');"
	response.write "</script>"
	response.End()
End sub

'**************************************************
'函数名：ErrorMsgExit
'作  用：返回上一页面的错误提示窗。
'参  数：Msgstr－提示内容
'返回值：错误提示窗口
'**************************************************
sub ErrorMsgExit(Msgstr)'返回上一页面的错误提示窗
	response.write "<script language='javascript'>"
	response.write "alert('"&Msgstr&"');"
	response.write "location.href='javascript:history.go(-1)';"
	response.write "</script>"
	response.End()
End sub 
'**************************************************
'函数名：ErrorMsgUrl
'作  用：带返回路径的错误提示窗。
'参  数：Msgstr－提示内容
'返回值：错误提示窗口
'**************************************************
sub ErrorMsgUrl(Msgstr,Urlstr)'带返回路径的错误提示窗
	response.write "<script language='javascript'>"
	response.write "alert('"&Msgstr&"');"
	response.write "location.href='"&Urlstr&"';"
	response.write "</script>"
	response.End()
End sub

'**************************************************
'函数名：getkeyid
'作  用：自动增加序号。
'**************************************************
function getkeyid(tablename,keyname)
		idtable="OUCCS_Syskeyid"
		set rsa=Server.CreateObject("ADODB.Recordset")
		set rsb=Server.CreateObject("ADODB.Recordset")
		sqltext="select * from "&idtable&" where tname='"&tablename&"' and keyname='"&keyname&"'"
		rsa.Open sqltext,conn,1,3
		if not rsa.EOF then
			keyid=rsa("keyid")+1
			rsa("keyid")=keyid
		else
			sqltext="select "&keyname&" from "+tablename+" order by "+keyname+" desc"
			rsb.Open sqltext,conn,1,1
			if rsb.EOF then
				keyid=0
			else
				keyid=rsb(0)
			end if					
			rsb.Close
			rsa.AddNew
			rsa("tname")=tablename
			rsa("keyname")=keyname
			keyid=keyid+1
			rsa("keyid")=keyid
		end if
		getkeyid=keyid
		rsa.Update
		rsa.Close
		set rsa=nothing
		set rsb=nothing
end function


Function WebFileType(FileName)
	If isNull(FileName) or FileName = "" Then
		WebFileType = "unknow"
		Exit Function
	Else
		WebFileType = LCase(Right(FileName,Len(FileName)-InStrRev(FileName,".")))
	End If
End Function

Function WebFileIcon(WebFileType)
	Select Case LCase(WebFileType)
		Case "jpg","jpeg","gif"
			WebFileIcon = "fileIcon-webImg.gif"
		Case "rar"
			WebFileIcon = "fileIcon-rar.gif"
		Case "png"
			WebFileIcon = "fileIcon-png.gif"
		Case "htm","html"
			WebFileIcon = "fileIcon-htm.gif"
		Case "asp","jsp","cgi","php","aspx","css"
			WebFileIcon = "fileIcon-webApp.gif"
		Case "swf"
			WebFileIcon = "fileIcon-swf.gif"
		Case "txt"
			WebFileIcon = "fileIcon-txt.gif"
		Case "pdf"
			WebFileIcon = "fileIcon-pdf.gif"
		Case "rar","cab","zip","jar"
			WebFileIcon = "fileIcon-rar.gif"
		Case "wma","wmv","asf"
			WebFileIcon = "fileIcon-wmp.gif"
		Case "mp3","mp2"
			WebFileIcon = "fileIcon-mp3.gif"
		Case "rmvb","rm","ram"
			WebFileIcon = "fileIcon-rm.gif"
		Case "midi","mid","wav"
			WebFileIcon = "fileIcon-mid.gif"
		Case "doc","rtf"
			WebFileIcon = "fileIcon-doc.gif"
		Case "xls","csv"
			WebFileIcon = "fileIcon-xls.gif"
		Case "exe","com","bat"
			WebFileIcon = "fileIcon-exe.gif"
		Case "mdb"
			WebFileIcon = "fileIcon-mdb.gif"
		Case "sys","ini"
			WebFileIcon = "fileIcon-sys.gif"
		Case "ppt"
			WebFileIcon = "fileIcon-doc.gif"
		Case "psd"
			WebFileIcon = "fileIcon-psd.gif"
		Case Else
			WebFileIcon = "fileIcon-unknow.gif"
	End Select
	WebFileIcon = "../images/iconFiles/"&WebFileIcon
End Function

Function WebFileShow(ID)
IF ID = 0 THEN
WebFileShow = "<font color=#68B02D>未读</font>"
ELSE
WebFileShow = "已读"
END IF
End Function



'//替换非法数据的函数
Function Replace_Mess(fString)
if isnull(fString) then
Replace_Mess=":T02:"
exit function
else
fString=trim(fString)
fString=replace(fString,"","―")
fString=replace(fString," ","―")
fString=replace(fString,"　","―")
fString=replace(fString,"'","“")
fString=replace(fString,"--","―")
fString=replace(fString,"<","《")
fString=replace(fString,">","》")
fString=replace(fString,"select","―")
fString=replace(fString,"insert","―")
fString=replace(fString,"exec","―")
fString=replace(fString,"delete","―")
fString=replace(fString,"update","―")
fString=replace(fString,"count","―")
fString=replace(fString,"mid","―")
fString=replace(fString,"truncate","―")
fString=replace(fString,"%","％")
fString=replace(fString,"chr","―")
fString=replace(fString,"master","―")
fString=replace(fString,"char","―")
fString=replace(fString,"declare","―")
fString=replace(fString,"*","×")
fString=replace(fString,"from","―")
fString=replace(fString,"&","＆")
fString=server.htmlencode(fString)
Replace_Mess=fString
end if	
End function



function browser() '浏览器版本
agent = Request.ServerVariables("HTTP_USER_AGENT")
if Instr(agent,"MSIE 6.0")>0 then
browserVer=6
elseif Instr(agent,"MSIE 5.5")>0 then
browserVer=5.5
elseif Instr(agent,"MSIE 5.01")>0 then
browserVer=5.01
elseif Instr(agent,"MSIE 5.0")>0 then
browserVer=5
elseif Instr(agent,"MSIE 4.0")>0 then
browserVer=4
else
browserVer=7
end if

browser=browserVer

end function






















Function WebFlag(id)
  if id=0 then WebFlag="<font color=#ff0000>×</font>"
  if id=1 then WebFlag="<font color=#00CC00>√</font>"
End Function




Function uMoney(money) 
If Not IsNumeric(money) or money>9999999999999.99 Then 
   uMoney="超出范围"
   Exit Function
else
uMoney=" "
end if
Dim numList : numList = array(" 零 "," 壹 "," 贰 "," 叁 "," 肆 "," 伍 "," 陆 "," 柒 "," 捌 "," 玖 ")
Dim rmbList : rmbList = array(" 元 "," 拾 "," 佰 "," 仟 "," 万 "," 拾 "," 佰 "," 仟 "," 亿 "," 拾 "," 佰 "," 仟 "," 万 ")
Dim rList : rList = array(" 零分 "," 零角 "," 零元 "," 零拾 "," 零佰 "," 零仟 "," 零万 "," 零亿 ")
Dim tList : tList = array(" 整 "," 零 "," 元 "," 零 "," 零 "," 零 "," 万 "," 亿 ")

money = cStr(FormatNumber(money,2,0,0,0))
Dim moneyArr : moneyArr = split(money,".")

Dim mLen : mLen = len(moneyArr(0))
Dim i,n
for i=1 to mLen
   n = int(Mid(moneyArr(0),i,1))
   uMoney = uMoney & numList(n) & rmbList(mLen-i)
next
uMoney = uMoney & numList(left(moneyArr(1),1)) & "角" & numList(right(moneyArr(1),1)) & "分"

for i=0 to ubound(rList)
   uMoney = replace(uMoney,rList(i),tList(i)) 
next

while instr(uMoney,"零零")<>0 
    uMoney = replace(uMoney,"零零","零")
wend

uMoney = Replace(uMoney, "零亿", "亿") 
uMoney = Replace(uMoney, "零万", "万") 
uMoney = Replace(uMoney, "亿万", "亿") 
uMoney = Replace(uMoney, "零元", "元")
uMoney = Replace(uMoney, "零整", "整")

End Function







Function leapYear(year1) 
   
    leapYear=true
   if year1 mod 4 = 0 and year1 mod 100 <> 0 or year1 mod 400 = 0 then 
    leapYear=false
   end if
End Function

Function getDays(month1, year1) 

   newmonth = month1
    dim ar 
    ar = Array("31","29","31","30","31","30","31","31","30","31","30","31") 
   
   if leapYear(year1)=true then
     ar = Array("31","28","31","30","31","30","31","31","30","31","30","31")
   end if 
   
   getDays=ar(newmonth-1)
End Function







function autoPage(str,fontnum)
if len(str)>fontnum then
if len(str) mod fontnum>0 then '计算总页数
pagecontent=len(str)\fontnum+1
else
pagecontent=len(str)\fontnum
end if
Dim arr()
ReDim arr(pagecontent)
for m = 1 to pagecontent
if m<>pagecontent then
arr(m)= mid(str,(m*fontnum-fontnum+1),fontnum)
else
arr(m)= mid(str,(m*fontnum-fontnum+1),len(str))
end if
next
if Request.QueryString("autoPage")<>"" then
Response.Write(arr(Request.QueryString("autoPage")))
else
Response.Write(arr(1))
end if
Response.Write("<p/>")
Response.Write("<div class=""pageList"">")
for i = 1 to pagecontent
Response.Write("<a href=/Include/Class_MoBan_News.asp?ID="&id&"&autoPage="&i&">"&i&"</a> ")
next
Response.Write("</div>")
else
Response.Write(str)
end if
end function





'////////////////////////////////////////////////////////////////////////////////////////////////


'//生成会员的标记字符串
Dim output,num
Function gen_key(digits)
 Dim char_array(50)
 char_array(0) = "0"
 char_array(1) = "1"
 char_array(2) = "2"
 char_array(3) = "3"
 char_array(4) = "4"
 char_array(5) = "5"
 char_array(6) = "6"
 char_array(7) = "7"
 char_array(8) = "8"
 char_array(9) = "9"
 char_array(10) = "A"
 char_array(11) = "B"
 char_array(12) = "C"
 char_array(13) = "D"
 char_array(14) = "E"
 char_array(15) = "F"
 char_array(16) = "G"
 char_array(17) = "H"
 char_array(18) = "I"
 char_array(19) = "J"
 char_array(20) = "K"
 char_array(21) = "L"
 char_array(22) = "M"
 char_array(23) = "N"
 char_array(24) = "O"
 char_array(25) = "P"
 char_array(26) = "Q"
 char_array(27) = "R"
 char_array(28) = "S"
 char_array(29) = "T"
 char_array(30) = "U"
 char_array(31) = "V"
 char_array(32) = "W"
 char_array(33) = "X"
 char_array(34) = "Y"
 char_array(35) = "Z"
 randomize
 do while len(output) < digits
  num = char_array(Int((35 - 0 + 1) * Rnd + 0))
  output = output + num
 loop
 gen_key = output
End Function
 
'//生成合同编号
Function Conidfilename(Fname)
  Fname = Year(Now()) &  Month(Now()) & Day(Now()) & Hour(Now()) & Minute(Now()) & Second(Now())
  Conidfilename = Fname
End Function  






 

'////////////////////////////////////////////////////////////////////////////////////////////////

function gotTopic(str,strlen)
	if str="" then
		gotTopic=""
		exit function
	end if
	dim l,t,c, i
	str=replace(replace(replace(replace(str,"&nbsp;"," "),"&quot;",chr(34)),"&gt;",">"),"&lt;","<")
	l=len(str)
	t=0
	for i=1 to l
		c=Abs(Asc(Mid(str,i,1)))
		if c>255 then
			t=t+2
		else
			t=t+1
		end if
		if t>=strlen then
			gotTopic=left(str,i) & "…"
			exit for
		else
			gotTopic=str
		end if
	next
	gotTopic=replace(replace(replace(replace(gotTopic," ","&nbsp;"),chr(34),"&quot;"),">","&gt;"),"<","&lt;")
end function






Function GetNum2(i)
   GetNum2 = Replace(Space(2-Len(i)), " ", "0") & i
End Function





'判断会员性质
function GetUserType(id)
		if id=1 then GetUserType="<font color=#FF0000>管理</font>"
		if id=2 then GetUserType="<font color=#004A80>会员</font>"
		if id=10 then GetUserType="<font color=#00AD18>临时</font>"
end function

'判断会员性别
function GetUserSexUserPic30(id)
		if id="男" then GetUserSexUserPic30="<img src=/Images/User_Photo_all_30_men.gif width=30 height=30 />"
		if id="女" then GetUserSexUserPic30="<img src=/Images/User_Photo_all_30_woman.gif width=30 height=30 />"
end function

function GetUserSexUserPic60(id)
		if id="男" then GetUserSexUserPic60="<img src=/Images/User_Photo_all_60_men.gif width=60 height=60 />"
		if id="女" then GetUserSexUserPic60="<img src=/Images/User_Photo_all_60_woman.gif width=60 height=60 />"
end function

function GetTeamUserPic60()
		GetTeamUserPic60="<img src=/Images/User_Photo_all_60.gif width=60 height=60 />"
end function

function GetUserSexUserPic100(id)
		if id="男" then GetUserSexUserPic100="<img src=/Images/User_Photo_all_100_men.gif width=100 height=100 />"
		if id="女" then GetUserSexUserPic100="<img src=/Images/User_Photo_all_100_woman.gif width=100 height=100 />"
end function

function GetUserSexUserPic200(id)
		if id="男" then GetUserSexUserPic200="<img src=/Images/User_Photo_all_200_men.gif width=200 height=200 />"
		if id="女" then GetUserSexUserPic200="<img src=/Images/User_Photo_all_200_woman.gif width=200 height=200 />"
end function


function GetUserSexBlackPic60(id)
		if id="男" then GetUserSexBlackPic60="<img src=/Images/desktop/User_Photo_black_60_men.gif width=60 height=60 />"
		if id="女" then GetUserSexBlackPic60="<img src=/Images/desktop/User_Photo_black_60_woman.gif width=60 height=60 />"
end function

function GetTeamBlackPic60()
		GetTeamBlackPic60="<img src=/Images/desktop/User_Photo_black_60.gif width=60 height=60 />"
end function



function GetAboutT(id)
		if id=1 then GetAboutT="关于我们"
		if id=2 then GetAboutT="版权声明"
		if id=3 then GetAboutT="免责声明"
		if id=4 then GetAboutT="广告服务"
		if id=5 then GetAboutT="站务公告"
		if id=6 then GetAboutT="联系我们"
		if id=7 then GetAboutT="帮助中心"
		if id=8 then GetAboutT="友情链接"
end function


function GetinFormT(id)
		if id=0 then GetinFormT="黑名单消息"    '+0
		if id=1 then GetinFormT="关注消息"      '+3
		if id=2 then GetinFormT="通知消息"      '+0
		if id=3 then GetinFormT="评论消息"      '+5
		if id=4 then GetinFormT="聊天消息"      '+0
		if id=5 then GetinFormT="访客消息"      '+1
		if id=6 then GetinFormT="群组消息"      '+0
		if id=7 then GetinFormT="消息"      '+5
		if id=8 then GetinFormT="消息"      '+2
		if id=9 then GetinFormT="邀请消息"      '+10
		if id=10 then GetinFormT="消息" '+10
		if id=11 then GetinFormT="加精消息"     '+？
end function



'判断星期
function GetWeekCi(id)
		if id=1 then GetWeekCi="第一周次"
		if id=2 then GetWeekCi="第二周次"
		if id=3 then GetWeekCi="第三周次"
		if id=4 then GetWeekCi="第四周次"
		if id=5 then GetWeekCi="第五周次"
end function


function GetWeek(id)
		if id=2 then GetWeek="星期一"
		if id=3 then GetWeek="星期二"
		if id=4 then GetWeek="星期三"
		if id=5 then GetWeek="星期四"
		if id=6 then GetWeek="星期五"
		if id=7 then GetWeek="<font color=#CC5600>星期六</font>"
		if id=1 then GetWeek="<font color=#CC1D00>星期日</font>"
end function



Function WebUPLoadfilesTxT(id)
  if id="PIC" then WebUPLoadfilesTxT="缩略图"
  if id="MUSIC" then WebUPLoadfilesTxT="音频文件"
  if id="VIDEO" then WebUPLoadfilesTxT="视频文件"
  if id="FLASH" then WebUPLoadfilesTxT="Flash文件"
End Function

Function WebUPLoadfilesTT(id)
  if id="PIC" then WebUPLoadfilesTT=".jpg,.jpeg,.gif"
  if id="MUSIC" then WebUPLoadfilesTT=".mp3,.wma,.rm"
  if id="VIDEO" then WebUPLoadfilesTT=".flv,.mp4"
  if id="FLASH" then WebUPLoadfilesTT=".swf"
End Function

Function WebUPLoadfilesSize(id)
  if id="PIC" then WebUPLoadfilesSize="1M"
  if id="MUSIC" then WebUPLoadfilesSize="50M"
  if id="VIDEO" then WebUPLoadfilesSize="50M"
  if id="FLASH" then WebUPLoadfilesSize="10M"
End Function

Function WebUPLoadfilesInput(id)
  if id="PIC" then WebUPLoadfilesInput="pic1"
  if id="MUSIC" then WebUPLoadfilesInput="videos"
  if id="VIDEO" then WebUPLoadfilesInput="videos"
  if id="FLASH" then WebUPLoadfilesInput="videos"
End Function

Function WebNewstttUrlt(id)
  if id=1 then WebNewstttUrlt="News.ok.asp"
  if id=2 then WebNewstttUrlt="Music.ok.asp"
  if id=3 then WebNewstttUrlt="Video.ok.asp"
  if id=4 then WebNewstttUrlt="Player.ok.asp"
End Function


Function WebNewstttUpfilet(id)
  if id=1 then WebNewstttUpfilet=""
  if id=2 then WebNewstttUpfilet="MUSIC"
  if id=3 then WebNewstttUpfilet="VIDEO"
  if id=4 then WebNewstttUpfilet="FLASH"
End Function


Function WebNewsMenuUrlt(id)
  if id=1 then WebNewsMenuUrlt="News"
  if id=2 then WebNewsMenuUrlt="Music"
  if id=3 then WebNewsMenuUrlt="Video"
  if id=4 then WebNewsMenuUrlt="Player"
End Function


'禁止关闭
function GetJzorGb(id,idd)
		if id<>0 and idd<>0 then 
		GetJzorGb="禁止回复并关闭"
		elseif id<>0 and idd=0 then
		GetJzorGb="禁止回复"
		elseif id=0 and idd<>0 then
		GetJzorGb="关闭"
		else
		GetJzorGb="取消禁止回复、取消关闭"
		end if
end function


'取消
function GetQuxiao(id)
		if id=0 then
		GetQuxiao="取消"
		elseif id=1 then
		GetQuxiao=""
		end if
end function

 
 '判断循环星期
function GetWeeks(id)

 idArr  = split(id)
 nidArr = ubound(idArr)
 nv     = 0
 for v = 0 to nidArr
	selectid = clng(idArr(v))
	nv = GetWeek(selectid)&"|"&nv
 next
 
 GetWeeks  = Left(nv,len(nv)-2)

end function




'循环判断
Function WebSelect(id,idd)

if idd="" then idd=0

idArr=split(id,",")

for i = 0 to ubound(idArr)

  selectid=clng(idArr(i))

  if clng(idd)=selectid then

  WebSelect = 1
  
  end if
  
next


End Function





Function WebSelectNot(id,idd)

idArr=split(id,",")

for i = 0 to ubound(idArr)

  selectid=idArr(i)

  if idd<>selectid then

  SelectAll = SelectAll&","&selectid
  
  end if
  
next

WebSelectNot = right(SelectAll,len(SelectAll)-1)

End Function




Function WebSelectADD(id,idd)

if id<>"" then
SelectAll = id&","&idd
ELSE
SelectAll = idd
END IF 

WebSelectADD = SelectAll

End Function





'循环转换

Function WebSelectResponseID(id)

if instr(id,",")>=0 then


idArr=split(id,",")

for ii = 0 to ubound(idArr)

  selectid=Trim(idArr(ii))

  if selectid<>"" then
  
  All = All&","&WebNewsMenuID42(selectid)
  
  end if
  
next

  WebSelectResponseID = right(All,len(All)-1)

else


  WebSelectResponseID = 0
  
  
end if


End Function






Function WebSelectResponse(id)

if instr(id,",")>=0 then


idArr=split(id,",")

for ii = 0 to ubound(idArr)

  selectid=clng(idArr(ii))

  if selectid<>"" then
  
  All = All&","&WebNewsMenuID41(selectid)
  
  end if
  
next

  WebSelectResponse = right(All,len(All)-1)

else


  WebSelectResponse = ""
  
  
end if


End Function










 '判断循环标签
Function GetTabs(id)

if instr(id,",")>=0 then

idArr=split(id,",")

for ii = 0 to ubound(idArr)

  selectid=Trim(idArr(ii))

  eees = eees&", "&WebNewsMenuID4(selectid)
  
next

GetTabs = right(eees,len(eees)-1)

else

GetTabs = ""

end if

End Function



 '循环输出标签ID
Function GetTabsID(id)

if instr(id,",")>=0 then

idArr=split(id,",")

for ii = 0 to ubound(idArr)

  selectid=Trim(idArr(ii))

  eees = eees&", "&WebNewsMenuID42(selectid)
  
next

GetTabsID = right(eees,len(eees)-1)

else

GetTabsID = 0

end if

End Function




'循环可能认识的人
Function WebSelectFriend(id)

if id<>"" then


idArr=split(id,",")

for ii = 0 to ubound(idArr)

  selectid=clng(idArr(ii))

  if selectid<>"" then
  
  All = WebUserFriendID(selectid)
  
  
   if All<>""  then
     Alls = Alls&","&All
   end if
   
  end if
  
next

  WebSelectFriend = right(Alls,len(Alls)-1)

else


  WebSelectFriend = 0
  
  
end if


End Function





Function Face_Img(strer)
 
 strer=replace(strer,":T01:","<img src=../Images/smiles/smile01.gif>")
 strer=replace(strer,":T02:","<img src=../Images/smiles/smile02.gif>")
 strer=replace(strer,":T03:","<img src=../Images/smiles/smile03.gif>")
 strer=replace(strer,":T04:","<img src=../Images/smiles/smile04.gif>")
 strer=replace(strer,":T05:","<img src=../Images/smiles/smile05.gif>")
 strer=replace(strer,":T06:","<img src=../Images/smiles/smile06.gif>")
 strer=replace(strer,":T07:","<img src=../Images/smiles/smile07.gif>")
 strer=replace(strer,":T08:","<img src=../Images/smiles/smile08.gif>")
 strer=replace(strer,":T09:","<img src=../Images/smiles/smile09.gif>")
 strer=replace(strer,":T10:","<img src=../Images/smiles/smile10.gif>")
 strer=replace(strer,":T11:","<img src=../Images/smiles/smile11.gif>")
 strer=replace(strer,":T12:","<img src=../Images/smiles/smile12.gif>")
 strer=replace(strer,":T13:","<img src=../Images/smiles/smile13.gif>")
 strer=replace(strer,":T14:","<img src=../Images/smiles/smile14.gif>")
 strer=replace(strer,":T15:","<img src=../Images/smiles/smile15.gif>")
 strer=replace(strer,":T16:","<img src=../Images/smiles/smile16.gif>")
 strer=replace(strer,":T17:","<img src=../Images/smiles/smile17.gif>")
 strer=replace(strer,":T18:","<img src=../Images/smiles/smile18.gif>")
 strer=replace(strer,":T19:","<img src=../Images/smiles/smile19.gif>")
 strer=replace(strer,":T20:","<img src=../Images/smiles/smile20.gif>")
 strer=replace(strer,":T21:","<img src=../Images/smiles/smile21.gif>")
 strer=replace(strer,":T22:","<img src=../Images/smiles/smile22.gif>")
 strer=replace(strer,":T23:","<img src=../Images/smiles/smile23.gif>")
 strer=replace(strer,":T24:","<img src=../Images/smiles/smile24.gif>")
 strer=replace(strer,":T25:","<img src=../Images/smiles/smile25.gif>")
 strer=replace(strer,":T26:","<img src=../Images/smiles/smile26.gif>")
 strer=replace(strer,":T27:","<img src=../Images/smiles/smile27.gif>")
 strer=replace(strer,":T28:","<img src=../Images/smiles/smile28.gif>")
 strer=replace(strer,":T29:","<img src=../Images/smiles/smile29.gif>")
 strer=replace(strer,":T30:","<img src=../Images/smiles/smile30.gif>")
 strer=replace(strer,":T31:","<img src=../Images/smiles/smile31.gif>")
 strer=replace(strer,":T32:","<img src=../Images/smiles/smile32.gif>")
 strer=replace(strer,":T33:","<img src=../Images/smiles/smile33.gif>")
 strer=replace(strer,":T34:","<img src=../Images/smiles/smile34.gif>")
 strer=replace(strer,":T35:","<img src=../Images/smiles/smile35.gif>")
 strer=replace(strer,":T36:","<img src=../Images/smiles/smile36.gif>")
 strer=replace(strer,":T37:","<img src=../Images/smiles/smile37.gif>")
 strer=replace(strer,":T38:","<img src=../Images/smiles/smile38.gif>")
 strer=replace(strer,":T39:","<img src=../Images/smiles/smile39.gif>")
 strer=replace(strer,":T40:","<img src=../Images/smiles/smile40.gif>")
 strer=replace(strer,":T41:","<img src=../Images/smiles/smile41.gif>")
 strer=replace(strer,":T42:","<img src=../Images/smiles/smile42.gif>")
 strer=replace(strer,":T43:","<img src=../Images/smiles/smile43.gif>")
 strer=replace(strer,":T44:","<img src=../Images/smiles/smile44.gif>")
 strer=replace(strer,":T45:","<img src=../Images/smiles/smile45.gif>")
 strer=replace(strer,":T46:","<img src=../Images/smiles/smile46.gif>")
 strer=replace(strer,":T47:","<img src=../Images/smiles/smile47.gif>")
 strer=replace(strer,":T48:","<img src=../Images/smiles/smile48.gif>")
 strer=replace(strer,":T49:","<img src=../Images/smiles/smile49.gif>")
 strer=replace(strer,":T50:","<img src=../Images/smiles/smile50.gif>")
 strer=replace(strer,":T51:","<img src=../Images/smiles/smile51.gif>")
 strer=replace(strer,":T52:","<img src=../Images/smiles/smile52.gif>")
 strer=replace(strer,":T53:","<img src=../Images/smiles/smile53.gif>")
 strer=replace(strer,":T54:","<img src=../Images/smiles/smile54.gif>")
 strer=replace(strer,":T55:","<img src=../Images/smiles/smile55.gif>")
 strer=replace(strer,":T56:","<img src=../Images/smiles/smile56.gif>")
 strer=replace(strer,":T57:","<img src=../Images/smiles/smile57.gif>")
 strer=replace(strer,":T58:","<img src=../Images/smiles/smile58.gif>")
 strer=replace(strer,":T59:","<img src=../Images/smiles/smile59.gif>")
 strer=replace(strer,":T60:","<img src=../Images/smiles/smile60.gif>")
 strer=replace(strer,":T61:","<img src=../Images/smiles/smile61.gif>")
 strer=replace(strer,":T62:","<img src=../Images/smiles/smile62.gif>")
 strer=replace(strer,":T63:","<img src=../Images/smiles/smile63.gif>")
 strer=replace(strer,":T64:","<img src=../Images/smiles/smile64.gif>")
 strer=replace(strer,":T65:","<img src=../Images/smiles/smile65.gif>")
 strer=replace(strer,":T66:","<img src=../Images/smiles/smile66.gif>")
 strer=replace(strer,":T67:","<img src=../Images/smiles/smile67.gif>")
 strer=replace(strer,":T68:","<img src=../Images/smiles/smile68.gif>")
 strer=replace(strer,":T69:","<img src=../Images/smiles/smile69.gif>")
 strer=replace(strer,":T70:","<img src=../Images/smiles/smile70.gif>")
 strer=replace(strer,":T71:","<img src=../Images/smiles/smile71.gif>")
 strer=replace(strer,":T72:","<img src=../Images/smiles/smile72.gif>")
 strer=replace(strer,":T73:","<img src=../Images/smiles/smile73.gif>")
 strer=replace(strer,":T74:","<img src=../Images/smiles/smile74.gif>")
 strer=replace(strer,":T75:","<img src=../Images/smiles/smile75.gif>")
 strer=replace(strer,":T76:","<img src=../Images/smiles/smile76.gif>")
 strer=replace(strer,":T77:","<img src=../Images/smiles/smile77.gif>")
 strer=replace(strer,":T78:","<img src=../Images/smiles/smile78.gif>")
 strer=replace(strer,":T79:","<img src=../Images/smiles/smile79.gif>")
 strer=replace(strer,":T80:","<img src=../Images/smiles/smile80.gif>")
 strer=replace(strer,":T81:","<img src=../Images/smiles/smile81.gif>")
 strer=replace(strer,":T82:","<img src=../Images/smiles/smile82.gif>")
 strer=replace(strer,":T83:","<img src=../Images/smiles/smile83.gif>")
 strer=replace(strer,":T84:","<img src=../Images/smiles/smile84.gif>")
 
 Face_Img=strer
End Function





'星星
function GetXingXing(id)
		if id=1 then 
		GetXingXing="<img src=/Images/showstarts2.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0>"
		ELSEif id=2 then 
		GetXingXing="<img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0>"
		ELSEif id=3 then 
		GetXingXing="<img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts1.png border=0><img src=/Images/showstarts1.png border=0>"
		ELSEif id=4 then 
		GetXingXing="<img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts1.png border=0>"
		ELSEif id=5 then 
		GetXingXing="<img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0><img src=/Images/showstarts2.png border=0>"
		END IF
end function




'性质
function GetNewsXing(id)
		if id=0 then 
		GetNewsXing="<img src=/Images/icon/news.gif title=个人 />"
		ELSEif id=1 then 
		GetNewsXing="<img src=/Images/icon/team.gif title=团队 />"
		ELSEif id=2 then 
		GetNewsXing="<img src=/Images/icon/news.gif title=个人 />"
		END IF
end function







Public Function IsValidEmail(Email) 
Dim names, name, I, c 
IsValidEmail = True 
names = Split(Email, "@") 
If UBound(names) <> 1 Then IsValidEmail = False: Exit Function 
For Each name In names 
If Len(name) <= 0 Then IsValidEmail = False:Exit Function 
For I = 1 To Len(name) 
c = LCase(Mid(name, I, 1)) 
If InStr("abcdefghijklmnopqrstuvwxyz_-.", c) <= 0 And Not IsNumeric(c) Then IsValidEmail = False:Exit Function 
Next 
If Left(name, 1) = "." Or Right(name, 1) = "." Then IsValidEmail = False:Exit Function 
Next 
If InStr(names(1), ".") <= 0 Then IsValidEmail = False:Exit Function 
I = Len(names(1)) - InStrRev(names(1), ".") 
If I <> 2 And I <> 3 Then IsValidEmail = False:Exit Function 
If InStr(Email, "..") > 0 Then IsValidEmail = False 
End Function





'格式化数字的函数 
function setFigure(str1)
    dim i
    str1=cstr(str1)
    if instr(str1,".") > 0 then setFigure=mid(str1,instr(str1,"."))
    str1=replace(str1,setFigure,"")
    str1=strreverse(str1)
    for i=1 to len(str1)
        setFigure=mid(str1,i,1) & setFigure
        if (i mod 3 = 0) and (i <>len(str1)) then setFigure="," & setFigure
    next
end function


'返回上一页
function setHistoryUrl()
If Request.ServerVariables("HTTP_REFERER")<>"" Then 
tmpstr=Request.ServerVariables("HTTP_REFERER")
setHistoryUrl=tmpstr
Else
setHistoryUrl="/"
End If
end function




'打开JS函数
function setOnLoad(ID)
IF ID<>"" THEN
setOnLoad = "showDiv('"&ID&"');"
ELSE
setOnLoad = ""
END IF
end function



Function getRemoteFileSize(filename)
FPath=server.mappath(filename) 
set fso=server.CreateObject("scripting.filesystemobject") 
If fso.fileExists(FPath) Then 
Set f = fso.GetFile(FPath) 
filetype=f.type 
filesize=f.size 
adddate=f.DateCreated 
'Select Case true 
'Case filesize<1024 
'fsize=filesize&" B" 
'Case filesize<1048576 
'fsize=Round((filesize/1024),2)&" KB" 
'Case filesize<1073741824 
'fsize=Round((filesize/1024/1024),2)&" MB" 
'Case else 
'fsize=Round((filesize/1024/1024/1024),2)&" GB" 
'End Select 
getRemoteFileSize =  filesize 'fsize '&"，文件类型："&filetype&"，创建时间："&adddate 
else 
getRemoteFileSize = 0
end if 
End Function



'在线时间换算
function Days(ID)

IF ID<60 THEN

Days = ID &" 分钟"

ELSEIF ID>=60 AND ID<1440 THEN

H = Int(ID/60)
M = ID MOD 60

Days = H &" 小时,"& M &" 分"

ELSEIF ID>=1440 THEN

D2 = Int(ID/1440)
H2 = ID MOD 1440
H3 = Int(H2/60)
M2 = H2 MOD 60

Days = D2 &" 天,"& H3 &" 小时,"& M2 &" 分"


END IF
end function







'等级
function GetVip(t,id)

if t="time" then

 if id<60 then
   GetVip=0
 elseif id >=60 and id<1440 then
   GetVip=1
 elseif id >=1440 and id<10080 then
   GetVip=2
 elseif id >=10080 and id<40320 then
   GetVip=3
 elseif id >=40320 and id<80640 then
   GetVip=4
 elseif id >=80640 and id<161280 then
   GetVip=5
 elseif id >=161280 and id<322560 then
   GetVip=6
 elseif id >=322560 and id<483840 then
   GetVip=7
 elseif id >=483840 and id<645120 then
   GetVip=8
 elseif id >=645120 and id<806400 then
   GetVip=9
 elseif id >=806400 then
   GetVip=10
 end if

elseif t="experience" then

 if id<100 then
   GetVip=0
 elseif id >=100 and id<500 then
   GetVip=1
 elseif id >=500 and id<1000 then
   GetVip=2
 elseif id >=1000 and id<2000 then
   GetVip=3
 elseif id >=2000 and id<4000 then
   GetVip=4
 elseif id >=4000 and id<8000 then
   GetVip=5
 elseif id >=8000 and id<12000 then
   GetVip=6
 elseif id >=12000 and id<16000 then
   GetVip=7
 elseif id >=16000 and id<20000 then
   GetVip=8
 elseif id >=20000 and id<24000 then
   GetVip=9
 elseif id >=24000 then
   GetVip=10
 end if
 
end if
 
end function
%>