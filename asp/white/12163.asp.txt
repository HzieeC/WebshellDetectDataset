<!-- #include file="codePage.asp" -->
<%
'option explicit
response.buffer=true
%>
<!-- #include file="check.asp" -->
<!-- #include file="inc/func_html.asp" -->
<%
Call CheckIframe()

'**** 版权所有 ****

' 网钛文章管理系统(OTCMS)
' 程序开发：网钛科技
' 官方网站：http://otcms.com
' 联系ＱＱ：877873666
' 联系邮箱：877873666@qq.com

'**** 版权所有 ****


'打开用户表，并检测用户是否登陆
Call OpenMemberexe("","login",0)

Call WebStyleTop("")

response.write(_
"<script language='javascript' type='text/javascript' src='js/inc/list.js'></script>"&_
"<script language='javascript' type='text/javascript' src='js/collItem.js'></script>"&_
"")


%><!-- #include file="collData/conobj.asp" --><%


Select Case mudi
	Case "add"
		Call IsSecMenuRight("alertBack",161,dataType)
		Call AddOrRev()

	Case "rev"
		Call IsSecMenuRight("alertBack",164,dataType)
		Call AddOrRev()

	Case "step1"
		Call IsSecMenuRight("alertBack",164,dataType)
		Call Step1()

	Case "step2"
		Call IsSecMenuRight("alertBack",164,dataType)
		Call Step2()

	Case "step3"
		Call IsSecMenuRight("alertBack",164,dataType)
		Call Step3()

	Case "manage"
		dataType="news"
		%><!-- #include file="inc/file_info.asp" --><%

		Call IsSecMenuRight("alertBack",162,dataType)
		Call manage()

End Select


Call CloseCollObj()

Call CloseMemberexe()
Call CloseConobj()
Call WebStyleBottom()









'新增、修改
Private Sub AddOrRev()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	isSourceCode= ToGetInt("isSourceCode")


	If mudi="rev" Then
		dataID=ToGetInt("dataID")
		Set revexe=collObj.execute("select top 1 * from OT_collItem where CI_ID="& dataID)
			If revexe.EOF Then
				JS_AlertBackEnd("无该记录！")
			End If
		CI_ID			= revexe("CI_ID")
		CI_typeID		= revexe("CI_typeID")
		CI_theme		= revexe("CI_theme")
		CI_infoTypeStr	= revexe("CI_infoTypeStr")
		CI_charset		= revexe("CI_charset")
		CI_URL			= revexe("CI_URL")
		CI_pageMode		= revexe("CI_pageMode")
		CI_pageURL		= revexe("CI_pageURL")
		CI_pageNum1		= revexe("CI_pageNum1")
		CI_pageNum2		= revexe("CI_pageNum2")
		CI_pageList		= revexe("CI_pageList")
		CI_pageCode1	= revexe("CI_pageCode1")
		CI_pageCode2	= revexe("CI_pageCode2")
		CI_addition		= revexe("CI_addition")
		CI_state		= revexe("CI_state")
		CI_isHighSet	= revexe("CI_isHighSet")
		CI_htmlMarkStr	= "|"& Replace(revexe("CI_htmlMarkStr"),", ","|") &"|"
		CI_strReplace	= revexe("CI_strReplace")
		CI_successNum	= revexe("CI_successNum")
		CI_readNum		= revexe("CI_readNum")
		mudiCN="修改"
	Else
		CI_pageList		= "http://otcms.com/范例网址1"& Chr(13)&Chr(10) &"http://otcms.com/范例网址2"
		CI_addition		= "|comp|"
		CI_state		= 1
		CI_isHighSet	= 1
		CI_htmlMarkStr	= "|iframe|,|script|"
		CI_strReplace	= ""
		CI_successNum	= 0
		CI_readNum		= 0
		mudiCN="添加"
	End If



	response.write(_
	"<form name='addform' method='post' action='collItem_deal.asp?mudi="& mudi &"&nohrefStr=close' onsubmit='return CheckForm()'>"&_
	"<input type='hidden' id='dataID' name='dataID' value='"& dataID &"' />"&_
	"<input type='hidden' id='dataTypeCN' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"<input type='hidden' id='dataType' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' id='dataMode' name='dataMode' value='"& dataMode &"' />"&_
	"<input type='hidden' id='dataModeStr' name='dataModeStr' value='"& dataModeStr &"' />"&_
	"")

	Call ShareTableTop("share_"& mudi &".gif","",mudiCN & dataTypeCN)
		response.write(_
		"<table width='98%' align='center' cellpadding='0' cellspacing='0' summary='' class='padd3'>"&_
		"<tr>"&_
			"<td width='20%'></td>"&_
			"<td width='80%'></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"项目名称：</td>"&_
			"<td align='left'><input type='text' id='theme' name='theme' size='50' style='width:450px;' value="""& CI_theme &""" /></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"所属模块：</td>"&_
			"<td align='left'>"&_
				"<select id='typeID' name='typeID'>"&_
				"")
					Set typeexe=collObj.execute("select CT_ID,CT_theme from OT_collType where CT_state=1 order by CT_rank ASC")
						Do Until typeexe.EOF
							response.write(_
							"<option value='"& typeexe("CT_ID") &"' "& IsSelected(typeexe("CT_ID"),CI_typeID) &">"& typeexe("CT_theme") &"</option>")
						typeexe.movenext
						Loop
					typeexe.close
					Set typeexe=Nothing
				response.write(_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"栏目：</td>"&_
			"<td align='left'>"&_
				"<select id='infoTypeStr' name='infoTypeStr'>"&_
				"<option value=''>&nbsp;</option>"&_
				"")
				typeNum = 0
				Set typeexe=conobj.execute("select * from OT_infoType where IT_level=1 order by IT_rank ASC")
					Do Until typeexe.EOF
						typeNum = typeNum + 1
						Set type2exe=conobj.execute("select * from OT_infoType where IT_level=2 and IT_fatID="& typeexe("IT_ID") &" order by IT_rank ASC")
							If type2exe.EOF Then
						response.write(_
						"<option value=',"& typeexe("IT_ID") &",' "& IsInstrSelected(CI_infoTypeStr,","& typeexe("IT_ID") &",") &">"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
						"")
							Else
						response.write(_
						"<optgroup label='"& typeNum &"、"& typeexe("IT_theme") &"' style='font-weight:normal;'></optgroup>"&_
						"")
							End If
							Do Until type2exe.EOF
								response.write(_
								"<option value=',"& typeexe("IT_ID") &","& type2exe("IT_ID") &",' "& IsInstrSelected(CI_infoTypeStr,","& type2exe("IT_ID") &",") &">&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								"")
							type2exe.movenext()
							Loop
						type2exe.close

					typeexe.movenext()
					Loop
				typeexe.close
				Set typeexe=Nothing
				response.write(_
				"</select>&nbsp;"&_
				"<span class='font2_2'>&nbsp;如果有二级分类,一级分类不能选择</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"目标网页编码：</td>"&_
			"<td align='left'>"&_
				"<select id='charset' name='charset'>"&_
					"<option value='GB2312' "& IsSelected("GB2312",CI_charset) &">GB2312</option>"&_
					"<option value='UTF-8' "& IsSelected("UTF-8",CI_charset) &">UTF-8</option>"&_
					"<option value='BIG5' "& IsSelected("BIG5",CI_charset) &">BIG5</option>"&_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"采集网址URL：</td>"&_
			"<td align='left'><input type='text' id='webURL' name='webURL' size='50' style='width:450px;' value="""& CI_URL &""" /></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>分页/多页采集设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='pageMode' onclick='CheckPageMode()' value='' "& IsChecked(CI_pageMode,"") &" />不作设置</label>&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<label><input type='radio' name='pageMode' onclick='CheckPageMode()' value='more' "& IsChecked(CI_pageMode,"more") &" />批量生成</label>&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<label><input type='radio' name='pageMode' onclick='CheckPageMode()' value='list' "& IsChecked(CI_pageMode,"list") &" />手动添加</label>&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<label><input type='radio' name='pageMode' onclick='CheckPageMode()' value='code' "& IsChecked(CI_pageMode,"code") &" />代码获取</label>&nbsp;&nbsp;&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='pageMode_more' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"批量生成：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='pageURL' name='pageURL' size='50' style='width:450px;' value="""& CI_pageURL &""" />"&_
				"&nbsp;分页代码 <span class='font2_2'>{$ID}</span><br />"&_
				"格式：http://www.scuta.net/list.asp?page={$ID}<br />"&_
				"生成范围：<br />"&_
				"<input type='text' id='pageNum1' name='pageNum1' style='width:40px;' value='"& CI_pageNum1 &"' />&nbsp;至&nbsp;<input type='text' id='pageNum2' name='pageNum2' style='width:40px;' value='"& CI_pageNum2 &"' />  例如：1 - 9 或者 9 - 1<br />"&_
				"格式：只能是数字，可升序或者降序。 "&_
			"</td>"&_
		"</tr>"&_
		"<tr id='pageMode_list' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"手动添加：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='pageList' name='pageList' style='width:450px;height:80px;'>"& CI_pageList &"</textarea>"&_
				"<br /><span class='font2_2'>格式：输入一个网址后按回车，再输入下一个</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='pageMode_code' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='pageCode1' name='pageCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_pageCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='pageCode2' name='pageCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_pageCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr>"&_
			"<td align='right'>采集属性：</td>"&_
			"<td align='left'>"&_
				"<label><input type='checkbox' name='addition' value='|add|' "& IsInstrChecked(CI_addition,"|add|") &" />立即入库</label>&nbsp;&nbsp;"&_
				"<label><input type='checkbox' name='addition' value='|saveImg|' "& IsInstrChecked(CI_addition,"|saveImg|") &" />保存远程图片</label>&nbsp;&nbsp;"&_
				"<!-- <label><input type='checkbox' name='addition' value='|imgWater|' "& IsInstrChecked(CI_addition,"|imgWater|") &" />图片水印</label>&nbsp;&nbsp;"&_
				"<label><input type='checkbox' name='addition' value='|timing|' "& IsInstrChecked(CI_addition,"|timing|") &" />定时采集</label>&nbsp;&nbsp; -->"&_
				"<label title='在列表链接页，常规是从上到下采集，倒序采集即从下到上采集'><input type='checkbox' name='addition' value='|reverse|' "& IsInstrChecked(CI_addition,"|reverse|") &" />倒序采集</label>&nbsp;&nbsp;"&_
				"<label title='过滤源代码的制表符、回车、换行'><input type='checkbox' name='addition' value='|comp|' "& IsInstrChecked(CI_addition,"|comp|") &" />源代码压缩</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>状态：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='state' value='1' "& IsChecked(CI_state,1) &" />显示</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='state' value='0' "& IsChecked(CI_state,0) &" />隐藏</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>高级设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isHighSet' onclick='CheckHighSet()' value='1' "& IsChecked(CI_isHighSet,1) &" />设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isHighSet' onclick='CheckHighSet()' value='0' "& IsChecked(CI_isHighSet,0) &" />不设置</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='highSetBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>过滤html标签：</td>"&_
			"<td align='left' id='htmlMarkBox'>"&_
				"<div><label title='框架'><input type='checkbox' name='htmlMarkStr' value='iframe' "& IsInstrChecked(CI_htmlMarkStr,"|iframe|") &" />框架(iframe)</label></div>"&_
				"<div><label title='对象(多媒体/flash)'><input type='checkbox' name='htmlMarkStr' value='object' "& IsInstrChecked(CI_htmlMarkStr,"|object|") &" />多媒体(object)</label></div>"&_
				"<div><label title='JS脚本'><input type='checkbox' name='htmlMarkStr' value='script' "& IsInstrChecked(CI_htmlMarkStr,"|script|") &" />JS脚本(script)</label></div>"&_
				"<!-- <div><label><input type='checkbox' name='htmlMarkStr' value='class' "& IsInstrChecked(CI_htmlMarkStr,"|class") &" />class</label></div> -->"&_
				"<div><label title='表格'><input type='checkbox' name='htmlMarkStr' value='table' "& IsInstrChecked(CI_htmlMarkStr,"|table|") &" />表格(table)</label></div>"&_
				"<!-- <div><label title='表格行'><input type='checkbox' name='htmlMarkStr' value='tr' "& IsInstrChecked(CI_htmlMarkStr,"|tr|") &" />tr</label></div>"&_
				"<div><label title='表格单元格'><input type='checkbox' name='htmlMarkStr' value='td' "& IsInstrChecked(CI_htmlMarkStr,"|td|") &" />td</label></div> -->"&_
				"<!-- <div><label><input type='checkbox' name='htmlMarkStr' value='html' "& IsInstrChecked(CI_htmlMarkStr,"|html|") &" />html</label></div> -->"&_
				"<div><label title='块级元素'><input type='checkbox' name='htmlMarkStr' value='div' "& IsInstrChecked(CI_htmlMarkStr,"|div|") &" />块级元素(div)</label></div>"&_
				"<div><label title='行内元素'><input type='checkbox' name='htmlMarkStr' value='span' "& IsInstrChecked(CI_htmlMarkStr,"|span|") &" />行内元素(span)</label></div>"&_
				"<div><label title='图片'><input type='checkbox' name='htmlMarkStr' value='img' "& IsInstrChecked(CI_htmlMarkStr,"|img|") &" />图片(img)</label></div>"&_
				"<div><label title='文字样式'><input type='checkbox' name='htmlMarkStr' value='font' "& IsInstrChecked(CI_htmlMarkStr,"|font|") &" />文字标签(font)</label></div>"&_
				"<div><label title='超链接'><input type='checkbox' name='htmlMarkStr' value='a' "& IsInstrChecked(CI_htmlMarkStr,"|a|") &" />超链接(a)</label></div>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>内容字符串替换：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='strReplace' name='strReplace' style='width:450px;height:80px;'>"& CI_strReplace &"</textarea>"&_
				"<br /><span class='font2_2'>格式：替换前的字符串|替换后的字符串，一行一个</span>&nbsp;&nbsp;<span class='font3_2 pointer' onclick=""$id('strReplace').value='替换前的字符串1|替换后的字符串1\n替换前的字符串2|替换后的字符串2'"">[范例]</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>成功采集数量限制：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='successNum' name='successNum' size='50' style='width:30px;' value="""& CI_successNum &""" />"&_
				"<span class='font2_2'>&nbsp;0表示不受限制</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>初始点击数：</td>"&_
			"<td align='left'><input type='text' id='readNum' name='readNum' size='50' style='width:30px;' value="""& CI_readNum &""" /></td>"&_
		"</tr>"&_
		"</tbody>"&_
		"</table>"&_
		"")
	Call ShareTableBottom()
             


	response.write(_
	"<table style='height:16px;' cellpadding='0' cellspacing='0' summary=''><tr><td></td></tr></table>"&_

	"<center>"&_
		"<img src='images/button_back.gif' onclick=""document.location.href='?mudi=manage&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& dataID &"&isSourceCode="& isSourceCode &"';"" class='pointer' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;"&_
		"<input type='image' src='images/button_next.gif' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label><input type='checkbox' id='isSourceCode' name='isSourceCode' value='1' "& IsChecked(isSourceCode,1) &" />显示源代码并检查标签设置</label>"&_
	"</center>"&_

	"</form>"&_
	"")

End Sub





' 列表链接设置
Private Sub Step1()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	isSourceCode= ToGetInt("isSourceCode")


	dataID=ToGetInt("dataID")
	Set revexe=collObj.execute("select top 1 * from OT_collItem where CI_ID="& dataID)
		If revexe.EOF Then
			JS_AlertBackEnd("无该记录！")
		End If
	CI_ID			= revexe("CI_ID")
	CI_charset		= revexe("CI_charset")
	CI_URL			= revexe("CI_URL")
	CI_addition		= revexe("CI_addition")
	CI_listCode1	= Html_ReplaceTrim(revexe("CI_listCode1"),CI_addition)
	CI_listCode2	= Html_ReplaceTrim(revexe("CI_listCode2"),CI_addition)
	CI_hrefCode1	= Html_ReplaceTrim(revexe("CI_hrefCode1"),CI_addition)
	CI_hrefCode2	= Html_ReplaceTrim(revexe("CI_hrefCode2"),CI_addition)
	CI_isHrefURL	= revexe("CI_isHrefURL")
	CI_hrefURL		= revexe("CI_hrefURL")
	CI_isImg		= revexe("CI_isImg")
	CI_imgCode1		= Html_ReplaceTrim(revexe("CI_imgCode1"),CI_addition)
	CI_imgCode2		= Html_ReplaceTrim(revexe("CI_imgCode2"),CI_addition)
	CI_isImgURL		= revexe("CI_isImgURL")
	CI_imgURL		= revexe("CI_imgURL")


	If isSourceCode=1 Then
		sourceCode = Html_GetCode(CI_URL,CI_charset)
		sourceCode = Html_ReplaceTrim(sourceCode,CI_addition)
		If sourceCode="False" Then
			sourceCode = "在获取:" & CI_URL & "网页源码时发生错误"
		End If
		Call ShareTableTop("share_refer.gif","","采集目标网址源代码")
			response.write(_
			"<table width='100%' border='0' align='center' cellpadding='0' cellspacing='0' >"&_
			"<tr>"&_
				"<td align='left'>"&_
					"源代码窗口："&_
					"<label><input type='radio' name='isCode' value='0' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,0) &" />隐藏</label>&nbsp;&nbsp;"&_
					"<label><input type='radio' name='isCode' value='1' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,1) &" />显示</label>"&_
				"</td>"&_
			"</tr>"&_
			"<tr id='sourceCodeBox'>"&_
				"<td align='center' style='line-height:1.4;'>"&_
					"<textarea name='sourceCode' style='width:780px; height:120px;'>"& ReplaceStr(sourceCode,"input") &"</textarea><br>"&_
					"<b>采集的目标地址：</b><a href='"& CI_URL &"' target='_blank' class='font1_2'>"& CI_URL &"</a>"&_
				"</td>"&_
			"</tr>"&_
			"</table>"&_
			"")

		Call ShareTableBottom()


		response.write(_
		"<br />"&_
		"")
	End If
	
	response.write(_
	"<form name='addform' method='post' action='collItem_deal.asp?mudi="& mudi &"&nohrefStr=close' onsubmit='return CheckStep1Form()'>"&_
	"<input type='hidden' id='dataID' name='dataID' value='"& dataID &"' />"&_
	"<input type='hidden' id='dataTypeCN' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"<input type='hidden' id='dataType' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' id='dataMode' name='dataMode' value='"& dataMode &"' />"&_
	"<input type='hidden' id='dataModeStr' name='dataModeStr' value='"& dataModeStr &"' />"&_
	"")

	Call ShareTableTop("share_list.gif","","列表链接设置")
		response.write(_
		"<table width='98%' align='center' cellpadding='0' cellspacing='0' summary='' class='padd3'>"&_
		"<tr>"&_
			"<td width='20%'></td>"&_
			"<td width='80%'></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"列表开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='listCode1' name='listCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_listCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"列表结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='listCode2' name='listCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_listCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"链接开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='hrefCode1' name='hrefCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_hrefCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"链接结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='hrefCode2' name='hrefCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_hrefCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>重定链接地址：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isHrefURL' onclick='CheckHrefURL()' value='0' "& IsChecked(CI_isHrefURL,0) &" />自动处理</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isHrefURL' onclick='CheckHrefURL()' value='1' "& IsChecked(CI_isHrefURL,1) &" />重新链接位置</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='hrefUrlBox' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'><br /></td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='hrefURL' name='hrefURL' size='50' style='width:450px;' value="""& CI_hrefURL &""" />"&_
				"&nbsp;链接代码 <span class='font2_2'>{$ID}</span><br />"&_
				"如:javascript:OpenLink('<span class='font2_2'>123</span>')<br />"&_
				"function OpenLink(ID){ window.open('<span class='font2_2'>http://otcms.com/</span>'+ ID +'<span class='font2_2'>.html</span>'); }<br />"&_
				"<span class='font2_2'>正确设置:http://otcms.com/{$ID}.html</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>列表小图设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isImg' onclick='CheckImgCode()' value='0' "& IsChecked(CI_isImg,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isImg' onclick='CheckImgCode()' value='1' "& IsChecked(CI_isImg,1) &" />列表小图</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='imgCodeBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"列表小图开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='imgCode1' name='imgCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_imgCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"列表小图结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='imgCode2' name='imgCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_imgCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>重定小图链接地址：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isImgURL' onclick='CheckImgURL()' value='0' "& IsChecked(CI_isImgURL,0) &" />自动设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isImgURL' onclick='CheckImgURL()' value='1' "& IsChecked(CI_isImgURL,1) &" />重新链接位置</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='imgUrlBox' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'><br /></td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='imgURL' name='imgURL' size='50' style='width:450px;' value="""& CI_imgURL &""" />"&_
				"&nbsp;小图链接代码 <span class='font2_2'>{$ID}</span><br />"&_
				"如:http://otcms.com/news/下&lt;img src='<span class='font2_2'>image/123.gif</span>' /><br />"&_
				"<span class='font2_2'>正确设置:http://otcms.com/news/{$ID}</span>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"</table>"&_
		"")
	Call ShareTableBottom()
             


	response.write(_
	"<table style='height:16px;' cellpadding='0' cellspacing='0' summary=''><tr><td></td></tr></table>"&_

	"<center>"&_
		"<img src='images/button_prev.gif' onclick=""document.location.href='?mudi=rev&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& dataID &"&isSourceCode='+ CheckIsSourceCodeBox() +'';"" class='pointer' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;"&_
		"<input type='image' src='images/button_next.gif' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label><input type='checkbox' id='isSourceCode' name='isSourceCode' value='1' "& IsChecked(isSourceCode,1) &" />显示源代码并检查标签设置</label>"&_
	"</center>"&_

	"</form>"&_
	"")

End Sub





' 正文采集设置
Private Sub Step2()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	isSourceCode= ToGetInt("isSourceCode")
	dataID		= ToGetInt("dataID")
	backURL = "?mudi=step1&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& dataID &"&isSourceCode="

	Set revexe=collObj.execute("select top 1 * from OT_collItem where CI_ID="& dataID)
		If revexe.EOF Then
			JS_AlertBackEnd("无该记录！")
		End If
	CI_ID			= revexe("CI_ID")
	CI_charset		= revexe("CI_charset")
	CI_URL			= revexe("CI_URL")
	CI_addition		= revexe("CI_addition")
	CI_listCode1	= Html_ReplaceTrim(revexe("CI_listCode1"),CI_addition)
	CI_listCode2	= Html_ReplaceTrim(revexe("CI_listCode2"),CI_addition)
	CI_hrefCode1	= Html_ReplaceTrim(revexe("CI_hrefCode1"),CI_addition)
	CI_hrefCode2	= Html_ReplaceTrim(revexe("CI_hrefCode2"),CI_addition)
	CI_isHrefURL	= revexe("CI_isHrefURL")
	CI_hrefURL		= revexe("CI_hrefURL")
	CI_isImg		= revexe("CI_isImg")
	CI_imgCode1		= Html_ReplaceTrim(revexe("CI_imgCode1"),CI_addition)
	CI_imgCode2		= Html_ReplaceTrim(revexe("CI_imgCode2"),CI_addition)
	CI_isImgURL		= revexe("CI_isImgURL")
	CI_imgURL		= revexe("CI_imgURL")
	CI_themeCode1	= Html_ReplaceTrim(revexe("CI_themeCode1"),CI_addition)
	CI_themeCode2	= Html_ReplaceTrim(revexe("CI_themeCode2"),CI_addition)
	CI_contentCode1	= Html_ReplaceTrim(revexe("CI_contentCode1"),CI_addition)
	CI_contentCode2	= Html_ReplaceTrim(revexe("CI_contentCode2"),CI_addition)
	CI_isConPage	= revexe("CI_isConPage")
	CI_conPageCode1	= Html_ReplaceTrim(revexe("CI_conPageCode1"),CI_addition)
	CI_conPageCode2	= Html_ReplaceTrim(revexe("CI_conPageCode2"),CI_addition)
	CI_conHrefCode1	= Html_ReplaceTrim(revexe("CI_conHrefCode1"),CI_addition)
	CI_conHrefCode2	= Html_ReplaceTrim(revexe("CI_conHrefCode2"),CI_addition)
	CI_isConHrefURL	= revexe("CI_isConHrefURL")
	CI_conHrefURL	= revexe("CI_conHrefURL")
	CI_isTime		= revexe("CI_isTime")
	CI_timeCode1	= Html_ReplaceTrim(revexe("CI_timeCode1"),CI_addition)
	CI_timeCode2	= Html_ReplaceTrim(revexe("CI_timeCode2"),CI_addition)
	CI_isWriter		= revexe("CI_isWriter")
	CI_writerCode1	= Html_ReplaceTrim(revexe("CI_writerCode1"),CI_addition)
	CI_writerCode2	= Html_ReplaceTrim(revexe("CI_writerCode2"),CI_addition)
	CI_writerName	= revexe("CI_writerName")
	CI_isSource		= revexe("CI_isSource")
	CI_sourceCode1	= Html_ReplaceTrim(revexe("CI_sourceCode1"),CI_addition)
	CI_sourceCode2	= Html_ReplaceTrim(revexe("CI_sourceCode2"),CI_addition)
	CI_sourceName	= revexe("CI_sourceName")
	CI_isKey		= revexe("CI_isKey")
	CI_keyCode1		= Html_ReplaceTrim(revexe("CI_keyCode1"),CI_addition)
	CI_keyCode2		= Html_ReplaceTrim(revexe("CI_keyCode2"),CI_addition)
	CI_keyName		= revexe("CI_keyName")


	If isSourceCode=1 Then
		sourceCode = Html_GetCode(CI_URL,CI_charset)
		sourceCode = Html_ReplaceTrim(sourceCode,CI_addition)
		If sourceCode="False" Then
			Call JS_AlertHrefEnd("在获取:" & CI_URL & "网页源码时发生错误，请检查采集网址URL。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
		Else
			listCode=Html_GetStr(sourceCode,CI_listCode1,CI_listCode2,False,False)
			If listCode="False" Then 
				Call JS_AlertHrefEnd("在截取列表时发生错误，请重新调整列表代码。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
			Else
				hrefArrStr=Html_GetArrStr(listCode,CI_hrefCode1,CI_hrefCode2,False,False)
				If hrefArrStr="False" Then
					Call JS_AlertHrefEnd("在获取链接列表时出错，请重新调整列表链接标签。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
				Else
					hrefArr=Split(hrefArrStr,"[OT]")
					For i=0 To Ubound(hrefArr)
						If CI_isHrefURL=1 Then
							hrefArr(i)=Replace(CI_hrefURL,"{$ID}",hrefArr(i))
						Else
							hrefArr(i)=Html_RealUrl(hrefArr(i),CI_URL)
						End If
					Next
					href1=hrefArr(0)
					href1Code=Html_GetCode(href1,CI_charset)
					href1Code=Html_ReplaceTrim(href1Code,CI_addition)
				End If

				If CI_isImg=1 Then
					imgArrStr=Html_GetArrStr(listCode,CI_imgCode1,CI_imgCode2,False,False)
					imgArr=Split(imgArrStr,"[OT]")
					For i=0 To Ubound(imgArr)
						If CI_isImgURL=1 Then
							imgArr(i)=Replace(CI_imgURL,"{$ID}",imgArr(i))
						Else
							imgArr(i)=Html_RealUrl(imgArr(i),CI_URL)
						End If
					Next
				End If
			End If
		End If
		
		Call ShareTableTop("share_refer.gif","","采集目标网址源代码")
			response.write(_
			"<table border='0' align='center' cellpadding='0' cellspacing='0' >"&_
			"<tr>"&_
				"<td align='left'>"&_
					"源代码窗口："&_
					"<label><input type='radio' name='isCode' value='0' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,0) &" />隐藏</label>&nbsp;&nbsp;"&_
					"<label><input type='radio' name='isCode' value='1' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,1) &" />显示</label>"&_
				"</td>"&_
			"</tr>"&_
			"<tr id='sourceCodeBox'>"&_
				"<td align='center' style='line-height:1.4;'>"&_
					"<b>采集的目标地址：</b><a href='"& CI_URL &"' target='_blank' class='font1_2'>"& CI_URL &"</a>"&_
				"</td>"&_
			"</tr>"&_
			"<tr id='sourceCodeBox'>"&_
				"<td align='center' style='line-height:1.4;'>"&_
					"<textarea name='sourceCode' style='width:780px; height:120px;'>"& vbcrlf & ReplaceStr(href1Code,"textarea") & vbcrlf &"</textarea><br>"&_
					"<table align='left' cellpadding='0' cellspacing='0' style='margin-top:10px;'>"&_
					"<tr><td align='center' class='font2_2 fontB'>采集的目标地址</td><td align='center' class='font2_2 fontB'>采集的列表小图</td></tr>"&_
					"")
						imgCount = -1
						If CI_isImg=1 Then imgCount = Ubound(imgArr)
						For i=0 To Ubound(hrefArr)
							response.write(_
							"<tr>"&_
								"<td align='left' style='padding:5px;'><span style='color:red;'>【"& Right("00"& (i+1),3) &"】</span><a href='"& hrefArr(i) &"' target='_blank' class='font1_1'>"& hrefArr(i) &"</a></td>"&_
								"<td align='center' style='padding:5px;'>"&_
								"")
									If imgCount>=i Then
										response.write(_
										"<a href='"& imgArr(i) &"' target='_blank' class='font1_1'><img src='"& imgArr(i) &"' width='80' /></a>"&_
										"")
									End If
								response.write(_
								"</td>"&_
							"</tr>"&_
							"")
						Next
					response.write(_
					"</table>"&_
				"</td>"&_
			"</tr>"&_
			"</table>"&_
			"")

		Call ShareTableBottom()


		response.write(_
		"<br />"&_
		"")
	End If
	
	response.write(_
	"<form name='addform' method='post' action='collItem_deal.asp?mudi="& mudi &"&nohrefStr=close' onsubmit='return CheckStep2Form()'>"&_
	"<input type='hidden' id='dataID' name='dataID' value='"& dataID &"' />"&_
	"<input type='hidden' id='dataTypeCN' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"<input type='hidden' id='dataType' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' id='dataMode' name='dataMode' value='"& dataMode &"' />"&_
	"<input type='hidden' id='dataModeStr' name='dataModeStr' value='"& dataModeStr &"' />"&_

	"<input type='hidden' id='itemHref' name='itemHref' value='"& href1 &"' />"&_
	"")

	Call ShareTableTop("share_list.gif",""," 正文内容设置")
		response.write(_
		"<table width='98%' align='center' cellpadding='0' cellspacing='0' summary='' class='padd3'>"&_
		"<tr>"&_
			"<td width='20%'></td>"&_
			"<td width='80%'></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"标题开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='themeCode1' name='themeCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_themeCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"标题结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='themeCode2' name='themeCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_themeCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"正文开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='contentCode1' name='contentCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_contentCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"正文结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='contentCode2' name='contentCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_contentCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>正文分页设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isConPage' onclick='CheckConPage()' value='0' "& IsChecked(CI_isConPage,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isConPage' onclick='CheckConPage()' value='1' "& IsChecked(CI_isConPage,1) &" />正文分页(列表型)</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isConPage' onclick='CheckConPage()' value='2' "& IsChecked(CI_isConPage,2) &" />正文分页(下一页型)</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='conPageBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='conPageCode1' name='conPageCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_conPageCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='conPageCode2' name='conPageCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_conPageCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页链接开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='conHrefCode1' name='conHrefCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_conHrefCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"分页链接结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='conHrefCode2' name='conHrefCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_conHrefCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>重定分页链接地址：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isConHrefURL' onclick='CheckConHrefURL()' value='0' "& IsChecked(CI_isConHrefURL,0) &" />自动设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isConHrefURL' onclick='CheckConHrefURL()' value='1' "& IsChecked(CI_isConHrefURL,1) &" />重新链接位置</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='conHrefUrlBox' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'><br /></td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='conHrefURL' name='conHrefURL' size='50' style='width:450px;' value="""& CI_conHrefURL &""" />"&_
				"&nbsp;分页链接代码 <span class='font2_2'>{$ID}</span><br />"&_
				"如:javascript:OpenLink('<span class='font2_2'>123</span>')<br />"&_
				"function OpenLink(ID){ window.open('<span class='font2_2'>http://otcms.com/</span>'+ ID +'<span class='font2_2'>.html</span>'); }<br />"&_
				"<span class='font2_2'>正确设置:http://otcms.com/{$ID}.html</span>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr>"&_
			"<td align='right'>时间设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isTime' onclick='CheckTime()' value='0' "& IsChecked(CI_isTime,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isTime' onclick='CheckTime()' value='1' "& IsChecked(CI_isTime,1) &" />设置标签</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='timeBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"时间开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='timeCode1' name='timeCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_timeCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"时间结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='timeCode2' name='timeCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_timeCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr>"&_
			"<td align='right'>作者设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isWriter' onclick='CheckWriter()' value='0' "& IsChecked(CI_isWriter,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isWriter' onclick='CheckWriter()' value='1' "& IsChecked(CI_isWriter,1) &" />设置标签</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isWriter' onclick='CheckWriter()' value='2' "& IsChecked(CI_isWriter,2) &" />指定作者</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='writerBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"作者开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='writerCode1' name='writerCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_writerCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"作者结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='writerCode2' name='writerCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_writerCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr id='writer2Box' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"指定作者：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='writerName' name='writerName' style='width:120px;' value="""& ReplaceStr(CI_writerName,"input") &""" />"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>来源设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isSource' onclick='CheckSource()' value='0' "& IsChecked(CI_isSource,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isSource' onclick='CheckSource()' value='1' "& IsChecked(CI_isSource,1) &" />设置标签</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isSource' onclick='CheckSource()' value='2' "& IsChecked(CI_isSource,2) &" />指定来源</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='sourceBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"来源开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='sourceCode1' name='sourceCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_sourceCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"来源结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='sourceCode2' name='sourceCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_sourceCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr id='source2Box' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"指定来源：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='sourceName' name='sourceName' style='width:120px;' value="""& ReplaceStr(CI_sourceName,"input") &""" />"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>关键字词设置：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isKey' onclick='CheckKey()' value='0' "& IsChecked(CI_isKey,0) &" />不作设置</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isKey' onclick='CheckKey()' value='1' "& IsChecked(CI_isKey,1) &" />设置标签</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isKey' onclick='CheckKey()' value='2' "& IsChecked(CI_isKey,2) &" />指定关键字词</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tbody id='keyBox' style='display:none;'>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"关键字词开始代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='keyCode1' name='keyCode1' style='width:450px;height:80px;'>"& ReplaceStr(CI_keyCode1,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"关键字词结束代码：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<textarea id='keyCode2' name='keyCode2' style='width:450px;height:80px;'>"& ReplaceStr(CI_keyCode2,"input") &"</textarea>"&_
			"</td>"&_
		"</tr>"&_
		"</tbody>"&_
		"<tr id='key2Box' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"指定关键字词：</td>"&_
			"<td align='left' style='line-height:1.4;'>"&_
				"<input type='text' id='keyName' name='keyName' style='width:120px;' value="""& ReplaceStr(CI_keyName,"input") &""" />"&_
			"</td>"&_
		"</tr>"&_
		"</table>"&_
		"")
	Call ShareTableBottom()
             


	response.write(_
	"<table style='height:16px;' cellpadding='0' cellspacing='0' summary=''><tr><td></td></tr></table>"&_

	"<center>"&_
		"<img src='images/button_prev.gif' onclick=""document.location.href='"& backURL &"'+ CheckIsSourceCodeBox() +'';"" class='pointer' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;"&_
		"<input type='image' src='images/button_next.gif' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label><input type='checkbox' id='isSourceCode' name='isSourceCode' value='1' "& IsChecked(isSourceCode,1) &" />显示源代码并检查标签设置</label>"&_
	"</center>"&_

	"</form>"&_
	"")

End Sub





' 正文采集效果
Private Sub Step3()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	isSourceCode= ToGetInt("isSourceCode")
	dataID		= ToGetInt("dataID")
	backURL = "?mudi=step2&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& dataID &"&isSourceCode="


	If isSourceCode=1 Then		
		Set revexe=collObj.execute("select top 1 * from OT_collItem where CI_ID="& dataID)
			If revexe.EOF Then
				JS_AlertBackEnd("无该记录！")
			End If
		CI_ID			= revexe("CI_ID")
		CI_charset		= revexe("CI_charset")
		CI_URL			= revexe("CI_URL")
		CI_addition		= revexe("CI_addition")
		CI_isHighSet	= revexe("CI_isHighSet")
		CI_htmlMarkStr	= revexe("CI_htmlMarkStr")
		CI_strReplace	= revexe("CI_strReplace")

		CI_listCode1	= Html_ReplaceTrim(revexe("CI_listCode1"),CI_addition)
		CI_listCode2	= Html_ReplaceTrim(revexe("CI_listCode2"),CI_addition)
		CI_hrefCode1	= Html_ReplaceTrim(revexe("CI_hrefCode1"),CI_addition)
		CI_hrefCode2	= Html_ReplaceTrim(revexe("CI_hrefCode2"),CI_addition)
		CI_isHrefURL	= revexe("CI_isHrefURL")
		CI_hrefURL		= revexe("CI_hrefURL")

		CI_itemHref		= revexe("CI_itemHref")
		CI_themeCode1	= Html_ReplaceTrim(revexe("CI_themeCode1"),CI_addition)
		CI_themeCode2	= Html_ReplaceTrim(revexe("CI_themeCode2"),CI_addition)
		CI_contentCode1	= Html_ReplaceTrim(revexe("CI_contentCode1"),CI_addition)
		CI_contentCode2	= Html_ReplaceTrim(revexe("CI_contentCode2"),CI_addition)
		CI_isConPage	= revexe("CI_isConPage")
		CI_conPageCode1	= Html_ReplaceTrim(revexe("CI_conPageCode1"),CI_addition)
		CI_conPageCode2	= Html_ReplaceTrim(revexe("CI_conPageCode2"),CI_addition)
		CI_conHrefCode1	= Html_ReplaceTrim(revexe("CI_conHrefCode1"),CI_addition)
		CI_conHrefCode2	= Html_ReplaceTrim(revexe("CI_conHrefCode2"),CI_addition)
		CI_isConHrefURL	= revexe("CI_isConHrefURL")
		CI_conHrefURL	= revexe("CI_conHrefURL")
		CI_isTime		= revexe("CI_isTime")
		CI_timeCode1	= Html_ReplaceTrim(revexe("CI_timeCode1"),CI_addition)
		CI_timeCode2	= Html_ReplaceTrim(revexe("CI_timeCode2"),CI_addition)
		CI_isWriter		= revexe("CI_isWriter")
		CI_writerCode1	= Html_ReplaceTrim(revexe("CI_writerCode1"),CI_addition)
		CI_writerCode2	= Html_ReplaceTrim(revexe("CI_writerCode2"),CI_addition)
		CI_writerName	= revexe("CI_writerName")
		CI_isSource		= revexe("CI_isSource")
		CI_sourceCode1	= Html_ReplaceTrim(revexe("CI_sourceCode1"),CI_addition)
		CI_sourceCode2	= Html_ReplaceTrim(revexe("CI_sourceCode2"),CI_addition)
		CI_sourceName	= revexe("CI_sourceName")
		CI_isKey		= revexe("CI_isKey")
		CI_keyCode1		= Html_ReplaceTrim(revexe("CI_keyCode1"),CI_addition)
		CI_keyCode2		= Html_ReplaceTrim(revexe("CI_keyCode2"),CI_addition)
		CI_keyName		= revexe("CI_keyName")

		Dim errStr
'				CI_itemHref = "http://fitness.39.net/a/20101011/1491200.html"
		If Len(""& CI_itemHref)<10 Then
			sourceCode	= Html_GetCode(CI_URL,CI_charset)
			sourceCode	= Html_ReplaceTrim(sourceCode,CI_addition)
			listCode	= Html_GetStr(sourceCode,CI_listCode1,CI_listCode2,False,False)
			hrefArrStr	= Html_GetArrStr(listCode,CI_hrefCode1,CI_hrefCode2,False,False)
			If hrefArrStr="False" Then
				Call JS_AlertHrefEnd("在获取列表链接时发生错误，请检查列表代码或链接代码。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
			Else
				hrefArr=Split(hrefArrStr,"[OT]")
				If CI_isHrefURL=1 Then
					hrefArr(0)=Replace(CI_hrefURL,"{$ID}",hrefArr(0))
				Else
					hrefArr(0)=Html_RealUrl(hrefArr(0),CI_URL)
				End If
				CI_itemHref = hrefArr(0)
				collObj.execute("update OT_collItem set CI_itemHref='"& SqlForStr(CI_itemHref) &"' where CI_ID="& dataID)
			End If
		End If

		sourceCode = Html_GetCode(CI_itemHref,CI_charset)
		sourceCode = Html_ReplaceTrim(sourceCode,CI_addition)
		If sourceCode="False" Then
			Call JS_AlertHrefEnd("在获取:" & CI_itemHref & "网页源码时发生错误，请检查采集网址URL。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
		Else
	'		If CI_isHighSet=1 Then
	'			If CI_htmlMarkStr<>"" Then
				
	'			End If
	'			If CI_strReplace<>"" Then
				
	'			End If
	'		End If
			themeStr	= Html_GetStr(sourceCode,CI_themeCode1,CI_themeCode2,False,False)
			contentStr	= Html_GetStr(sourceCode,CI_contentCode1,CI_contentCode2,False,False)
			If themeStr="False" Then
				Call JS_AlertHrefEnd("在获取标题时发生错误，请检查标题代码。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
			End If
			If contentStr="False" Then
				Call JS_AlertHrefEnd("在获取正文时发生错误，请检查正文代码。\n\n可能原因：\n"& collErrStr &"",backURL & isSourceCode)
			End If
			If CI_isConPage=1 Then
				conPageCode		= Html_GetStr(sourceCode,CI_conPageCode1,CI_conPageCode2,False,False)
				conHrefArrStr	= Html_GetArrStr(conPageCode,CI_conHrefCode1,CI_conHrefCode2,False,False)
				If conHrefArrStr<>"False" Then
					conHrefArr=Split(conHrefArrStr,"[OT]")
					For i=0 To Ubound(conHrefArr)
						If CI_isConHrefURL=1 Then
							conHrefArr(i)=Replace(CI_conHrefURL,"{$ID}",conHrefArr(i))
						Else
							conHrefArr(i)=Html_RealUrl(conHrefArr(i),CI_itemHref)
						End If
					Next
				End If
			ElseIf CI_isConPage=2 Then
				conPageCode		= Html_GetStr(sourceCode,CI_conPageCode1,CI_conPageCode2,False,False)
				conHrefStr		= Html_GetStr(conPageCode,CI_conHrefCode1,CI_conHrefCode2,False,False)
				If conHrefStr<>"False" Then
					If CI_isConHrefURL=1 Then
						conHrefStr=Replace(CI_conHrefURL,"{$ID}",conHrefStr)
					Else
						conHrefStr=Html_RealUrl(conHrefStr,CI_itemHref)
					End If
					conHrefArrStr = conHrefStr
					For Ci=1 To 20
						conPageCode		= Html_GetCode(conHrefStr,CI_charset)
						conPageCode		= Html_GetStr(conPageCode,CI_conPageCode1,CI_conPageCode2,False,False)
'					response.write(conHrefStr &" ")
'					response.End()
						conHrefStr		= Html_GetStr(conPageCode,CI_conHrefCode1,CI_conHrefCode2,False,False)
						If conHrefStr<>"False" Then
							If CI_isConHrefURL=1 Then
								conHrefStr=Replace(CI_conHrefURL,"{$ID}",conHrefStr)
							Else
								conHrefStr=Html_RealUrl(conHrefStr,CI_itemHref)
							End If
							conHrefArrStr = conHrefArrStr &"[OT]"& conHrefStr
						Else
							Exit For
						End If
					Next
					conHrefArr=Split(conHrefArrStr,"[OT]")
					For i=0 To Ubound(conHrefArr)
					Next
				End If
			End If
			timeStr="False"
			If CI_isTime=1 Then
				timeStr	= Html_GetStr(sourceCode,CI_timeCode1,CI_timeCode2,False,False)
			End If
			writerStr="False"
			If CI_isWriter=1 Then
				writerStr	= Html_GetStr(sourceCode,CI_writerCode1,CI_writerCode2,False,False)
			ElseIf CI_isWriter=2 Then
				writerStr	= CI_writerName
			End If
			sourceStr="False"
			If CI_isSource=1 Then
				sourceStr	= Html_GetStr(sourceCode,CI_sourceCode1,CI_sourceCode2,False,False)
			ElseIf CI_isSource=2 Then
				sourceStr	= CI_sourceName
			End If
			keyStr="False"
			If CI_isKey=1 Then
				keyStr	= Html_GetStr(sourceCode,CI_keyCode1,CI_keyCode2,False,False)
			ElseIf CI_isKey=2 Then
				keyStr	= CI_keyName
			End If
		End If


		Call ShareTableTop("share_refer.gif","","采集目标网址源代码")
			response.write(_
			"<table width='100%' border='0' align='center' cellpadding='0' cellspacing='0' >"&_
			"<tr>"&_
				"<td align='left'>"&_
					"源代码窗口："&_
					"<label><input type='radio' name='isCode' value='0' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,0) &" />隐藏</label>&nbsp;&nbsp;"&_
					"<label><input type='radio' name='isCode' value='1' onclick='CheckSourceCodeBox()' "& IsChecked(isSourceCode,1) &" />显示</label>"&_
				"</td>"&_
			"</tr>"&_
			"<tr id='sourceCodeBox'>"&_
				"<td align='center' style='line-height:1.4;'>"&_
					"<textarea name='sourceCode' style='width:780px; height:120px;'>"& ReplaceStr(sourceCode,"input") &"</textarea><br>"&_
				"</td>"&_
			"</tr>"&_
			"</table>"&_
			"")

		Call ShareTableBottom()


		response.write(_
		"<br />"&_
		"")


		Call ShareTableTop("share_list.gif",""," 正文内容采集效果")
			If errStr<>"" Then
				response.write(errStr)
			Else
				response.write(_
				"<table width='98%' align='center' cellpadding='0' cellspacing='0' summary='' class='padd3'>"&_
				"<colgroup width='10%' />"&_
				"<colgroup width='90%' />"&_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>标题：</b></td>"&_
					"<td align='left'>"& themeStr &"</td>"&_
				"</tr>"&_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>正文：</b></td>"&_
					"<td align='left'>"& ReplaceStr(contentStr,"input") &"</td>"&_
				"</tr>"&_
				"")
					If (CI_isConPage=1 Or CI_isConPage=2) And IsArray(conHrefArr) Then
				response.write(_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>分页链接列表：</b></td>"&_
					"<td align='left'>"&_
					"")
						For i=0 To Ubound(conHrefArr)
							response.write(conHrefArr(i) &"<br />")
						Next
					response.write(_
					"</td>"&_
				"</tr>"&_
				"")
					End If
					If timeStr<>"False" Then
				response.write(_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>发布时间：</b></td>"&_
					"<td align='left'>"& timeStr &"</td>"&_
				"</tr>"&_
				"")
					End If
					If writerStr<>"False" Then
				response.write(_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>作者：</b></td>"&_
					"<td align='left'>"& writerStr &"</td>"&_
				"</tr>"&_
				"")
					End If
					If sourceStr<>"False" Then
				response.write(_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>来源：</b></td>"&_
					"<td align='left'>"& sourceStr &"</td>"&_
				"</tr>"&_
				"")
					End If
					If keyStr<>"False" Then
				response.write(_
				"<tr>"&_
					"<td align='right' valign='top' style='padding-top:6px;'><b>关键字词：</b></td>"&_
					"<td align='left'>"& keyStr &"</td>"&_
				"</tr>"&_
				"")
					End If
				response.write(_
				"</table>"&_
				"")
			End If
		Call ShareTableBottom()

	Else
		Call ShareTableTop("share_list.gif",""," 正文内容采集效果")
			response.write(_
			"<br /><br /><center><a href='?mudi="& mudi &"&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& dataID &"&isSourceCode=1' class='font1_1'>点击查看正文内容采集效果</a></center><br />"&_
			"")
		Call ShareTableBottom()

	End If



	response.write(_
	"<table style='height:16px;' cellpadding='0' cellspacing='0' summary=''><tr><td></td></tr></table>"&_

	"<center>"&_
		"<img src='images/button_prev.gif' onclick=""document.location.href='"& backURL &"'+ CheckIsSourceCodeBox() +'';"" class='pointer' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;"&_
		"<img src='images/button_finish.gif' onclick=""document.location.href='?mudi=manage&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"';"" class='pointer' />"&_
		"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label><input type='checkbox' id='isSourceCode' name='isSourceCode' value='1' "& IsChecked(isSourceCode,1) &" />显示源代码并检查标签设置</label>"&_
	"</center>"&_

	"</form>"&_
	"")

End Sub




Private Sub manage()

	orderName=ToGetStr("orderName")
		If orderName<>"CI_theme" And orderName<>"CT_theme" And orderName<>"CI_revTime" And orderName<>"CI_state" Then orderName="CI_theme"
	orderSort=ToGetStr("orderSort")
		If orderSort<>"DESC" Then orderSort="ASC"

	response.write(_
	"<form name='listForm' method='post' action='' onsubmit='return CheckListForm2()'>"&_
	"<script language='javascript' type='text/javascript'>document.write (""<input type='hidden' name='URL' value='""+ document.location.href +""' />"")</script>"&_
	"<input type='hidden' name='dataMode' value='"& dataMode &"' />"&_
	"<input type='hidden' name='dataModeStr' value='"& dataModeStr &"' />"&_
	"<input type='hidden' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"")
	Call ShareTableTop2("share_list.gif","",""& dataTypeCN &"管理")
	Call ShareTableItemTitle("5%,5%,27%,15%,10%,9%,6%,21%","<input type='checkbox' name='selAll' onclick='CheckBoxAll()' />,序号,"& ShowArrow("项目名称","CI_theme",orderName,orderSort) &",所属栏目,"& ShowArrow("采集模块","CT_theme",orderName,orderSort) &","& ShowArrow("上次采集","CI_revTime",orderName,orderSort) &","& ShowArrow("状态","CI_state",orderName,orderSort) &",复制&nbsp;修改&nbsp;采集&nbsp;测试&nbsp;删除")

	Set showrec=server.CreateObject("ADODB.recordset")
	showrec.open "select CI.*,CT.CT_theme from OT_collItem as CI left join OT_collType as CT on CI.CI_typeID=CT.CT_ID order by "& orderName &" "& orderSort &"",collObj,3,1

	If Not showrec.EOF Then
		showPageSize=memberexe("MB_itemNum")		'每页条数
		showrec.pagesize=showPageSize	
		showPageCount=showrec.pagecount
		showCount=showrec.recordcount
		page=ToGetInt("page")
		if page < 1 Or page > showPageCount Then page=1
		showrec.absolutepage=page


		response.write(_
		"<tbody class='tabBody padd3'>"&_
		"")
		number=1+(page-1)*showPageSize
		For i=1 To showPageSize
			If showrec.EOF Then Exit For
			If i Mod 2 = 0 Then bgcolor="class='tabColorTr'" Else bgcolor=""
			imgHref = "&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataID="& showrec("CI_ID") &""
	response.write(_
	"<tr id='data"& showrec("CI_ID") &"' "& bgcolor &">"&_
		"<td align='center'><input type='checkbox' name='selDataID' value='"& showrec("CI_ID") &"' /></td>"&_
		"<td align='center'>"& number &"</td>"&_
		"<td align='left'>"& showrec("CI_theme") &"<br /></td>"&_
		"<td align='left'>"& Info_TypeStrCN(showrec("CI_infoTypeStr")) &"</td>"&_
		"<td align='center'>"& showrec("CT_theme") &"<br /></td>"&_
		"<td align='center'>"& showrec("CI_runTime") &"<br /></td>"&_
		"<td align='center'>"& ItemSwitchColl("OT_collItem",showrec("CI_ID"),showrec("CI_state"),"state","") &"<br /></td>"&_
		"<td align='center'>"&_
			"<img src='images/img_copy.gif' class='pointer' onclick=""document.location.href='collItem_deal.asp?mudi=copy"& imgHref &"&backURL='+ escape(document.location.href)"" alt='复制' />&nbsp;&nbsp;&nbsp;"&_
			"<img src='images/img_rev.gif' class='pointer' onclick=""document.location.href='?mudi=rev"& imgHref &"&backURL='+ escape(document.location.href)"" alt='修改' />&nbsp;&nbsp;"&_
			"<img src='images/img_db.gif' class='pointer' onclick=""document.location.href='collRun.asp?mudi=start"& imgHref &"&backURL='+ escape(document.location.href)"" alt='采集' />&nbsp;&nbsp;"&_
			"<img src='images/img_content.gif' class='pointer' onclick=""document.location.href='?mudi=step3"& imgHref &"&isSourceCode=1&backURL='+ escape(document.location.href)"" alt='测试' />&nbsp;&nbsp;&nbsp;"&_
			"<img src='images/img_del.gif' class='pointer' onclick=""if(confirm('确定删除？')==true){DataDeal.location.href='collItem_deal.asp?mudi=del"& imgHref &"&theme="& server.URLEncode(showrec("CI_theme")) &"'}"" alt='删除' />"&_
		"</td>"&_
	"</tr>"&_
	"")
		showrec.movenext
		number=number+1
		Next
		response.write(_
		"</tbody>"&_
		"")
		response.write(_
		"<tr class='tabColorB padd5'>"&_
			"<td align='left' colspan='20'>"&_
				"<input type='button' value='全选' onclick='AllSelBox()' class='form_button1' />"&_
				"<input type='button' value='反选' onclick='RevSelBox()' class='form_button1' />"&_
				"&nbsp;"&_
				"<input type='button' value='批量删除' onclick=""CheckListForm2('del')"" />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<input type='button' value='批量采集' onclick=""CheckListForm2('run')"" />"&_
			"</td>"&_
		"</tr>"&_
		"")
	End If
	showrec.close
	Set showrec=Nothing
	response.write(_
	"</form>")

	Call ShareTableBottom2()

End Sub

%>