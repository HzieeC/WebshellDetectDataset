<%@LANGUAGE="VBSCRIPT" CODEPAGE="936"%>
<!--#include file="../conn/conn.asp"-->
<!--#include file="../inc/Commoncode.asp"-->
<!--#include file="../inc/CommonFunction.asp"-->
<%link="person_addresume.asp"%>
<!--#include file="checkpmember.asp" -->
<!--#include file="flagandexpend.asp" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>新建简历--<%=SiteTitle%></title>
<link href="../member/css.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Js/Calendar.js"></script>
<script language="JavaScript">
function GetProfession(professionid)
{
document.frames["professionframe"].location.replace("../inc/getprofession2.asp?professionid="+professionid);
}
function GetPosition(positionid)
{
document.frames["positionframe"].location.replace("../inc/getposition2.asp?positionid="+positionid);
}
<!--
//功能：去掉字符串前后空格
//返回值：去掉空格后的字符串
function fnRemoveBrank(strSource)
{
 return strSource.replace(/^\s*/,'').replace(/\s*$/,'');
}
function String.prototype.lenB()
{
return this.replace(/[^\x00-\xff]/g,"**").length;
}
function Juge(theForm)
{
  if (fnRemoveBrank(theForm.title.value) == "")
  {
    alert("请输入简历名称!");
    theForm.title.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.names.value) == "")
  {
    alert("请输入姓名!");
    theForm.names.focus();
    return (false);
  }
  today=new Date();
 // birthb=new Date(theForm.birth.value);
   var birtha=theForm.birth.value; 
   var birthb=birtha.split("-");
   
  if (fnRemoveBrank(theForm.birth.value) == "")
  {
    alert("请输入出日期!");
    theForm.birth.focus();
    return (false);
  }else
  if (today.getYear()-12<=birthb[0])
  {
   alert("出生日期"+birtha+"至今必须大于12年!");
    theForm.birth.focus();
    return (false);
	}
  if (fnRemoveBrank(theForm.idcard.value) == "")
  {
    alert("请输入证件编号!");
    theForm.idcard.focus();
    return (false);
  }
   if (fnRemoveBrank(theForm.province.value) == "")
  {
    alert("请选择所在省份!");
    theForm.province.focus();
    return (false);
  }
   if (fnRemoveBrank(theForm.edu.value) == "")
  {
    alert("请选择最高学历!");
    theForm.edu.focus();
    return (false);
  }
//   if (fnRemoveBrank(theForm.school.value) == "")
//  {
//    alert("请填写毕业学校!");
//    theForm.school.focus();
//    return (false);
//  }
  if (fnRemoveBrank(theForm.tel.value) == ""&&fnRemoveBrank(theForm.mobile.value) == "")
  {
    alert("联系电话或手机至少填写一项!");
    theForm.tel.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.tel.value) != "")
  {
	  var objv = fnRemoveBrank(theForm.tel.value);
	  var pattern = /^[0-9\s+.-]+$/;
	  flag = pattern.test(objv);
	  if(!flag)
	  {
		alert("联系电话：格式不正确!请重新输入。");
		theForm.tel.focus();
		return (false);
	   }
  }
  var objv = fnRemoveBrank(theForm.email.value);
  var pattern = /^([a-zA-Z0-9_-])+(\.([a-zA-Z0-9_-])+)*@([a-zA-Z0-9_-])+(\.([a-zA-Z0-9_-])+)+$/;
  flag = pattern.test(objv);
  if(!flag)
  {
    alert("电子邮件：格式不正确！请重新输入。");
	theForm.email.focus();
	return (false); 
  } 
  if (fnRemoveBrank(theForm.post.value) != "")
  {
	  var objv = fnRemoveBrank(theForm.post.value);
	  var pattern = /^[0-9]+$/;
	  flag = pattern.test(objv);
	  if(!flag)
	  {
		alert("邮政编码：要求为数字!请重新输入。");
		theForm.post.focus();
		return (false);
	   }
   }
  if (fnRemoveBrank(theForm.url.value) != "")
  {
	  if(theForm.url.value.indexOf("http://")==-1)
	  {
		alert("个人主页：必须包括“http://”，请完整填写。");
		theForm.url.focus();
		return (false);
	   }
   }
//  if (fnRemoveBrank(theForm.sumup.value) == "")
//  {
//    alert("请输入特点概括!");
//    theForm.sumup.focus();
//    return (false);
//  } 
//  if (fnRemoveBrank(theForm.appraise.value) == "")
//  {
//    alert("请输入自我评价!");
//    theForm.appraise.focus();
//    return (false);
//  }
//  if ((theForm.appraise.value).lenB()>=8000)
//  {
//	 alert("自我评价太长了，要求不多于2000个字符!");
//	 theForm.appraise.focus();
//	 return (false);
//  } 
}
function Juges(theForm)
{
  if (fnRemoveBrank(theForm.start_year.value) == "0")
  {
    alert("请选择时间!");
    theForm.start_year.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.start_month.value) == "0")
  {
    alert("请选择时间!");
    theForm.start_month.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.school.value) == "")
  {
    alert("请输入学校名称!");
    theForm.school.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.mainprofession.value) == "")
  {
    alert("请选择专业!");
    theForm.mainprofession.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.subprofession.value) == "")
  {
    alert("请选择专业!");
    theForm.subprofession.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.edu.value) == "")
  {
    alert("请选择学历!");
    theForm.edu.focus();
    return (false);
  }
 }
 
 function Juget(theForm)
{
  if (fnRemoveBrank(theForm.start_year.value) == "0")
  {
    alert("请选择培训时间!");
    theForm.start_year.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.start_month.value) == "0")
  {
    alert("请选择培训时间!");
    theForm.start_month.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.train.value) == "")
  {
    alert("请输入培训机构!");
    theForm.train.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.course.value) == "")
  {
    alert("请输入培训课程!");
    theForm.course.focus();
    return (false);
  }
 }
 function Jugel(theForm)
{
  if (fnRemoveBrank(theForm.language.value) == "0")
  {
    alert("请选择外语语种!");
    theForm.language.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.master.value) == "0")
  {
    alert("请选择掌握程度!");
    theForm.master.focus();
    return (false);
  }
 }
 
 function Jugew(theForm)
{
  if (fnRemoveBrank(theForm.start_year.value) == "0")
  {
    alert("请选择时间!");
    theForm.start_year.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.start_month.value) == "0")
  {
    alert("请选择时间!");
    theForm.start_month.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.comname.value) == "")
  {
    alert("请输入公司名称!");
    theForm.comname.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.ecoclass.value) == "")
  {
    alert("请选择公司性质!");
    theForm.ecoclass.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.trade.value) == "")
  {
    alert("请选择所属行业!");
    theForm.trade.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.mainposition.value) == "")
  {
    alert("请选择岗位!");
    theForm.mainposition.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.subposition.value) == "")
  {
    alert("请选择岗位!");
    theForm.subposition.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.dept.value) == "")
  {
    alert("请输入所在部门!");
    theForm.dept.focus();
    return (false);
  }
  if (fnRemoveBrank(theForm.place.value) == "")
  {
    alert("请输入职位名称!");
    theForm.place.focus();
    return (false);
  }
 }
 
function jumpwindow(i){   
  document.all.bodyly.style.display="block";   
  document.all.bodyly.style.width=document.body.clientWidth;   
  document.all.bodyly.style.height=document.body.clientHeight; 
  document.getElementById("jumply"+i).style.display='block'; 
  document.getElementById("jumply"+i).style.top=document.documentElement.scrollTop+40;   
  document.getElementById("jumply"+i).style.left=document.body.clientWidth/2-250;  
  }   
function unwindow(i){
  document.getElementById("jumply"+i).style.display='none';
  document.all.bodyly.style.display='none';
  } 
-->
</script>
</head>
<body>
<iframe height=0 width=0 src="" id="professionframe"></iframe>
<iframe height=0 width=0 src="" id="positionframe"></iframe>
<div id="bodyly" style="position:absolute;top:0px;FILTER: alpha(opacity=80);background-color:#333; z-index:0;left:0px;display:none;"></div>
<div class="memmenul">
<div class="leftmenutit"><span>新建简历:<%=session(""&FRHRCMS&"resume_title")%></span></div>
<%
rid=trim(request("rid"))
Action=trim(Request("Action"))
Select Case Action
	Case "Addnew"
		Call Addone()
	Case "Addtwo"
		Call addtwo()
	Case "Addthree"
		Call addthree()
	Case "SaveAddone"
		Call SaveAddone()
	Case "Saveedu"
		Call Saveedu()
	Case "Savetrain"
		Call Savetrain()
	Case "Savelang"
		Call Savelang()
	Case "Savework"
		Call Savework()
	Case "Deledu"
		Call Deledu()
	Case "Deltrain"
		Call Deltrain()
	Case "Dellang"
		Call Dellang()
	Case "Delwork"
		Call Delwork()
	Case Else
		Call addone()
End Select

if FoundErr=True then
	call Show_Err()
end if
%>
<%Sub addone()
if (Action="Addnew" or Action="") and rid="" then
session(""&FRHRCMS&"resume_title")=""
set rst=server.createobject("ADODB.Recordset")
sql="select * from job_member where member_login='"&pmember_login&"'"
rst.open sql,conn,1,1
if not rst.eof then
resume_title="简历"&FormatDate(now(),7)
resume_name=rst("member_name")
resume_sex=rst("Member_sex")
resume_birth=rst("Member_birth")
resume_cardtype=rst("Member_cardtype")
resume_idcard=rst("Member_idcard")
resume_marriage=rst("Member_marriage")
resume_polity=rst("Member_polity")
resume_hukouprovinceid=rst("Member_hukouprovinceid")
resume_hukoucapitalid=rst("Member_hukoucapitalid")
resume_hukoucityid=rst("Member_hukoucityid")
resume_provinceid=rst("Member_provinceid")
resume_capitalid=rst("Member_capitalid")
resume_cityid=rst("Member_cityid")
resume_edu=rst("Member_edu")
resume_tel=rst("Member_tel")
resume_mobile=rst("Member_mobile")
resume_chat=rst("Member_chat")
resume_email=rst("Member_email")
resume_url=rst("Member_url")
resume_address=rst("Member_address")
resume_post=rst("Member_post")
else
response.write "<script language=javascript>alert('出错！');javascript:history.back();</script>"
response.end 
end if
rst.close
set rst=nothing
end if
if Action<>"Addnew" and rid<>"" then
session(""&FRHRCMS&"resume_title")=""
set rst=server.createobject("ADODB.Recordset")
sql="select * from job_p_resume where resume_pmember='"&pmember_login&"' and resume_id="&rid&""
rst.open sql,conn,1,1
if not rst.eof then
resume_title=rst("resume_title")
resume_usergroup=rst("resume_usergroup")
resume_name=rst("resume_name")
resume_sex=rst("resume_sex")
resume_birth=rst("resume_birth")
resume_cardtype=rst("resume_cardtype")
resume_idcard=rst("resume_idcard")
resume_marriage=rst("resume_marriage")
resume_nation=rst("resume_nation")
resume_height=rst("resume_height")
resume_weight=rst("resume_weight")
resume_polity=rst("resume_polity")
resume_hukouprovinceid=rst("resume_hukouprovinceid")
resume_hukoucapitalid=rst("resume_hukoucapitalid")
resume_hukoucityid=rst("resume_hukoucityid")
resume_provinceid=rst("resume_provinceid")
resume_capitalid=rst("resume_capitalid")
resume_cityid=rst("resume_cityid")
resume_edu=rst("resume_edu")
if rst("resume_tel")<>"" then
	if instr(rst("resume_tel"),",")>0 then
		resume_tel=split(rst("resume_tel"),",")(0)
		resume_mobile=split(rst("resume_tel"),",")(1)
	else
		resume_tel=rst("resume_tel")
	end if
end if
resume_chat=rst("resume_chat")
resume_email=rst("resume_email")
resume_url=rst("resume_url")
resume_address=rst("resume_address")
resume_post=rst("resume_post")
resume_zhicheng=rst("resume_zhicheng")
resume_school=rst("resume_school")
resume_graduate=rst("resume_graduate")
resume_sumup=rst("resume_sumup")
resume_appraise=rst("resume_appraise")
session(""&FRHRCMS&"resume_title")=resume_title
if isnull(rst("resume_name")) then	'如果个人简历没有填写基本资料，读取基本信息
	set rsm=server.createobject("ADODB.Recordset")
	sqlm="select * from job_member where member_login='"&pmember_login&"'"
	rsm.open sqlm,conn,1,1
	if not rsm.eof then
	resume_name=rsm("member_name")
	resume_sex=rsm("Member_sex")
	resume_birth=rsm("Member_birth")
	resume_cardtype=rsm("Member_cardtype")
	resume_idcard=rsm("Member_idcard")
	resume_marriage=rsm("Member_marriage")
	resume_polity=rsm("Member_polity")
	resume_hukouprovinceid=rsm("Member_hukouprovinceid")
	resume_hukoucapitalid=rsm("Member_hukoucapitalid")
	resume_hukoucityid=rsm("Member_hukoucityid")
	resume_provinceid=rsm("Member_provinceid")
	resume_capitalid=rsm("Member_capitalid")
	resume_cityid=rsm("Member_cityid")
	resume_edu=rsm("Member_edu")
	resume_tel=rsm("Member_tel")
	resume_mobile=rsm("Member_mobile")
	resume_chat=rsm("Member_chat")
	resume_url=rsm("Member_url")
	resume_address=rsm("Member_address")
	resume_post=rsm("Member_post")
	end if
	rsm.close
	set rsm=nothing
end if
else
response.write "<script language=javascript>alert('出错！');javascript:history.back();</script>"
response.end 
end if
rst.close
set rst=nothing
end if%>
<table width="98%" border="0" align="center" cellpadding="2" cellspacing="1" style="font-size:12px; line-height:20px;">
<form name="infomodi" action="person_addresume.asp?action=SaveAddone&rid=<%=rid%>" method="post" onSubmit="return Juge(this)">
    <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle">新增简历名称（注：带<font color="#ff6600">＊</font>号为必填项）</td>
  </tr>
    <tr>
      <td width="92" height="25" align="right" bgcolor="#F1F8FC">简历名称：</td>
      <td width="637" bgcolor="#F1F8FC" colspan="4"><input name="title" id="title" value="<%=resume_title%>" maxlength="25" />
        <span class="note">给简历命名，以区分多份不同的简历&nbsp;</span></td>
    </tr>
    <tr>
      <td align="right" bgcolor="#F1F8FC">选择人才类别：</td>
      <td bgcolor="#F1F8FC" colspan="4"><INPUT id=radUserGroup type=radio checked value=0 name=usergroup>
      普通 <INPUT id=radUserGroup type=radio <%if resume_usergroup=1 then response.write "checked" end if%> value=1 name=usergroup>
      毕业生 
      <INPUT id=radUserGroup type=radio <%if resume_usergroup=2 then response.write "checked" end if%> value=2 name=usergroup>高级人才</td>
    </tr>
    <tr>
      <td align="right" bgcolor="#F1F8FC">&nbsp;</td>
      <td bgcolor="#F1F8FC" colspan="4">高级人才需满足以下条件：<br />
        1.博士以上学位；<br />
        2.硕士学历，二年以上工作经验；<br />
        3.本科学历，五年以上工作经验；<br />
        4.大专学历，五年以上中层管理经验；<br />
        5.海外留学归国人员。</td>
    </tr>
  <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle">　个人信息</td>
    </tr>
  <tr>
    <td width="92" height="25" align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>姓名：</td>
    <td width="179" bgcolor="#F1F8FC"><input name="names" id="names" maxlength="25" value="<%=resume_name%>" /></td>
    <td width="81" align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>性别：</td>
    <td width="249" bgcolor="#F1F8FC"><input type="radio" value="1" name="sex" checked />
男
  <input type="radio" value="2" name="sex" <%if resume_sex=2 then response.write "checked" end if%> />
女 </td>
    <td width="113" rowspan="5" align="center" bgcolor="#F1F8FC"><%
Set rs= Server.CreateObject("ADODB.RecordSet")
sql="select * from job_member where member_login='"&pmember_login&"' and member_typeid=1"
rs.open sql,conn,1,1
if rs("member_logo")<>"" then
%><img height=140 src="../UpFiles/Person/<%=rs("member_logo")%>" width=110 border=0 style="BORDER-RIGHT: #666666 1px solid; BORDER-TOP: #666666 1px solid; BORDER-LEFT: #666666 1px solid; BORDER-BOTTOM: #666666 1px solid">
<%else%><img height=140 src="../UpFiles/Person/nophoto.gif" width=110 border=0 style="BORDER-RIGHT: #666666 1px solid; BORDER-TOP: #666666 1px solid; BORDER-LEFT: #666666 1px solid; BORDER-BOTTOM: #666666 1px solid"><%
end if
rs.close
set rs=nothing
%></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>出生日期：</td>
    <td bgcolor="#F1F8FC"><input type="text" name="birth" value="<%=resume_birth%>" id="birth" size="10" maxlength="10" onClick="showcalendar(event, this)" readonly /></td>
    <td align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>证件类型：</td>
    <td bgcolor="#F1F8FC"><select name="cardtype" size="1" id="cardtype">
      <option value="0" <%if resume_cardtype=0 then response.write "select" end if%>>身份证</option>
      <option value="1" <%if resume_cardtype=1 then response.write "select" end if%>>驾证</option>
      <option value="2" <%if resume_cardtype=2 then response.write "select" end if%>>军官证</option>
      <option value="3" <%if resume_cardtype=3 then response.write "select" end if%>>护照</option>
      <option value="4" <%if resume_cardtype=4 then response.write "select" end if%>>其它</option>
    </select>
      <input name="idcard" id="idcard" maxlength="20" value="<%=resume_idcard%>" /></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">民族：</td>
    <td bgcolor="#F1F8FC"><select name="nation" id="nation">
      <option value=""></option>
<%
set rs=server.createobject("ADODB.Recordset")
sql="select * from job_nation"
rs.open sql,conn,1,1
do while not rs.eof
if resume_nation=rs("nation_id") then
response.write"<OPTION value="&rs("nation_id")&" selected>"&rs("nation_name")&"</option>"
else
response.write"<OPTION value="&rs("nation_id")&">"&rs("nation_name")&"</option>"
end if
rs.movenext
loop
rs.close
%>
    </select></td>
    <td align="right" bgcolor="#F1F8FC">婚姻状况：</td>
    <td bgcolor="#F1F8FC"><select name="marriage" id="marriage">
      <option value=""></option>
<%
sql="select * from job_marriage"
rs.open sql,conn,1,1
do while not rs.eof
if resume_marriage=rs("marriage_id") then
response.write"<OPTION value="&rs("marriage_id")&" selected>"&rs("marriage_name")&"</option>"
else
response.write"<OPTION value="&rs("marriage_id")&">"&rs("marriage_name")&"</option>"
end if
rs.movenext
loop
rs.close
%>
    </select></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">政治面貌：</td>
    <td bgcolor="#F1F8FC"><select name="polity" id="polity">
      <option value=""></option>
<%
sql="select * from job_polity"
rs.open sql,conn,1,1
do while not rs.eof
if resume_polity=rs("polity_id") then
response.write"<OPTION value="&rs("polity_id")&" selected>"&rs("polity_name")&"</option>"
else
response.write"<OPTION value="&rs("polity_id")&">"&rs("polity_name")&"</option>"
end if
rs.movenext
loop
rs.close
%>
    </select></td>
    <td align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>最高学历：</td>
    <td bgcolor="#F1F8FC"><select name="edu">
      <option value="" selected="selected"></option>
<%
sql="select edu_id,edu_name from job_edu order by edu_id desc"
rs.open sql,conn,1,1
do while not rs.eof
if resume_edu=rs("edu_id") then
response.write"<OPTION value="&rs("edu_id")&" selected>"&rs("edu_name")&"</option>"
else
response.write"<OPTION value="&rs("edu_id")&">"&rs("edu_name")&"</option>"
end if
rs.movenext
loop
rs.close
%>
    </select></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">身高：</td>
    <td bgcolor="#F1F8FC"><input name="height" id="height" size="3" maxlength="3" value="<%if resume_height<>0 then response.write resume_height end if%>" />
厘米</td>
    <td align="right" bgcolor="#F1F8FC">体重：</td>
    <td bgcolor="#F1F8FC"><input name="weight" type="text" id="weight" size="3" maxlength="3" value="<%if resume_weight<>0 then response.write resume_weight end if%>" />
公斤</td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">职称：</td>
    <td bgcolor="#F1F8FC"><input name="zhicheng" id="zhicheng" maxlength="25" value="<%=resume_zhicheng%>" /></td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td align="center" bgcolor="#F1F8FC"><a href="person_photo.asp" target="main">点击进入照片管理</a></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">户口所在地：</td>
    <td colspan="4" bgcolor="#F1F8FC"><select name="hukouprovince" size="1" id="select5" onChange="changeProvince(document.infomodi.hukouprovince.options[document.infomodi.hukouprovince.selectedIndex].value)">
		<%if resume_hukouprovinceid<>"" then%>
		<option value="<%=resume_hukouprovinceid%>"><%=Hireworkadds(resume_hukouprovinceid)%></option>
		<%else%>
		<option value="">选择省</option>
		<%end if%>
		</select>		
		<select name="hukoucapital" onchange="changeCity(document.infomodi.hukoucapital.options[document.infomodi.hukoucapital.selectedIndex].value)">
		<%if resume_hukoucapitalid<>"" then%>
		<option value="<%=resume_hukoucapitalid%>"><%=Hireworkadds(resume_hukoucapitalid)%></option>
		<%else%>
		<option value="">选择市</option>
		<%end if%>
		</select>
		<select name="hukoucity">
		<%if resume_hukoucityid<>"" then%>
		<option value="<%=resume_hukoucityid%>"><%=Hireworkadds(resume_hukoucityid)%></option>
		<%else%>
		<option value="">选择区</option>
		<%end if%>
		</select></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>目前所在地：</td>
    <td colspan="4" bgcolor="#F1F8FC"><select name="province" size="1" id="select5" onChange="changeProvinces(document.infomodi.province.options[document.infomodi.province.selectedIndex].value)">
		<%if resume_provinceid<>"" then%>
		<option value="<%=resume_provinceid%>"><%=Hireworkadds(resume_provinceid)%></option>
		<%else%>
		<option value="">选择省</option>
		<%end if%>
		</select>		
		<select name="capital" onchange="changeCitys(document.infomodi.capital.options[document.infomodi.capital.selectedIndex].value)">
		<%if resume_capitalid<>"" then%>
		<option value="<%=resume_capitalid%>"><%=Hireworkadds(resume_capitalid)%></option>
		<%else%>
		<option value="">选择市</option>
		<%end if%>
		</select>
		<select name="city">
		<%if resume_cityid<>"" then%>
		<option value="<%=resume_cityid%>"><%=Hireworkadds(resume_cityid)%></option>
		<%else%>
		<option value="">选择区</option>
		<%end if%>
		</select></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">毕业学校：</td>
    <td bgcolor="#F1F8FC"><input name="school" id="school" value="<%=resume_school%>" maxlength="100" /></td>
    <td align="right" bgcolor="#F1F8FC">毕业时间：</td>
    <td bgcolor="#F1F8FC"><input type="text" name="graduate" value="<%=resume_graduate%>" id="graduate" size="10" maxlength="10" onClick="showcalendar(event, this)" readonly /></td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
  <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle"> 　联系方式</td>
  </tr>
  <tr>
    <td width="92" height="25" align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>联系电话：</td>
    <td width="637" bgcolor="#F1F8FC" colspan="4"><input name="tel" id="tel" value="<%=resume_tel%>" size="40" maxlength="100" />
      联系电话或手机至少填一项</td>
  </tr>
  <tr>
    <td height="25" align="right" bgcolor="#F1F8FC" >手机：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="mobile" id="mobile" maxlength="20" value="<%=resume_mobile%>" />
      联系电话或手机至少填一项</td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">聊天号码：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="chat" id="chat" maxlength="100" value="<%=resume_chat%>" />
      <font color="#50463d">(QQ:123456;ICQ:345678;MSN:user@yjys.net)</font></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC"><font color="#ff7800">*</font>电子邮件：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="email" id="email" size="40" maxlength="100" value="<%=resume_email%>" /></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">个人主页：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="url" id="url2" size="40" maxlength="100" value="<%=resume_url%>" /></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">通信地址：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="address" size="40" maxlength="50" value="<%=resume_address%>" /></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">邮政编码：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="post" id="post2" size="6" maxlength="6" value="<%=resume_post%>" /></td>
  </tr>
  <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle"> 　我的简介</td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">特点概括：</td>
    <td bgcolor="#F1F8FC" colspan="4"><input name="sumup" id="sumup" size="30" maxlength="20" value="<%=resume_sumup%>" /></td>
  </tr>
  <tr>
    <td colspan="5" bgcolor="#F1F8FC"><font color="#993300">用最精练的几个字高度概括您最突出的求职优势。字数在10个字内。如：5年软件开发经验。</font></td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">自我评价：</td>
    <td bgcolor="#F1F8FC" colspan="4"><font color="#993300">以下限2000个字符，用简洁的词语描述自己的综合能力。</font></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC" colspan="4"><textarea class="FieldText" id="appraise" style="FONT-SIZE: 12px" name="appraise" rows="10" cols="80"><%=ChangeStrbox(resume_appraise)%></textarea></td>
  </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC" colspan="4"><label>
      <input type="submit" name="Submit" value="下一步" />
      <input type="button" name="Submit2" value="返回" onclick="javascript:history.back()" />
    </label></td>
  </tr></form>
</table>
<script language = "JavaScript" src="../js/GetProvince.js"></script>
<script language = "JavaScript">
function changeProvince(selvalue)
{
document.infomodi.hukoucapital.length=0; 
document.infomodi.hukoucity.length=0;
var selvalue=selvalue;	  
var j,d,mm;
d=0;
for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==selvalue) 
		{
			if (d==0)
			{
			mm=provincearray[j][2];
			}
		var newOption2=new Option(provincearray[j][0],provincearray[j][2]);
		document.all.hukoucapital.add(newOption2);
		d=d+1;	
		}		
		if(provincearray[j][1]==mm) 
		{		
			var newOption3=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.hukoucity.add(newOption3);
		}			
	}
}
function changeCity(selvalue)  
{ 
	document.infomodi.hukoucity.length=0;  
	var selvalue=selvalue;
	var j;
	for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==selvalue) 
		{
			var newOption4=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.hukoucity.add(newOption4);
		}
	}
}
function selectprovince() 
{ 
	var j;
	for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==0) 
		{
			var newOption4=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.hukouprovince.add(newOption4);
		}
	}
}


function changeProvinces(selvalue)
{
document.infomodi.city.length=0; 
document.infomodi.capital.length=0;
var selvalue=selvalue;	  
var j,d,mm;
d=0;
for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==selvalue) 
		{
			if (d==0)
			{
			mm=provincearray[j][2];
			}
		var newOption2=new Option(provincearray[j][0],provincearray[j][2]);
		document.all.capital.add(newOption2);
		d=d+1;	
		}		
		if(provincearray[j][1]==mm) 
		{		
			var newOption3=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.city.add(newOption3);
		}			
	}
}
function changeCitys(selvalue)  
{ 
	document.infomodi.city.length=0;  
	var selvalue=selvalue;
	var j;
	for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==selvalue) 
		{
			var newOption4=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.city.add(newOption4);
		}
	}
}

function selectprovinces() 
{ 
var j;
	for(j=0;j<provincearray.length;j++) 
	{
		if(provincearray[j][1]==0) 
		{
			var newOption4=new Option(provincearray[j][0],provincearray[j][2]);
			document.all.province.add(newOption4);
		}
	}
}
selectprovince();
selectprovinces();
</script>
<%End Sub
Sub addtwo()
Set rs= Server.CreateObject("ADODB.RecordSet")
sql="select resume_education,resume_train,resume_lang from job_p_resume where resume_pmember='"&pmember_login&"' and resume_id="&rid
rs.open sql,conn,1,1
if not rs.eof then
education=rs(0)
train=rs(1)
lang=rs(2)
end if
rs.close
set rs=nothing
%>
<table width="98%" border="0" align="center" cellpadding="2" cellspacing="1" style="font-size:12px; line-height:20px;">
<form name="formaddtwo" action="person_addresume.asp?Action=Addthree&rid=<%=rid%>" method="post">
  <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle"> 　教育/培训/语言能力（注：带<font color="#ff6600">＊</font>号为必填项）</td>
  </tr>
  <tr>
    <td colspan="5" bgcolor="#F1F8FC">　　<b>请在“教育”栏目中填写您受过的正规教育；在“培训”栏目中填写接受过的各种培训，包括非正规教育，公司培训等等。按&quot;添加&quot;增加新的教育/培训经历。要修改或删除某项教育/培训经历，按此纪录后的&quot;编辑&quot;或&quot;删除&quot;。</b></td>
    </tr>
  
  <tr>
    <td width="92" height="25" align="right" bgcolor="#F1F8FC"><b>教育</b></td>
    <td width="239" bgcolor="#F1F8FC">时间</td>
    <td width="191" bgcolor="#F1F8FC">学校</td>
    <td width="127" bgcolor="#F1F8FC">学历</td>
    <td width="65" bgcolor="#F1F8FC">操作</td>
  </tr>
<%
set rst=server.createobject("ADODB.Recordset")
sql="select * from job_p_education where education_resumeid="&rid&" order by education_announcedate desc"
rst.open sql,conn,1,1
if not rst.eof then
 for i=1 to rst.recordcount
%>
<tr>
<td align="right" bgcolor="#F1F8FC">教育<%=capitalization(small(i))%>：</td>
<td bgcolor="#F1F8FC"><%=rst("education_startyear")%>年<%=rst("education_startmonth")%>月――
<%if rst("education_endyear")=0 and rst("education_endmonth")=0 then%>至今<%else%><%=rst("education_endyear")%>年<%=rst("education_endmonth")%>月<%end if%></td>
<td bgcolor="#F1F8FC"><%=rst("education_school")%></td>
<td bgcolor="#F1F8FC"><%=Hireedu(rst("education_edu"))%></td>
<td bgcolor="#F1F8FC"><a href="#" onClick="window.open ('person_modiresume.asp?Action=Modiedu&id=<%=rst("education_id")%>&rid=<%=rid%>','newwindow','height=360,width=580,top=200,left=200,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no') ">编辑</a> <a href="person_addresume.asp?Action=Deledu&id=<%=rst("education_id")%>&rid=<%=rid%>" class='04d'>删除</a></td>
</tr>
<%
rst.movenext
next
end if
%>
<tr>
<td align="right" bgcolor="#F1F8FC">教育<%=capitalization(small(rst.recordcount+1))%>：</td>
<td bgcolor="#F1F8FC"><a onclick="jumpwindow(1);" style="cursor:hand"><font color="#FF0000"><b>添加</b></font></a> <input type="checkbox" name="education" id="education" value="1" <%if education=1 then Response.Write("checked")%> />
      如果无教育经历，请选中此项！</td>
<td bgcolor="#F1F8FC">&nbsp;</td>
<td bgcolor="#F1F8FC">&nbsp;</td>
<td bgcolor="#F1F8FC">&nbsp;</td>
</tr>
<%
rst.close
%>

  <tr>
    <td colspan="5" bgcolor="#F1F8FC">&nbsp;</td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC"><b>培训</b></td>
    <td bgcolor="#F1F8FC">培训时间</td>
    <td bgcolor="#F1F8FC">培训机构</td>
    <td bgcolor="#F1F8FC">培训课程</td>
    <td bgcolor="#F1F8FC">操作</td>
  </tr>
<%
sql="select * from job_p_training where train_resumeid="&rid&" order by train_announcedate desc"
rst.open sql,conn,1,1
if not rst.eof then
for i=1 to rst.recordcount
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">培训<%=capitalization(small(i))%>：</td>
    <td bgcolor="#F1F8FC"><%=rst("train_startyear")%>年<%=rst("train_startmonth")%>月――<%if rst("train_endyear")=0 and rst("train_endmonth")=0 then%>至今<%else%><%=rst("train_endyear")%>年<%=rst("train_endmonth")%>月<%end if%></td>
    <td bgcolor="#F1F8FC"><%=rst("train_train")%></td>
    <td bgcolor="#F1F8FC"><%=rst("train_course")%></td>
    <td bgcolor="#F1F8FC"><a href="#" onClick="window.open ('person_modiresume.asp?Action=Moditrain&id=<%=rst("train_id")%>&rid=<%=rid%>','newwindow','height=260,width=580,top=200,left=200,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no') ">编辑</a> <a href="person_addresume.asp?Action=Deltrain&lang=<%=lang%>&rid=<%=rid%>&id=<%=rst("train_id")%>">删除</a></td>
  </tr>
<%rst.movenext
next
end if
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">培训<%=capitalization(small(rst.recordcount+1))%>：</td>
    <td bgcolor="#F1F8FC"><a onclick="jumpwindow(2);" style="cursor:hand"><font color="#FF0000"><b>添加</b></font></a> <input type="checkbox" name="train" id="train" value="1" <%if train=1 then Response.Write("checked")%> />
      如果无培训经历，请选中此项！</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
<%rst.close%>
  <tr>
    <td colspan="5" bgcolor="#F1F8FC">&nbsp;</td>
    </tr>
  <tr>
    <td align="right" bgcolor="#F1F8FC"><b>语言能力</b></td>
    <td bgcolor="#F1F8FC">外语语种</td>
    <td bgcolor="#F1F8FC">掌握程度</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">操作</td>
  </tr>
<%
sql="select lang_id, foreign_name, degree_name from job_p_lang,job_foreignlanguage,job_foreigndegree where job_p_lang.lang_name = job_foreignlanguage.foreign_id and job_p_lang.lang_master = job_foreigndegree.degree_id and lang_resumeid="&rid&" order by lang_announcedate desc"
rst.open sql,conn,1,1
if not rst.eof then
for i=1 to rst.recordcount
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">语言<%=capitalization(small(i))%>：</td>
    <td bgcolor="#F1F8FC"><%=rst("foreign_name")%></td>
    <td bgcolor="#F1F8FC"><%=rst("degree_name")%></td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC"><a href="#" onClick="window.open ('person_modiresume.asp?Action=Modilang&id=<%=rst("lang_id")%>&rid=<%=rid%>','newwindow','height=260,width=580,top=200,left=200,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no') ">编辑</a> <a href="person_addresume.asp?Action=Dellang&id=<%=rst("lang_id")%>&rid=<%=rid%>">删除</a></td>
  </tr>
<%rst.movenext
next
end if
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">语言<%=capitalization(small(rst.recordcount+1))%>：</td>
    <td bgcolor="#F1F8FC"><a onclick="jumpwindow(3);" style="cursor:hand"><font color="#FF0000"><b>添加</b></font></a> <input type="checkbox" name="lang" id="lang" value="1" <%if lang=1 then Response.Write("checked")%> />
      如果无外语能力，请选中此项！</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
<%rst.close%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC"><label>
      <input type="submit" name="Submit3" value="下一步" />
      <input type="button" name="Submit22" value="返回" onclick="javascript:history.back()" />
    </label></td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
  </form>
</table>
<!--添加修改教育-->
<div id="jumply1" style="position:absolute;background-color:#fff; z-index:9999;display:none; width:500px;">
<form name="eduadds" action="person_addresume.asp?Action=Saveedu&lang=<%=lang%>&rid=<%=rid%>" method="post" onsubmit="return Juges(this);">
<div class="memmenul">
<div class="leftmenutit"><span>编辑<font color="#FF6600" ><b><%=session(""&FRHRCMS&"resume_title")%></b></font>的教育内容（注：带＊号为必填项）&nbsp;<a style="cursor:pointer; color:#FFFFFF" onclick="unwindow(1)">关闭</a></span></div>
<li><font color="#ff6600">　＊</font>时间：  从
<select name="start_year" id="start_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
response.write "<option value="&i&">"&i&"</option>"
next
%>
</select>
<select name="start_month" id="start_month">
<option value="0" selected="selected">月</option>
<%
for i=1 to 12
response.write "<option value="&i&">"&i&"</option>"
next
%>
</select>
到
<select name="end_year" id="end_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
response.write "<option value="&i&">"&i&"</option>"
next
%>
</select>
<select name="end_month" id="end_month">
<option value="0" selected="selected">月</option>
<%for i=1 to 12
response.write "<option value="&i&">"&i&"</option>"
next
%>
</select>
(后两项不填表示至今)</li>
<li><font color="#ff6600">　＊</font>学校：
<INPUT name=school id="school" size=50 maxLength=50></li>
<li><font color="#ff6600">　＊</font>专业：
<select name="mainprofession" size="1" id="mainprofession" onChange=GetProfession(this.options[this.selectedIndex].value)>
<option value="" selected>---请选择---</option>
<%
Set rs= Server.CreateObject("ADODB.RecordSet")
sql="select profession_id,profession_name from job_profession where profession_fid=0 order by profession_id"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("profession_id")&">"&rs("profession_name")&"</option>"
rs.movenext
loop
rs.close
%>
</select>
<span id="load400"></span><span id="cprofession">
<select name=subprofession id="subprofession">
<option value="" selected>---请选择---</option>
</select>
</span></li>
<li><font color="#ff6600">　＊</font>学历：
<select name="edu">
<option value="" selected="selected">---请选择---</option>
<%sql="select edu_id,edu_name from job_edu order by edu_id desc"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("edu_id")&">"&rs("edu_name")&"</option>"
rs.movenext
loop
rs.close
%>
</select>
</li>
<li>专业描述：
<textarea name="detail" cols="50" id="detail" style="HEIGHT: 150px"></textarea>
</li>
<li><FONT color=#993300>专业描述您可以填写您所学专业包括什么课程，您的毕业设计等等。 </FONT></li>
<li><INPUT name="submit" type="submit" value="保　存">
<INPUT name=Exit type=button class="inputa3" onClick="unwindow(1)" value="关　闭"></li>
</form>
</div>
</div>
<!--教育结束
培训开始-->
<div id="jumply2" style="position:absolute;background-color:#fff; z-index:9999;display:none; width:500px;">
<form name="trainadd" action="person_addresume.asp?Action=Savetrain&rid=<%=rid%>" method="post" onSubmit="return Juget(this)">
<div class="memmenul">
<div class="leftmenutit"><span>编辑<font color="#FF6600" ><b><%=session(""&FRHRCMS&"resume_title")%></b></font>的培训内容（注：带＊号为必填项）&nbsp;<a style="cursor:pointer; color:#FFFFFF" onclick="unwindow(2)">关闭</a></span></div>
<li><font color="#ff6600">＊</font>培训时间：从
<select name="start_year" id="start_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
 response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
<select name="start_month" id="start_month">
<option value="0" selected="selected">月</option>
<%
for i=1 to 12
 response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
到
<select name="end_year" id="end_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
<select name="end_month" id="end_month">
<option value="0" selected="selected">月</option>
<%
for i=1 to 12
response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
 (后两项不填表示至今)</li>
<li><font color="#ff6600">＊</font>培训机构：
  <input name="train" id="train" size="50" maxlength="50" />
</li>
<li> 　培训地点：
  <input name="address" id="address" size="50" maxlength="50" />
</li>
<li><font color="#ff6600">＊</font>培训课程：
  <input name="course" id="course" size="50" maxlength="50" />
</li>
<li>　获得证书：
  <font color="#993300">
  <input name="certificate" id="certificate" size="50" maxlength="50" />
  </font></li>
<li> 　详细描述：
  <textarea name="detail" cols="50" rows="8" id="detail" style="HEIGHT: 150px"></textarea>
</li>
<li><INPUT name="submit" type="submit" value="保　存">
<INPUT name=Exit type=button class="inputa3" onClick="unwindow(2)" value="关　闭"></li>
</form>
</div>
</div>
<!--培训结束
语言能力开始--->
<div id="jumply3" style="position:absolute;background-color:#fff; z-index:9999;display:none; width:500px;">
<form name="langadd" action="person_addresume.asp?Action=Savelang&rid=<%=rid%>" method="post" onSubmit="return Jugel(this)">
<div class="memmenul">
<div class="leftmenutit"><span>编辑<font color="#FF6600" ><b><%=session(""&FRHRCMS&"resume_title")%></b></font>的语言能力（注：带＊号为必填项）&nbsp;<a style="cursor:pointer; color:#FFFFFF" onclick="unwindow(3)">关闭</a></span></div>
<li><font color="#ff6600">＊</font>外语语种：<select name="language" id="language">
<option value=0 selected>---请选择---</option>
<%Set rs= Server.CreateObject("ADODB.RecordSet")
sql="select foreign_id,foreign_name from job_foreignlanguage"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("foreign_id")&">"&rs("foreign_name")&"</option>"
rs.movenext
loop
rs.close
%></select><font color="#ff6600">＊</font>掌握程度：
<select name="master" id="select5">
<option value=0 selected>---请选择---</option>
<%
sql="select degree_id,degree_name from job_foreigndegree"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("degree_id")&">"&rs("degree_name")&"</option>"
rs.movenext
loop
rs.close
%>
</select>
</li>
<li><INPUT name="submit" type="submit" value="保　存">
<INPUT name=Exit type=button class="inputa3" onClick="unwindow(3)" value="关　闭"></li>
</form>
</div>
</div>
<!--语言结束-->
<%End Sub%>
<%Sub addthree()
sqladdthree=""
set rs=server.CreateObject("adodb.recordset")
if trim(Request("education"))="1" then
sqladdthree=sqladdthree&"resume_education=1,"
else
	sql="select * from job_p_education where education_resumeid="&rid
	rs.open sql,conn,1,1
	educationnum=rs.RecordCount
	rs.close
	if educationnum=0 then
		sqladdthree=sqladdthree&"resume_education=0,"
	end if
end if
if trim(Request("train"))="1" then
sqladdthree=sqladdthree&"resume_train=1,"
else
	sql="select * from job_p_training where train_resumeid="&rid
	rs.open sql,conn,1,1
	trainnum=rs.RecordCount
	rs.close
    if trainnum=0 then
        sqladdthree=sqladdthree&"resume_train=0,"
    end if
end if
if trim(Request("lang"))="1" then
sqladdthree=sqladdthree&"resume_lang=1,"
else
	sql="select * from job_p_lang where lang_resumeid="&rid&""
	rs.open sql,conn,1,1
	langnum=rs.RecordCount
    rs.close
	if langnum=0 then
		sqladdthree=sqladdthree&"resume_lang=0,"
    end if
end if
set rs=nothing
conn.execute("update job_p_resume set "&sqladdthree&"resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
Set rs= Server.CreateObject("ADODB.RecordSet")
sql="select resume_work from job_p_resume where resume_pmember='"&pmember_login&"' and resume_id="&rid
rs.open sql,conn,1,1
if not rs.eof then
works=rs(0)
end if
rs.close
set rs=nothing
%>
<table width="98%" border="0" align="center" cellpadding="2" cellspacing="1" style="font-size:12px; line-height:20px;">
<form name="" action="person_careerwill.asp?rid=<%=rid%>" method="post">
  <tr style="height:20px; background:url(../skin/skin1/bg1.gif) #F1F8FC repeat-x; font-weight:bold; padding:0 4px;">
    <td height="21" colspan="5" valign="middle"> 　工作经历（注：带<font color="#ff6600">＊</font>号为必填项）</td>
  </tr>
  <tr>
    <td colspan="5" bgcolor="#F1F8FC">　　<b>按"添加"增加新的工作经验。 要更改或删除某项工作经验，请按"编辑"或"删除"链接。</b></td>
  </tr>
  <tr>
    <td width="92" height="25" align="right" bgcolor="#F1F8FC">&nbsp;</td>
    <td width="198" bgcolor="#F1F8FC">公司名称</td>
    <td width="252" bgcolor="#F1F8FC">工作时间</td>
    <td width="97" bgcolor="#F1F8FC">部门</td>
    <td width="75" bgcolor="#F1F8FC">操作</td>
  </tr>
  <%set rst=server.createobject("ADODB.Recordset")
sql="select * from job_p_work where work_resumeid="&rid&" order by work_announcedate desc"
rst.open sql,conn,1,1
if not rst.eof then
for i=1 to rst.recordcount
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">经历<%=capitalization(small(i))%>：</td>
    <td bgcolor="#F1F8FC"><%=rst("work_comname")%></td>
    <td bgcolor="#F1F8FC"><%=rst("work_startyear")%>年<%=rst("work_startmonth")%>月――<%if rst("work_endyear")=0 and rst("work_endmonth")=0 then%>至今<%else%><%=rst("work_endyear")%>年<%=rst("work_endmonth")%>月<%end if%></td>
    <td bgcolor="#F1F8FC"><%=rst("work_dept")%></td>
    <td bgcolor="#F1F8FC"><a href="#" onClick="window.open ('person_modiresume.asp?Action=Modiwork&id=<%=rst("work_id")%>&rid=<%=rid%>','newwindow','height=260,width=580,top=200,left=200,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no') ">编辑</a> <a href="person_addresume.asp?Action=Delwork&id=<%=rst("work_id")%>&rid=<%=rid%>">删除</a></td>
  </tr>
  <%
rst.movenext
next
end if
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">经历<%=capitalization(small(rst.recordcount+1))%>：</td>
    <td bgcolor="#F1F8FC"><a onclick="jumpwindow(4);" style="cursor:hand"><font color="#FF0000"><b>添加</b></font></a> 
      <input type="checkbox" name="works" id="works" value="1" <%if works=1 then Response.Write("checked")%>  />
如果无工作经验，请选中此项！</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
  <%
rst.close
%>
  <tr>
    <td align="right" bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC"><label>
      <input type="submit" name="Submit" value="下一步" />
      <input type="button" name="Submit1" value="返回" onclick="javascript:history.back()" />
    </label></td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
    <td bgcolor="#F1F8FC">&nbsp;</td>
  </tr>
  </form>
</table>
<!--添加修改工作经历-->
<div id="jumply4" style="position:absolute;background-color:#fff; z-index:9999;display:none; width:500px;">
<form name="workadd" action="person_addresume.asp?Action=Savework&rid=<%=rid%>" method="post" onSubmit="return Jugew(this)">
<div class="memmenul">
<div class="leftmenutit"><span>编辑<font color="#FF6600" ><b><%=session(""&FRHRCMS&"resume_title")%></b></font>的工作经历（注：带＊号为必填项）&nbsp;<a style="cursor:pointer; color:#FFFFFF" onclick="unwindow(4)">关闭</a></span></div>
<li><font color="#ff6600">＊</font>时间范围：
  从
<select name="start_year" id="start_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
 response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
<select name="start_month" id="start_month">
<option value="0" selected="selected">月</option>
<%
for i=1 to 12
 response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
到
<select name="end_year" id="end_year">
<option value="0" selected="selected">年</option>
<%
for i=year(date())-70 to year(date())
response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
<select name="end_month" id="end_month">
<option value="0" selected="selected">月</option>
<%
for i=1 to 12
response.write "<option value='"&i&"'>"&i&"</option>"
next
%>
</select>
 (后两项不填表示至今)</li>
<li><font color="#ff6600">＊</font>公司名称：
  <input name=comname id="comname" size=50 maxLength=50>
</li>
<li><font color="#ff6600">＊</font>公司性质：
  <select name="ecoclass" size="1" id="select4">
<option value="" selected>---请选择---</option>
<%
Set rs= Server.CreateObject("ADODB.RecordSet")							
sql="select ecoclass_id,ecoclass_name from job_ecoclass"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("ecoclass_id")&">"&rs("ecoclass_name")&"</option>"
rs.movenext
loop
rs.close
%>
</select>
</li>
<li><font color="#ff6600">＊</font>所属行业：
  <select name=trade id="select2">
<option value="" selected>---请选择---</option>
<%
sql="select trade_id,trade_name from job_trade"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("trade_id")&">"&rs("trade_name")&"</option>"
rs.movenext
loop
rs.close
%>
</SELECT>
</li>
<li><font color="#ff6600">＊</font>所在部门：
  <INPUT name=dept id="dept" size=30 maxLength=25></li>
<li><font color="#ff6600">＊</font>岗位类别：
<select name="mainposition" size="1" id="mainposition" onChange=GetPosition(this.options[this.selectedIndex].value)>
<option value="" selected>---请选择---</option>
<%
sql="select position_id,position_name from job_position where position_fid=0"
rs.open sql,conn,1,1
do while not rs.eof
response.write"<OPTION value="&rs("position_id")&">"&rs("position_name")&"</option>"
rs.movenext
loop
rs.close
%>
</select>
<span id="load300"></span><span id="cposition">
<select name=subposition id="subposition">
<option value="" selected>---请选择---</option>
</select>
                </span></li>
<li><font color="#ff6600">＊</font>职位名称：
  <INPUT name=place id="place" size="30" maxLength=50></li>
<li><font color="#ff6600">　</font>工作描述：
  <TEXTAREA name=introduce cols=50 id="introduce" style="HEIGHT: 100px"></TEXTAREA></li>
<li><FONT color=#ff6600>工作描述限2000个字符，请详细描述您的职责范围、工作任务以及取得的成绩等。 </FONT></li>
<li><font color="#ff6600">　</font>离职原因：
  <INPUT name=leftreason id="leftreason" size="28" maxLength=50></li>
<li><FONT color=#ff6600>简明扼要地阐述离职原因，字数在50字以内。</FONT></li>
<li><INPUT name="submit" type="submit" value="保　存">
<INPUT name=Exit type=button class="inputa3" onClick="unwindow(4)" value="关　闭"></li>
</form>
</div>
</div>
<!--工作地添加结束-->
<%End Sub%>
</div>
<%
conn.close:set conn=nothing%>
<%Sub SaveAddone()
resume_title=CheckStr(trim(request("title")))
if resume_title="" then
 Response.Write ("<script language=JavaScript>{alert('添加的简历名称不能为空!');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
if rid="" then
set rs=server.createobject("ADODB.Recordset")
sql="select resume_title from job_p_resume where resume_title='"&resume_title&"' and resume_pmember='"&pmember_login&"'"
rs.open sql,conn,1,1
if not rs.eof then
 rs.close
 set rs=nothing
 Response.Write ("<script language=JavaScript>{alert('简历名称已存在！');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
rs.close
set rs=nothing
end if
resume_usergroup=cint(trim(request("usergroup")))
resume_name=CheckStr(trim(request("names")))
if resume_name="" then
 Response.Write ("<script language=JavaScript>{alert('错误：姓名不能为空!');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
resume_appraise=CheckStrbox(request("appraise"))
If lenmix(resume_appraise)>=2000 Then 
response.write "<script language=javascript>alert('错误：自我评价太长了，要求不多于2000个字符!！');location.href='javascript:history.back()';</script>"
response.end 
end if
resume_sex=cint(trim(request("sex")))
resume_birth=cdate(request("birth"))
resume_cardtype=cint(trim(request("cardtype")))
resume_idcard=CheckStr(trim(request("idcard")))
if trim(request("nation"))<>"" then
 resume_nation=cint(trim(request("nation")))
end if
if trim(request("polity"))<>"" then
 resume_polity=cint(trim(request("polity")))
end if
if trim(request("marriage"))<>"" then
 resume_marriage=cint(trim(request("marriage")))
end if
if trim(request("height"))<>"" then
 resume_height=cint(trim(request("height")))
end if
if trim(request("weight"))<>"" then
 resume_weight=cint(trim(request("weight")))
end if
if trim(request("hukouprovince"))<>"" then
 resume_hukouprovinceid=trim(request("hukouprovince"))
end if
if trim(request("hukoucapital"))<>"" then
 resume_hukoucapitalid=trim(request("hukoucapital"))
end if
if trim(request("hukoucity"))<>"" then
 resume_hukoucityid=trim(request("hukoucity"))
end if
resume_provinceid=trim(request("province"))
resume_capitalid=trim(request("capital"))
resume_cityid=trim(request("city"))
If IsNumeric(resume_cityid)=False Then
 Response.Write ("<script language=JavaScript>{alert('目前所在地必须全部选择！');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
End If
resume_edu=cint(trim(request("edu")))
resume_zhicheng=CheckStr(trim(request("zhicheng")))
resume_school=CheckStr(trim(request("school")))
if request("graduate")<>"" then
resume_graduate=cdate(request("graduate"))
end if
if trim(request("tel"))<>"" then
	resume_tel=trim(request("tel"))
end if
if CheckStr(trim(request("mobile")))<>"" then
	resume_tel=resume_tel&","&CheckStr(trim(request("mobile")))
else
	resume_tel=resume_tel&","
end if
resume_chat=CheckStr(trim(request("chat")))
resume_email=CheckStr(trim(request("email")))
resume_url=CheckStr(trim(request("url")))
resume_address=CheckStr(trim(request("address")))
resume_post=CheckStr(trim(request("post")))
resume_sumup=CheckStr(trim(request("sumup")))

'查询默认模板ID
set rs=conn.execute("select * from JOB_Template where ChannelID=1 and IsDefault="&FR_HR_True&" and IsDefaultInProject="&FR_HR_True&" and typeid=13")
if not rs.eof then
resume_template=rs("TemplateID")
end if
rs.close
set rs=nothing

'添加或更新简历
set rs=server.createobject("ADODB.Recordset")
if rid<>""then
sql="select * from job_p_resume where resume_id="&rid
rs.open sql,conn,1,3
else
sql="select * from job_p_resume"
rs.open sql,conn,1,3
If CheckPFlag("Plimits",6)=False then
	If CheckPFlag("Pdianshus",3)=False then
		response.write "<script language=javascript>alert('由于您创建的简历数已达到上限（或无可用点数），暂不能继续申请，如需继续创建简历请联系网站客服进行升级！');location.href='javascript:history.back()';</script>"
		response.end()
	else
		Call PayLog(pmember_login,1,"创建简历“"&resume_title&"”扣点",Group_Pdianshus(3),0)
	end if
else
	Call PayLog(pmember_login,1,"创建简历“"&resume_title&"”",0,0)
end if
conn.Execute("Update JOB_member set Member_resumenums=Member_resumenums+1 where Member_login='"&pmember_login&"' and Member_typeid=1")
'增加积分
Call IncomeIntegral(pmember_login,1,-Group_Pintegrals(3))
rs.addnew
rs("resume_visitnum")=0    '新加默认浏览次数为0
rs("resume_education")=0
rs("resume_train")=0
rs("resume_lang")=0
rs("resume_work")=0
rs("resume_careerwill")=0
end if
rs("resume_pmember")=pmember_login
rs("resume_usergroup")=resume_usergroup
rs("resume_title")=resume_title
rs("resume_name")=resume_name
rs("resume_sex")=resume_sex
rs("resume_birth")=resume_birth
rs("resume_cardtype")=resume_cardtype
rs("resume_idcard")=resume_idcard
rs("resume_nation")=resume_nation
rs("resume_polity")=resume_polity
rs("resume_marriage")=resume_marriage
rs("resume_height")=resume_height
rs("resume_weight")=resume_weight
rs("resume_hukouprovinceid")=resume_hukouprovinceid
rs("resume_hukoucapitalid")=resume_hukoucapitalid
rs("resume_hukoucityid")=resume_hukoucityid
rs("resume_provinceid")=resume_provinceid
rs("resume_capitalid")=resume_capitalid
rs("resume_cityid")=resume_cityid
rs("resume_edu")=resume_edu
rs("resume_zhicheng")=resume_zhicheng
rs("resume_school")=resume_school
rs("resume_graduate")=resume_graduate
rs("resume_tel")=resume_tel
rs("resume_chat")=resume_chat
rs("resume_email")=resume_email
rs("resume_url")=resume_url
rs("resume_address")=resume_address
rs("resume_post")=resume_post
rs("resume_sumup")=resume_sumup
rs("resume_appraise")=resume_appraise
rs("resume_personinfo")=1
rs("resume_announcedate")=now()
rs("resume_chinese")=1
rs("resume_openness")=0
if resume_template<>"" then
rs("resume_template")=resume_template
end if
if AdminResCheckReg=1 then '系统是否审核简历
	rs("resume_flag")=0
else
	if resume_usergroup=2 then  '高级简历未审核
		if rid="" then  '新建高级简历审核
			rs("resume_flag")=0
		end if
	else
		rs("resume_flag")=1
	end if
end if 
rs.update
rs.close
'如果是创建的第一份简历，将自动更新个人基本资料
Set rs1=conn.Execute("select * from JOB_member where member_login='"&pmember_login&"'")
	member_name=rs1("member_name")
	rs1.close
	Set rs1=Nothing
if member_name="" or isnull(member_name) then
	set rs1=server.createobject("ADODB.Recordset")
	sql="select * from JOB_member where member_login='"&pmember_login&"'"
	rs1.open sql,conn,1,3
	rs1("Member_name")=resume_name
	rs1("Member_sex")=resume_sex
	rs1("Member_birth")=resume_birth
	rs1("Member_cardtype")=resume_cardtype
	rs1("Member_idcard")=resume_idcard
	rs1("Member_marriage")=resume_marriage
	rs1("Member_polity")=resume_polity
	rs1("Member_hukouprovinceid")=resume_hukouprovinceid
	rs1("Member_hukoucapitalid")=resume_hukoucapitalid
	rs1("Member_hukoucityid")=resume_hukoucityid
	rs1("Member_provinceid")=resume_provinceid
	rs1("Member_capitalid")=resume_capitalid
	rs1("Member_cityid")=resume_cityid
	rs1("Member_edu")=resume_edu
	rs1("Member_tel")=resume_tel
	rs1("Member_chat")=resume_chat
	rs1("Member_url")=resume_url
	rs1("Member_address")=resume_address
	rs1("Member_post")=resume_post
	rs1.update
	rs1.close
	Set rs1=Nothing
end if
session(""&FRHRCMS&"resume_title")=resume_title
sql="select resume_id from job_p_resume where resume_title='"&resume_title&"' and resume_pmember='"&pmember_login&"'"
rs.open sql,conn,1,1
resume_id=rs("resume_id")
rs.close
set rs=nothing
response.redirect "person_addresume.asp?action=Addtwo&rid="&resume_id&""
response.end
End Sub
Sub Saveedu()
education_school=CheckStr(trim(request("school")))
education_edu=cint(trim(request("edu")))
if education_school="" then
 Response.Write ("<script language=JavaScript>{alert('错误：院校名称不能为空!');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if

set rs=server.createobject("ADODB.Recordset")
sql="select education_school from job_p_education where education_school='"&education_school&"' and education_edu="&education_edu&" and education_resumeid="&rid
rs.open sql,conn,1,1
if not rs.eof then
 rs.close
 set rs=nothing
 conn.close
 set conn=nothing
 Response.Write ("<script language=JavaScript>{alert('错误：此教育记录已经添加！');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
rs.close
set rs=nothing

education_detail=CheckStrbox(request("detail"))
If lenmix(education_detail)>=8000 Then 
response.write "<script language=javascript>alert('错误：专业描述太长了，要求不多于8000个字符！');location.href='javascript:history.back()';</script>"
response.end 
end if

education_startyear=cint(trim(request("start_year")))
education_startmonth=cint(trim(request("start_month")))
education_endyear=cint(trim(request("end_year")))
education_endmonth=cint(trim(request("end_month")))
education_mainprofession=cint(trim(request("mainprofession")))
education_subprofession=cint(trim(request("subprofession")))
'判断时间时候正确
if education_endyear<>0 then
	if education_startyear=<education_endyear then
		if education_endmonth<>0 then
			if education_startyear=education_endyear and education_startmonth>education_endmonth then
			response.write "<script language=javascript>alert('错误：教育时间填写不正确！');location.href='javascript:history.back()';</script>"
			response.end 
			end if
		end if
	else
	response.write "<script language=javascript>alert('错误：教育时间填写不正确！');location.href='javascript:history.back()';</script>"
	response.end 
	end if
end if
'把信息存入教育表education

sql="select * from job_p_education"
set rs=server.CreateObject("adodb.recordset")
rs.open sql,conn,1,3
rs.addnew
rs("education_startyear")=education_startyear
rs("education_startmonth")=education_startmonth
rs("education_endyear")=education_endyear
rs("education_endmonth")=education_endmonth
rs("education_school")=education_school
rs("education_mainprofession")=education_mainprofession
rs("education_subprofession")=education_subprofession
rs("education_edu")=education_edu
rs("education_detail")=education_detail
rs("education_pmember")=pmember_login
rs("education_resumeid")=rid
rs("education_language")=lang
rs.update

conn.execute("update job_p_resume set resume_education=1,resume_chinese=1,resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
 
 response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
 response.end
End Sub
Sub Savetrain()
train_train=CheckStr(trim(request("train")))
if train_train="" then
 Response.Write ("<script language=JavaScript>{alert('错误：培训机构不能为空!');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
train_detail=CheckStrbox(request("detail"))
If lenmix(train_detail)>=8000 Then 
response.write "<script language=javascript>alert('错误：详细描述太长了，要求不多于8000个字符!！');location.href='javascript:history.back()';</script>"
response.end 
end if
train_startyear=cint(trim(request("start_year")))
train_startmonth=cint(trim(request("start_month")))
train_endyear=cint(trim(request("end_year")))
train_endmonth=cint(trim(request("end_month")))
train_address=CheckStr(trim(request("address")))
train_course=CheckStr(trim(request("course")))
train_certificate=CheckStr(trim(request("certificate")))
'判断时间时候正确
if train_endyear<>0 then
	if train_startyear=<train_endyear then
		if train_endmonth<>0 then
			if train_startyear=train_endyear and train_startmonth>train_endmonth then
			response.write "<script language=javascript>alert('错误：培训时间填写不正确！');location.href='javascript:history.back()';</script>"
			response.end 
			end if
		end if
	else
	response.write "<script language=javascript>alert('错误：培训时间填写不正确！');location.href='javascript:history.back()';</script>"
	response.end 
	end if
end if

sql="select * from job_p_training"
set rs=server.CreateObject("adodb.recordset")
rs.open sql,conn,1,3
rs.addnew
rs("train_startyear")=train_startyear
rs("train_startmonth")=train_startmonth
rs("train_endyear")=train_endyear
rs("train_endmonth")=train_endmonth
rs("train_train")=train_train
rs("train_address")=train_address
rs("train_course")=train_course
rs("train_certificate")=train_certificate
rs("train_detail")=train_detail
rs("train_pmember")=pmember_login
rs("train_resumeid")=rid
rs.update
rs.close
set rs=nothing
	conn.execute("update job_p_resume set resume_train=1,resume_chinese=1,resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
 response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
 response.end
End Sub
Sub Savelang()
lang_name=cint(trim(request("language")))
lang_master=cint(trim(request("master")))
set rs=server.CreateObject("adodb.recordset")
sql="select * from job_p_lang"
rs.open sql,conn,1,3
rs.addnew
rs("lang_name")=lang_name
rs("lang_master")=lang_master
rs("lang_pmember")=pmember_login
rs("lang_resumeid")=rid
rs.update
rs.close
set rs=nothing
conn.execute("update job_p_resume set resume_lang=1,resume_chinese=1,resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
response.end
End Sub
Sub Savework()
work_comname=CheckStr(trim(request("comname")))
if work_comname="" then
 Response.Write ("<script language=JavaScript>{alert('错误：公司名称不能为空!');location.href = 'javascript:history.go(-1)';}</script>")
 Response.End
end if
work_introduce=CheckStrbox(request("introduce"))
If lenmix(work_introduce)>=8000 Then 
response.write "<script language=javascript>alert('错误：工作描述太长了，要求不多于8000个字符!！');location.href='javascript:history.back()';</script>"
response.end 
end if

work_startyear=cint(trim(request("start_year")))
work_startmonth=cint(trim(request("start_month")))
work_endyear=cint(trim(request("end_year")))
work_endmonth=cint(trim(request("end_month")))
work_ecoclass=cint(trim(request("ecoclass")))
work_trade=cint(trim(request("trade")))
work_dept=CheckStr(trim(request("dept")))
work_mainposition=cint(trim(request("mainposition")))
work_subposition=cint(trim(request("subposition")))
work_place=CheckStr(trim(request("place")))
work_leftreason=CheckStr(trim(request("leftreason")))
'判断时间时候正确
if work_endyear<>0 then
	if work_startyear=<work_endyear then
		if work_endmonth<>0 then
			if work_startyear=work_endyear and work_startmonth>work_endmonth then
			response.write "<script language=javascript>alert('错误：工作时间填写不正确！');location.href='javascript:history.back()';</script>"
			response.end 
			end if
		end if
	else
	response.write "<script language=javascript>alert('错误：工作时间填写不正确！');location.href='javascript:history.back()';</script>"
	response.end 
	end if
end if
set rs=server.CreateObject("adodb.recordset")
sql="select * from job_p_work"
rs.open sql,conn,1,3
rs.addnew
rs("work_startyear")=work_startyear
rs("work_startmonth")=work_startmonth
rs("work_endyear")=work_endyear
rs("work_endmonth")=work_endmonth
rs("work_comname")=work_comname
rs("work_ecoclass")=work_ecoclass
rs("work_trade")=work_trade
rs("work_dept")=work_dept
rs("work_mainposition")=work_mainposition
rs("work_subposition")=work_subposition
rs("work_place")=work_place
rs("work_introduce")=work_introduce
rs("work_leftreason")=work_leftreason
rs("work_pmember")=pmember_login
rs("work_resumeid")=rid
rs.update
rs.close
'  --把简历表中的相应语言版本的工作经验标志置1，同时更新时间
conn.execute("update job_p_resume set resume_work=1,resume_chinese=1,resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
response.redirect "person_addresume.asp?action=Addthree&rid="&rid&""
response.end
End Sub
Sub Deledu()
education_id=clng(trim(request("id")))
rid=clng(trim(request("rid")))

conn.execute("delete from job_p_education where education_id="&education_id)

conn.execute("update job_p_resume set resume_announcedate="&FR_HR_Now&"  where resume_id="&rid)
set rs=server.CreateObject("adodb.recordset")
sql="select * from job_p_education where education_resumeid="&rid
rs.open sql,conn,1,1
educationnum=rs.RecordCount
rs.close
set rs=nothing
if educationnum=0 then
        conn.execute("update job_p_resume set resume_education=0 where resume_id="&rid)
end if
 response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
 response.end
End Sub
Sub Deltrain()
train_id=clng(trim(request("id")))
rid=clng(trim(request("rid")))
conn.execute("delete from job_p_training where train_id="&train_id)
'  --更新简历时间
conn.execute("update job_p_resume set resume_announcedate="&FR_HR_Now&" where resume_id="&rid)
   '--判断是否还有该语言版本的培训经历,若没有则把该简历中的相应语言版本的培训标志置0
set rs=server.CreateObject("adodb.recordset")
sql="select * from job_p_training where train_resumeid="&rid&""
rs.open sql,conn,1,1
trainnum=rs.RecordCount
rs.close
set rs=nothing
    if trainnum=0 then
         conn.execute("update job_p_resume set resume_train=0 where resume_id="&rid)       
    end if
 response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
 response.end
End Sub
Sub Dellang()
lang_id=clng(trim(request("id")))
rid=clng(trim(request("rid")))

'   --删除语言水平
    conn.execute("delete from job_p_lang where lang_id="&lang_id)
'   --更新简历时间
    conn.execute("update job_p_resume set resume_announcedate="&FR_HR_Now&"  where resume_id="&rid)
'   --判断是否还有该语言版本的语言水平,若没有则把该简历中的相应语言版本的语言标志置0
	sql="select * from job_p_lang where lang_resumeid="&rid&""
	set rs=server.CreateObject("adodb.recordset")
	rs.open sql,conn,1,1
	langnum=rs.RecordCount
    rs.close
	set rs=nothing
	if langnum=0 then
         conn.execute("update job_p_resume set resume_lang=0 where resume_id="&rid)
    end if
 response.redirect "person_addresume.asp?action=Addtwo&rid="&rid&""
 response.end
End Sub
Sub Delwork()
work_id=clng(trim(request("id")))
rid=clng(trim(request("rid")))
'删除工作经历
    conn.execute("delete from job_p_work where work_id="&work_id)
'   --更新简历时间
    conn.execute("update job_p_resume set resume_announcedate="&FR_HR_Now&"  where resume_id="&rid)
'   --判断是否还有该语言版本的教育经历,若没有则把该简历中的相应语言版本的教育标志置0
    sql="select * from job_p_work  where work_resumeid="&rid&""
    set rs=server.CreateObject("adodb.recordset")
	rs.open sql,conn,1,1
	worknum=rs.RecordCount
	rs.close
	set rs=nothing
	if worknum=0 then    
       conn.execute("update job_p_resume set resume_work=0 where resume_id="&rid)
    end if
 response.redirect "person_addresume.asp?action=Addthree&rid="&rid&""
 response.end
End Sub
%>