<!--#include file="inc/md5.asp" -->
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=gbk">
<title>LOVE1℃论坛安装向导</title>
<link rel="stylesheet" type="text/css" id="css" href="install/style.css">
</head>
<%
Function IsObjInstalled(strClassString)
 On Error Resume Next
 IsObjInstalled = False
 Err = 0
 Dim fsoObj
 Set fsoObj = Server.CreateObject(strClassString)
 If 0 = Err Then IsObjInstalled = True
 Set fsoObj = Nothing
 Err = 0
End Function
'取随机两位字母
Function prechr(rannum)
 dim i,prechar,pre,preran
 preran=""
 prechar="a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z" 
 pre=split(prechar,",")
 for i=1 to rannum
  Randomize
  preran=preran&pre(Int((21*Rnd)))
 next
 prechr=preran
End Function
On Error Resume Next
actionstr=request.form("action")
%>
<body bgcolor="#085878" text="#000000"><table width="95%" border="0" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF" align="center"><tr><td><table width="98%" border="0" cellspacing="0" cellpadding="0" align="center"><tr>
          <td class="install" height="30" valign="bottom"><font color="#FF0000">&gt;&gt;</font> 
            LOVE1℃论坛&nbsp;安装向导 </td>
    </tr><tr><td><hr noshade align="center" width="100%" size="1"></td></tr>
<%
if actionstr="config" then
%>
<tr>
          <td><b>当前状态: </b><font color="#0000EE">设置数据库相关参数</font></td>
        </tr>
<tr><td><hr noshade align="center" width="100%" size="1"></td></tr>
<tr><td><br>
<tr><td align="center">
<table width="80%" cellspacing="1" bgcolor="#000000" border="0" align="center">
<tr bgcolor="#085878"><td style="color: #FFFFFF; padding-left: 10px" width="32%">提示信息</td>
</tr><tr>
<td class="message">
<li>请在下面填写您的数据库信息与后台管理员帐号信息</li>
<li>后台管理路径为:/admin.asp</li>
</td>
</tr></table><br>
<form method="post" action="setup.asp">
              <table width="80%" cellspacing="1" bgcolor="#000000" border="0" align="center">
                <tr class="header"> 
                  <td width="20%">设置选项</td>
                  <td width="30%">当前值</td>
                  <td width="50%">注释</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;数据库名:</td>
                  <td class="altbg2"><input type="text" name="dbname" value="ftbbs_<%=prechr(5)%>"  size="30"></td>
                  <td class="altbg1">&nbsp;数据库名称(默认安装将取当前值为库名)</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;数据库表前缀名:</td>
                  <td class="altbg2"><input type="text" name="ft" value="ft<%=prechr(2)%>_"  size="30"></td>
                  <td class="altbg1">&nbsp;数据库表前缀名(默认安装将取当前值为表前缀名)</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;cookies域:</td>
                  <td class="altbg2"><input type="text" name="cookdm" value=""  size="30"></td>
                  <td class="altbg1">&nbsp;如你的域名是abc.com那么你可以填<font color="#FF0000">abc.com</font>,也可不填</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;后台管理用户:</td>
                  <td class="altbg2"><input name="adminuser" type="text" id="adminuser" value="admin"  size="30"></td>
                  <td class="altbg1">&nbsp;系统后台管理超级用户</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;管理用户密码:</td>
                  <td class="altbg2"><input name="adminpwd" type="password" id="adminpwd" value="123456"  size="30"></td>
                  <td class="altbg1">&nbsp;系统后台管理用户密码(默认为:123456)</td>
                </tr>
              </table>
              <br>
<input type="hidden" name="action" value="install">
<input type="button" name="submit" value=" 上一步 " style="height: 25" onClick="window.location='setup.asp'">&nbsp;
<input type="submit" name="submit" value=" 下一步 " style="height: 25">
</form></td></tr>
<%
elseif actionstr="install" then
    setupurl=request.serverVariables("HTTP_REFERER")
    setupurl=replace(setupurl,"http://","")
    urlarr=split(setupurl,"/")
    charmax=UBound(urlarr)
    dbname=request.form("dbname")
    ft=request.form("ft")
	cookdm=request.form("cookdm")
    adminuser=request.form("adminuser")
    adminpwd=md5(request.form("adminpwd"))
	datestr=request.form("dbname")&".mdb"
    dim conn 
    dim ConnStr
    'db="database/"&dbname&".mdb"
	if charmax=2 then
	bbsfolder=urlarr(1)
	db="\"&bbsfolder&"\database\"&dbname&".mdb"
	elseif charmax>2 then
	errorstr3="请不要把论坛文件放在三级以上的目录下,最好的做法是在你站点根目录下新建一文件夹如bbs<br>&nbsp;&nbsp;&nbsp;&nbsp;然后把论坛包中upload文件夹下的所有文件全部复制到新建的bbs目录下再进行安装."
	else
    db="\database\"&dbname&".mdb"
	end if
    Set conn = Server.CreateObject("ADODB.Connection")
    ConnStr = "Provider = Microsoft.Jet.OLEDB.4.0;Data Source ="&Server.MapPath(db)
	
	Set fso = Server.CreateObject("Scripting.FileSystemObject")
	'SqlDataBase=split(db,"\")
	'for i=mk to Ubound(SqlDataBase)-1
	if not fso.folderexists(Server.MapPath("database")) then fso.CreateFolder(Server.MapPath("database"))
	if Err then
	   errorstr1="database 文件夹没有被创建！"&Err.Description
	   err.Clear
	end if
	'next
	Set fso = nothing

	Set Ca = Server.CreateObject("ADOX.Catalog")
	call Ca.Create(""&ConnStr&"")
	Set Ca = Nothing	
	If Err Then
		errorstr2="ACCESS数据库没有被创建!因为"&Err.Description&"如果你要重新安装请删除database目录下已存在的库文件."
	end if
	err.Clear
	
	conn.open ConnStr
    if err or errorstr2<>"" then 
    err.clear 
    set conn=nothing
%>
<tr><td><b>当前状态: </b><font color="#0000EE">浏览/编辑当前配置</font></td></tr>
<tr><td><hr noshade align="center" width="100%" size="1"></td></tr>
<tr><td><br>
<tr><td align="center">
<table width="80%" cellspacing="1" bgcolor="#000000" border="0" align="center">
<tr bgcolor="#085878"><td style="color: #FFFFFF; padding-left: 10px" width="32%">提示信息</td>
</tr><tr>
<td class="message">
<li>
<%
if errorstr3<>"" then
response.write errorstr3
else
response.write errorstr1&" "&errorstr2
end if
%>
</li></td>
</tr></table><br>
<form method="post" action="setup.asp">
              <table width="80%" cellspacing="1" bgcolor="#000000" border="0" align="center">
                <tr class="header"> 
                  <td width="20%" height="19">设置选项</td>
                  <td width="30%">当前值</td>
                  <td width="50%">注释</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;数据库名:</td>
                  <td class="altbg2"><input type="text" name="dbname" value="ftbbs_<%=prechr(5)%>"  size="30"></td>
                  <td class="altbg1">&nbsp;数据库名称(默认安装将取当前值为库名)</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;数据库表前缀名:</td>
                  <td class="altbg2"><input name="ft" type="text" id="ft" value="ft<%=prechr(2)%>_"  size="30"></td>
                  <td class="altbg1">&nbsp;数据库表前缀名(默认安装将取当前值为表前缀名)</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;cookies域:</td>
                  <td class="altbg2"><input type="text" name="cookdm" value=""  size="30"></td>
                  <td class="altbg1">&nbsp;如你的域名是abc.com那么你可以填<font color="#FF0000">abc.com</font>,也可不填</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;后台管理用户:</td>
                  <td class="altbg2"><input name="adminuser" type="text" id="adminuser" value="admin"  size="30"></td>
                  <td class="altbg1">&nbsp;系统后台管理超级用户</td>
                </tr>
                <tr> 
                  <td class="altbg1">&nbsp;管理用户密码:</td>
                  <td class="altbg2"><input name="adminpwd" type="password" id="adminpwd" value="123456"  size="30"></td>
                  <td class="altbg1">&nbsp;系统后台管理用户密码(默认为:123456)</td>
                </tr>
              </table>
              <br>
<input type="hidden" name="action" value="install">
<input type="button" name="submit" value=" 上一步 " style="height: 25" onClick="window.location='setup.asp'">&nbsp;
<input type="submit" name="submit" value=" 下一步 " style="height: 25">
</form></td></tr>
   <%else%>
<tr><td><b>当前状态: </b><font color="#0000EE">开始安装 FTBBS</font></td></tr>
<tr><td><hr noshade align="center" width="100%" size="1"></td></tr>
<tr><td align="center">
<textarea name="notice" style="width: 80%; height: 330px" readonly id="notice">
安装程序正在创建数据表，请您耐心的等待......
</textarea>
<br><br>
<input type="button" name="submit" value=" 正在安装... " disabled style="height: 25" onClick="window.location='default.asp'" id="laststep"><br><br>
<br>
</td></tr>
<%
strSQL = "CREATE TABLE "&ft&"BBS_Cate (" 
strSQL =strSQL +"BBS_ID autoincrement PRIMARY KEY ," 
strSQL =strSQL +"BBS_Cate_ID text(20) Null ," 
strSQL =strSQL +"BBS_Cate_PID text(50) Null ," 
strSQL =strSQL +"BBS_Cate_Name text(50) Null ," 
strSQL =strSQL +"BBS_Cate_Topic int NOT NULL default 0," 
strSQL =strSQL +"BBS_Cate_Reply int NOT NULL default 0," 
strSQL =strSQL +"BBS_Cate_Manager_Name text(200) ," 
strSQL =strSQL +"BBS_Cate_Manager_Email text(50) Null ," 
strSQL =strSQL +"BBS_Cate_Qs int NULL default 0," 
strSQL =strSQL +"treesign int NULL default 0," 
strSQL =strSQL +"deleted int NOT NULL default 0," 
strSQL =strSQL +"Initial text(1) Null ,"
strSQL =strSQL +"display int NULL default 0," 
strSQL =strSQL +"totop int NULL default 0," 
strSQL =strSQL +"BBS_Cate_Note text NULL ,"
strSQL =strSQL +"BBS_Cate_Board text NULL"
strSQL =strSQL +") " 
Conn.Execute(strSQL)

strSQL ="CREATE TABLE "&ft&"BBS_Poll (" 
strSQL =strSQL +"id autoincrement PRIMARY KEY ," 
strSQL =strSQL +"pid int NULL default 0," 
strSQL =strSQL +"投票类型 text(50) Null ," 
strSQL =strSQL +"选项内容 text(255) Null ," 
strSQL =strSQL +"票数 int NULL default 0," 
strSQL =strSQL +"投票用户 text NULL ," 
strSQL =strSQL +"发布日期 smalldatetime NULL ," 
strSQL =strSQL +"发起日期 smalldatetime NULL ," 
strSQL =strSQL +"到期日期 smalldatetime NULL" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"BBS_arrest (" 
strSQL =strSQL +"id autoincrement PRIMARY KEY ," 
strSQL =strSQL +"Content text(50) Null ," 
strSQL =strSQL +"Kind text(50) Null ," 
strSQL =strSQL +"indbdate datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"bbsmenu (" 
strSQL =strSQL +"id autoincrement PRIMARY KEY ," 
strSQL =strSQL +"BoardID_1 text(20) Null ," 
strSQL =strSQL +"BoardID_2 text(20) Null ," 
strSQL =strSQL +"pid int NULL ," 
strSQL =strSQL +"user_id text(50) Null ," 
strSQL =strSQL +"rename text(50) Null ," 
strSQL =strSQL +"remail text(50) Null ,"
strSQL =strSQL +"remenu text NULL ," 
strSQL =strSQL +"retel text(50) Null ,"
strSQL =strSQL +"reip text(50) Null ,"  
strSQL =strSQL +"dateh datetime NULL ," 
strSQL =strSQL +"kind int NULL ," 
strSQL =strSQL +"deleted int NULL ," 
strSQL =strSQL +"usertype int NULL default 1," 
strSQL =strSQL +"bbs_img text(50) Null ," 
strSQL =strSQL +"bbs_img_display int NULL ," 
strSQL =strSQL +"bbs_img_text text(100) Null ," 
strSQL =strSQL +"img_url text(150) Null ,"
strSQL =strSQL +"img_url_display int NULL ,"
strSQL =strSQL +"img_url_text text(100) Null" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"bbstitle ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY ," 
strSQL =strSQL +"BoardID_1 text(20) Null ," 
strSQL =strSQL +"BoardID_2 text(20) Null , " 
strSQL =strSQL +"user_id text(50) Null , " 
strSQL =strSQL +"name text(50) Null , " 
strSQL =strSQL +"mail text(50) Null , " 
strSQL =strSQL +"title text(150) Null , " 
strSQL =strSQL +"menu text NULL , " 
strSQL =strSQL +"tel text(50) Null , " 
strSQL =strSQL +"ip text(50) Null , " 
strSQL =strSQL +"hit int NULL default 0, " 
strSQL =strSQL +"rep int NULL default 0, " 
strSQL =strSQL +"dateh datetime NULL default now(), " 
strSQL =strSQL +"deleted int NULL default 0, " 
strSQL =strSQL +"sign int NULL default 0, " 
strSQL =strSQL +"redate datetime NULL , " 
strSQL =strSQL +"zhiye int NULL default 0, " 
strSQL =strSQL +"huati int NULL default 0, " 
strSQL =strSQL +"bbs_img text(50) Null , " 
strSQL =strSQL +"bbs_img_display int NULL , " 
strSQL =strSQL +"bbs_img_text text(100) Null , " 
strSQL =strSQL +"img_url text(150) Null , " 
strSQL =strSQL +"img_url_display int NULL , " 
strSQL =strSQL +"img_url_text text(100) Null , " 
strSQL =strSQL +"P_display int NULL default 1, " 
strSQL =strSQL +"showInHomepage bit NULL default 0, " 
strSQL =strSQL +"picture text(15) Null , " 
strSQL =strSQL +"htmfilename text(50) Null , " 
strSQL =strSQL +"postnum int NULL default 0, " 
strSQL =strSQL +"bbstop int NULL default 0, " 
strSQL =strSQL +"bbstop1 int NULL default 0, " 
strSQL =strSQL +"titlecolor text(15) Null , " 
strSQL =strSQL +"boardsign int NULL default 0, " 
strSQL =strSQL +"flag int NULL default 0, " 
strSQL =strSQL +"reinfo text NULL, " 
strSQL =strSQL +"xsjf int NULL default 0, " 
strSQL =strSQL +"xsdaynum int NULL default 0, " 
strSQL =strSQL +"xsreid int NULL default 0" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"clubuser ( " 
strSQL =strSQL +"clubuser_id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"clubuser_name text(100) Null , " 
strSQL =strSQL +"clubuser_nickname text(50) Null , " 
strSQL =strSQL +"clubuser_password text(50) Null , " 
strSQL =strSQL +"clubuser_phone text(50) Null , " 
strSQL =strSQL +"clubuser_fax text(50) Null , " 
strSQL =strSQL +"clubuser_url text(50) Null , " 
strSQL =strSQL +"clubuser_email text(50) Null , " 
strSQL =strSQL +"clubuser_address text(50) Null , " 
strSQL =strSQL +"clubuser_note text NULL , " 
strSQL =strSQL +"clubuser_reg_date datetime NULL default now(), " 
strSQL =strSQL +"clubuser_enter_count smallint NULL default 0, " 
strSQL =strSQL +"clubuser_ip text(50) Null , " 
strSQL =strSQL +"clubuser_realname text(50) Null , " 
strSQL =strSQL +"clubuser_id_type text(50) Null , " 
strSQL =strSQL +"clubuser_id_num text(50) Null , " 
strSQL =strSQL +"clubuser_sex text(10) Null , " 
strSQL =strSQL +"clubuser_old int NULL , " 
strSQL =strSQL +"clubuser_education text(50) Null , " 
strSQL =strSQL +"clubuser_career text(50) Null , " 
strSQL =strSQL +"clubuser_position text(50) Null , " 
strSQL =strSQL +"clubuser_salary text(50) Null , " 
strSQL =strSQL +"clubuser_marriage text(50) Null , " 
strSQL =strSQL +"clubuser_zip text(250) Null , " 
strSQL =strSQL +"clubuser_lasttime datetime NULL , " 
strSQL =strSQL +"clubuser_question text(50) Null , " 
strSQL =strSQL +"clubuser_answer text(50) Null , " 
strSQL =strSQL +"clubuser_province text(50) Null , " 
strSQL =strSQL +"clubuser_city text(50) Null , " 
strSQL =strSQL +"payuser int NULL default 0, " 
strSQL =strSQL +"lastloginip text(50) Null , " 
strSQL =strSQL +"baksign int NULL default 0, " 
strSQL =strSQL +"signname text NULL , " 
strSQL =strSQL +"jingyuan int NULL default 0, "
strSQL =strSQL +"tili int NULL default 100, "
strSQL =strSQL +"userimg text(15) Null , "
strSQL =strSQL +"bbsmanager int NULL default 0, "
strSQL =strSQL +"bbsadmin int NULL default 0, "
strSQL =strSQL +"friend text NULL , "
strSQL =strSQL +"JFM text(20) Null , "
strSQL =strSQL +"jfmsign int NULL default 0, "
strSQL =strSQL +"postnum int NULL default 0, "
strSQL =strSQL +"clubuser_money int NULL default 0, "
strSQL =strSQL +"homepagetitle text(80) Null , "
strSQL =strSQL +"homepagesign int NULL default 0, " 
strSQL =strSQL +"blog_mid text(100) Null , " 
strSQL =strSQL +"blog_face text(50) Null , " 
strSQL =strSQL +"lyplsign int NULL default 0, " 
strSQL =strSQL +"photo_bg text(30) Null , " 
strSQL =strSQL +"userfloder text(15) Null , " 
strSQL =strSQL +"spacesize int NULL default 100, " 
strSQL =strSQL +"bokeer int NULL default 0, " 
strSQL =strSQL +"homepagehits int NULL default 0, " 
strSQL =strSQL +"cssfile text(50) Null , " 
strSQL =strSQL +"blogheadimg text(10) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL)

strSQL ="CREATE TABLE "&ft&"ftbbs_Online ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"sessid text(100) Null , " 
strSQL =strSQL +"username text(50) Null , " 
strSQL =strSQL +"useradmin int NULL , " 
strSQL =strSQL +"stats text(255) Null , " 
strSQL =strSQL +"ip text(15) Null , " 
strSQL =strSQL +"logintime datetime NULL , "  
strSQL =strSQL +"lasttime datetime NULL " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_ad ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"adtitle text(100) Null , " 
strSQL =strSQL +"adurl text(80) Null , " 
strSQL =strSQL +"adcolor text(12) Null , " 
strSQL =strSQL +"adflag int NULL default 0, " 
strSQL =strSQL +"adtype int NULL default 0, " 
strSQL =strSQL +"begintime datetime NULL , " 
strSQL =strSQL +"endtime datetime NULL , " 
strSQL =strSQL +"ad_h int NULL default 0, " 
strSQL =strSQL +"ad_w int NULL default 0, " 
strSQL =strSQL +"ad_p int NULL default 0, " 
strSQL =strSQL +"bytime datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_admin ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"admin_user text(20) Null , " 
strSQL =strSQL +"admin_pwd text(20) Null , " 
strSQL =strSQL +"lasttime datetime NULL default now(), " 
strSQL =strSQL +"qs int NULL default 1, "  
strSQL =strSQL +"adminqs text(50) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_bmtb ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"titleid int NULL default 0, " 
strSQL =strSQL +"username text(50) Null , " 
strSQL =strSQL +"tel text(20) Null , " 
strSQL =strSQL +"age int NULL default 0, " 
strSQL =strSQL +"sex text(5) Null , " 
strSQL =strSQL +"job text(20) Null , " 
strSQL =strSQL +"edu text(15) Null , " 
strSQL =strSQL +"address text(50) Null , " 
strSQL =strSQL +"qq text(20) Null , " 
strSQL =strSQL +"flag int NULL default 0, " 
strSQL =strSQL +"infotype int NULL default 0, "
strSQL =strSQL +"bakint int NULL default 0, "
strSQL =strSQL +"bakvar text(50) Null , "
strSQL =strSQL +"mynote text NULL , "
strSQL =strSQL +"indate datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_favorites ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"clubuser_name text(15) Null , " 
strSQL =strSQL +"bbstitleid int NULL default 0, " 
strSQL =strSQL +"typesign int NULL default 0, " 
strSQL =strSQL +"indate datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_pay_log ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"clubuser_id int NULL , " 
strSQL =strSQL +"paytype int NULL default 0, " 
strSQL =strSQL +"paymoney int NULL , " 
strSQL =strSQL +"payresults int NULL default 0, " 
strSQL =strSQL +"ip text(30) Null , " 
strSQL =strSQL +"paytime datetime NULL default now(), "  
strSQL =strSQL +"sp_billno text(20) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_poll_ip ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"bbstitleid int NULL default 0, " 
strSQL =strSQL +"poll_user text(15) Null , " 
strSQL =strSQL +"poll_user_ip text(18) Null , " 
strSQL =strSQL +"poll_date datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_swap_log ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"clubuser_id int NULL , " 
strSQL =strSQL +"swaptype int NULL default 0, " 
strSQL =strSQL +"paymoney int NULL , " 
strSQL =strSQL +"getmoney int NULL , " 
strSQL =strSQL +"ip text(30) Null , " 
strSQL =strSQL +"swaptime datetime NULL default now()" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_touxian ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"xiao int NULL , " 
strSQL =strSQL +"da int NULL , " 
strSQL =strSQL +"nick text(20) Null , " 
strSQL =strSQL +"classx text(30) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbs_upload ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"upload_pic text(80) Null , " 
strSQL =strSQL +"indate datetime NULL default now(), " 
strSQL =strSQL +"file_type int NULL default 0, " 
strSQL =strSQL +"upload_size int NULL default 0, " 
strSQL =strSQL +"upload_ext text(10) Null , " 
strSQL =strSQL +"userid text(30) Null , " 
strSQL =strSQL +"upload_htm text(80) Null , " 
strSQL =strSQL +"sign int NULL default 0, " 
strSQL =strSQL +"pic_note text(200) , "
strSQL =strSQL +"photo_name text(20) Null , "
strSQL =strSQL +"photo_bg_blog int NULL default 0, "
strSQL =strSQL +"photo_pl_num int NULL default 0, "
strSQL =strSQL +"bbs_blog_type int NULL default 0, "
strSQL =strSQL +"clubuser_id int NULL ," 
strSQL =strSQL +"sale int NULL default 0 "
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftbbsmb ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"postmb text NULL , " 
strSQL =strSQL +"repostmb text NULL , " 
strSQL =strSQL +"repostformmb text NULL , " 
strSQL =strSQL +"postpollmb text NULL , " 
strSQL =strSQL +"postpgnum int NULL default 30, " 
strSQL =strSQL +"repostpgnum int NULL default 10, " 
strSQL =strSQL +"folder text(15) Null , " 
strSQL =strSQL +"ftbbsmode int NULL default 0, " 
strSQL =strSQL +"treemb text NULL , " 
strSQL =strSQL +"bbs_domain text(50) Null , " 
strSQL =strSQL +"bbs_name text(30) Null , " 
strSQL =strSQL +"upload_type text(100) Null , " 
strSQL =strSQL +"upload_size int NULL default 0, " 
strSQL =strSQL +"ft_ver text(50) Null , " 
strSQL =strSQL +"gifjpg int NULL default 0, " 
strSQL =strSQL +"uploadoff int NULL default 0, " 
strSQL =strSQL +"regoff int NULL default 0, " 
strSQL =strSQL +"posttime int NULL default 0, " 
strSQL =strSQL +"reposttime int NULL default 0, " 
strSQL =strSQL +"regsmstitle text(50) Null , " 
strSQL =strSQL +"regsmscontent text NULL , " 
strSQL =strSQL +"usernamelng text(20) Null , " 
strSQL =strSQL +"pswlng text(20) Null , " 
strSQL =strSQL +"jmailoff int NULL default 0, " 
strSQL =strSQL +"mailuser text(20) Null , " 
strSQL =strSQL +"mailpwd text(20) Null , " 
strSQL =strSQL +"mailaddress text(50) Null , " 
strSQL =strSQL +"mailsmtp text(30) Null , " 
strSQL =strSQL +"defaultcss int NULL default 0, " 
strSQL =strSQL +"getcodeoff int NULL default 0, " 
strSQL =strSQL +"bakoff int NULL default 0, " 
strSQL =strSQL +"htm_ext text(15) Null , " 
strSQL =strSQL +"onlineoff int NULL default 0, "
strSQL =strSQL +"linkoff int NULL default 0, "
strSQL =strSQL +"bakmb text NULL , "
strSQL =strSQL +"waterimg int NULL default 0, "
strSQL =strSQL +"headmb text NULL , "
strSQL =strSQL +"shoff int NULL default 0, "
strSQL =strSQL +"byoff int NULL default 0, "
strSQL =strSQL +"onlinetime int NULL default 10, "
strSQL =strSQL +"adminfile text(30) Null , "
strSQL =strSQL +"postbegintime text(15) Null , "
strSQL =strSQL +"postendtime text(15) Null , " 
strSQL =strSQL +"repostbegintime text(15) Null , " 
strSQL =strSQL +"repostendtime text(15) Null , " 
strSQL =strSQL +"swapmoney int NULL default 1, " 
strSQL =strSQL +"integral int NULL default 100, " 
strSQL =strSQL +"postget int NULL default 10, " 
strSQL =strSQL +"repostget int NULL default 5, " 
strSQL =strSQL +"topostget int NULL default 2, " 
strSQL =strSQL +"tjget int NULL default 10, " 
strSQL =strSQL +"jhget int NULL default 10, " 
strSQL =strSQL +"logintili int NULL default 1, " 
strSQL =strSQL +"postvalue int NULL default 0, " 
strSQL =strSQL +"pollvalue int NULL default 0, " 
strSQL =strSQL +"topvalue int NULL default 0, " 
strSQL =strSQL +"tjvalue int NULL default 0, " 
strSQL =strSQL +"jhvalue int NULL default 0, " 
strSQL =strSQL +"downvalue int NULL default 0, " 
strSQL =strSQL +"uploadvalue int NULL default 0, " 
strSQL =strSQL +"bakvalue int NULL default 0, " 
strSQL =strSQL +"spid text(20) Null , " 
strSQL =strSQL +"spkey text(50) Null , " 
strSQL =strSQL +"returnurl text(100) Null , "
strSQL =strSQL +"sitenav text Null "
strSQL =strSQL +") " 
Conn.Execute(strSQL)

strSQL ="CREATE TABLE "&ft&"ftblog ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"blogtitle text(50) Null , " 
strSQL =strSQL +"blogtypeid int NULL , " 
strSQL =strSQL +"blogcontent text NULL , " 
strSQL =strSQL +"blogqs int NULL default 0, " 
strSQL =strSQL +"writedate datetime NULL default now(), " 
strSQL =strSQL +"xinqin text(20) Null , " 
strSQL =strSQL +"blogplnum int NULL default 0, " 
strSQL =strSQL +"flower int NULL default 0, " 
strSQL =strSQL +"jidan int NULL default 0, "
strSQL =strSQL +"hits int NULL default 0, "
strSQL =strSQL +"userid int NULL , "
strSQL =strSQL +"userip text(30) Null , "
strSQL =strSQL +"blogtop int NULL default 0, "
strSQL =strSQL +"blogtj int NULL default 0, "
strSQL =strSQL +"bloghtmfile text(80) Null , "
strSQL =strSQL +"blognum int NULL default 0, "
strSQL =strSQL +"blogtag text(200) , "
strSQL =strSQL +"plqs int NULL default 0, "
strSQL =strSQL +"sign int NULL default 0, "
strSQL =strSQL +"cssfile text(50) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftblog_pl ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"netname text(30) Null , " 
strSQL =strSQL +"pltitle text(50) Null , " 
strSQL =strSQL +"plcontent text NULL , " 
strSQL =strSQL +"blogid int NULL , " 
strSQL =strSQL +"userid int NULL , " 
strSQL =strSQL +"sign int NULL default 0, " 
strSQL =strSQL +"userip text(30) Null , " 
strSQL =strSQL +"pldate datetime NULL default now(), " 
strSQL =strSQL +"plqs int NULL default 0, "
strSQL =strSQL +"pltype int NULL default 0, "
strSQL =strSQL +"plnum int NULL default 0" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"ftblog_type ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"userid int NULL , " 
strSQL =strSQL +"blogtype text(50) Null default 0, " 
strSQL =strSQL +"sign int NULL default 0, " 
strSQL =strSQL +"indate datetime NULL default now(), " 
strSQL =strSQL +"qs int NULL default 0, " 
strSQL =strSQL +"userip text(20) Null , " 
strSQL =strSQL +"totalnum int NULL default 0, " 
strSQL =strSQL +"blogphoto int NULL default 0, " 
strSQL =strSQL +"alumpwd text(50) Null " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"haoyou ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"userid int NULL , " 
strSQL =strSQL +"haoyouname text(10) Null , " 
strSQL =strSQL +"groupname text(20) Null , " 
strSQL =strSQL +"sign int NULL default 0, " 
strSQL =strSQL +"addtime datetime NULL default now() " 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"links ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"ftbbs_class text(2) Null , " 
strSQL =strSQL +"ftbbs_name text(50) Null , " 
strSQL =strSQL +"ftbbs_url text(100) Null , " 
strSQL =strSQL +"ftbbs_logo text(100) Null , " 
strSQL =strSQL +"ftbbs_qq text(50) Null , "
strSQL =strSQL +"ftbbs_mail text(50) Null , "
strSQL =strSQL +"ftbbs_zhu text NULL , "
strSQL =strSQL +"ftbbs_time datetime NULL default now(), "
strSQL =strSQL +"ftbbs_pass text(1) Null default N" 
strSQL =strSQL +") " 
Conn.Execute(strSQL) 

strSQL ="CREATE TABLE "&ft&"sms ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"title text(150) Null , " 
strSQL =strSQL +"content text NULL , " 
strSQL =strSQL +"sender text(20) Null , " 
strSQL =strSQL +"accepter text(20) Null , " 
strSQL =strSQL +"indate datetime NULL default now(), "
strSQL =strSQL +"replysign int NULL default 0, "
strSQL =strSQL +"display int NULL default 0, "
strSQL =strSQL +"bbssystem int NULL default 0, "
strSQL =strSQL +"IsNew int NULL default 0" 
strSQL =strSQL +") " 
Conn.Execute(strSQL)

strSQL ="CREATE TABLE "&ft&"xunzhang ( " 
strSQL =strSQL +"id autoincrement PRIMARY KEY , " 
strSQL =strSQL +"xzms text(50) Null , " 
strSQL =strSQL +"xzimg text(20) Null , " 
strSQL =strSQL +"flag int NULL default 0" 
strSQL =strSQL +") " 
Conn.Execute(strSQL)

strSQL="insert into "&ft&"ftbbs_admin (admin_user, admin_pwd, lasttime, qs, adminqs) VALUES ('"&adminuser&"', '"&adminpwd&"', '"&now()&"', 2, '1, 2, 3')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(0,50,'小野人','userheadimg/class8.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(50,150,'野人','userheadimg/class9.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(150,500,'土人','userheadimg/class10.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(500,1000,'咕噜','userheadimg/class11.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(1000,2000,'大咕噜','userheadimg/class12.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(2000,4000,'咕噜队长','userheadimg/class13.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(4000,8000,'初级守卫','userheadimg/class14.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(8000,12000,'守卫队长','userheadimg/class15.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(12000,16000,'骑士','userheadimg/class16.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(16000,18000,'青铜骑士','userheadimg/class17.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(18000,20000,'白银骑士','userheadimg/class18.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(20000,22000,'黄金骑士','userheadimg/class19.gif')"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"ftbbs_touxian(xiao,da,nick,classx) values(22000,800000,'神秘头衔','userheadimg/class20.gif')"
Conn.Execute(strSQL)

strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('灌水天才奖', 'xz1.gif', 0)"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('特殊贡献奖', 'xz2.gif', 0)"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('优秀版主奖', 'xz3.gif', 0)"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('新人进步奖', 'xz4.gif', 0)"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('终身成就奖', 'xz5.gif', 0)"
Conn.Execute(strSQL)
strSQL="insert into "&ft&"xunzhang (xzms, xzimg, flag) VALUES ('宣传大使奖', 'xz6.gif', 0)"
Conn.Execute(strSQL)

filename = "config.asp"
function FSOFileRead(filename)
Dim objFSO,objCountFile,FiletempData
Set objFSO = Server.CreateObject("Scripting.FileSystemObject")
Set objCountFile = objFSO.OpenTextFile(Server.MapPath(filename),1,True)
FSOFileRead = objCountFile.ReadAll
objCountFile.Close
Set objCountFile=Nothing
Set objFSO = Nothing
End Function
Function RegExReplace(content,patrn,str)
	Dim regEx
	Set regEx = New RegExp
		regEx.IgnoreCase = True
		regEx.Global = True
	regEx.Pattern = patrn
	RegExReplace = regEx.Replace(content,str)
End Function
FileNL=FSOFileRead(filename)
'FileNL=RegExReplace(FileNL,"server=.*?;","server="&dbhost&";")
'FileNL=RegExReplace(FileNL,"uid=.*?;","uid="&dbuser&";")
'FileNL=RegExReplace(FileNL,"pwd=.*?;","pwd="&dbpw&";")
'FileNL=RegExReplace(FileNL,"database=.*?;","database="&dbname&";")
FileNL=RegExReplace(FileNL,"linkdb=.*? ","linkdb=1 ")
FileNL=RegExReplace(FileNL,"ft=.*? ","ft="""&ft&""" ")
FileNL=RegExReplace(FileNL,"ku=.*? ","ku="""&db&""" ")
FileNL=RegExReplace(FileNL,"ckiesdomain=.*? ","ckiesdomain="""&cookdm&""" ")

myFile = Server.MapPath(filename)
Const ForReading = 1
Const Forwriting = 2
Const ForAppending = 8
Set fileStreamObj = CreateObject("Scripting.FileSystemObject")
fileStreamObj.CreateTextFile(myFile)
set textStream = fileStreamObj.OpenTextFile(myFile,ForWriting,False)
textStream.Write(FileNL)
textStream.Close()

myFile = Server.MapPath("install/install.lock")
Set fileStreamObj = CreateObject("Scripting.FileSystemObject")
fileStreamObj.CreateTextFile(myFile)
set textStream = fileStreamObj.OpenTextFile(myFile,ForWriting,False)
textStream.Write("")
textStream.Close()

filename = "install/postmb.htm"
postmbstr=FSOFileRead(filename)
filename = "install/repostmb.htm"
repostmbstr=FSOFileRead(filename)
filename = "install/repostform.htm"
repostformmbstr=FSOFileRead(filename)
filename = "install/postpollmb.htm"
postpollmbstr=FSOFileRead(filename)
filename = "install/ftbbstreemb.htm"
treembstr=FSOFileRead(filename)
filename = "install/headmb.htm"
headmbstr=FSOFileRead(filename)

sitenav="<div id=""TopNav"">"& vbCrLf
sitenav=sitenav&"<div>"& vbCrLf
sitenav=sitenav&"<a href=""http://www.seoroom.cn"">官方动态</a>"& vbCrLf
sitenav=sitenav&"・<a href=""http://seoroom.cn/aspcms/albumtlist/list-36-1.html"">客户案例</a>"& vbCrLf
sitenav=sitenav&"・<a href=""http://seoroom.cn/aspcms/about/about-37.html"">定制服务</a>"& vbCrLf
sitenav=sitenav&"・<a href=""http://seoroom.cn/aspcms/productlist/list-28-1.html"">空间租用</a>"& vbCrLf
sitenav=sitenav&"・<a href=""http://seoroom.cn/gbook/?18_1.html"">在线留言</a>"& vbCrLf
sitenav=sitenav&"・<a href=""#"" onclick=""this.style.behavior='url(#default#homepage)';this.setHomePage('http://www.seoroom.cn');return false;"" >设为首页</a></div>"& vbCrLf
sitenav=sitenav&"</div>"

strSQL="insert into "&ft&"ftbbsmb(postpgnum,repostpgnum,folder,treemb,bbs_domain,bbs_name,upload_type,upload_size,ft_ver,regsmstitle,regsmscontent,usernamelng,pswlng,htm_ext,adminfile,returnurl) values(30,10,'M','"&treemb&"','http://www.seoroom.cn/','love1度论坛','jpg|gif|rar','204800','FTBBS V7.2','恭喜你,注册成功!','欢迎您加入本站点参加交流和讨论','3-10','3-10','.htm','admin.asp','notify_handler.asp')"
Conn.Execute(strSQL)

set rs=server.createobject("adodb.recordset")
sql="select * from "&ft&"ftbbsmb where id=1"
rs.open sql,conn,1,3
rs("postmb")=postmbstr
rs("repostmb")=repostmbstr
rs("repostformmb")=repostformmbstr
rs("postpollmb")=postpollmbstr
rs("treemb")=treembstr
rs("headmb")=headmbstr
rs("bakoff")=1
rs("postbegintime")="0"
rs("postendtime")="0"
rs("repostbegintime")="0"
rs("repostendtime")="0"
rs("sitenav")=sitenav
rs.update
rs.close
conn.close
'清空cookies值
if cookdm<>"" then
Response.Cookies("bbsuser").Domain=""
Response.Cookies("name").Domain=""
Response.Cookies("bz").Domain=""
Response.Cookies("bbsadmin").Domain=""
Response.Cookies("payuser").Domain=""
Response.Cookies("clubuser_password").Domain=""
Response.Cookies("clubuser_id").Domain=""
Response.Cookies("bokeer").Domain=""
'Response.Cookies("STYLESHOW").Domain=0
else
Response.Cookies("bbsuser")=""
Response.Cookies("name")=""
Response.Cookies("bz")=""
Response.Cookies("bbsadmin")=""
Response.Cookies("payuser")=""
Response.Cookies("clubuser_password")=""
Response.Cookies("clubuser_id")=""
Response.Cookies("bokeer")=""
'Response.Cookies("STYLESHOW")=0
end if
'清空缓存
Application.Contents.removeall
 %>
 <script type="text/javascript">document.getElementById("notice").value = '数据表创建完成'; </script>
<script type="text/javascript">document.getElementById("laststep").disabled = false; </script>
<script type="text/javascript">document.getElementById("laststep").value = '恭喜您论坛安装成功,点击进入论坛首页'; </script>
   <%end if%>
<%
else
  If IsObjInstalled("Scripting.FileSystemObject") = False Then
      Response.Write "<tr><td><br><br><br><br><br><table width=""560"" cellspacing=""1"" bgcolor=""#000000"" border=""0"" align=""center"">"&_
	  "<tr bgcolor=""#085878""><td width=""20%"" style=""color: #FFFFFF; padding-left: 10px"">错误信息</td></tr><tr align=""center"" bgcolor=""#E3E3EA"">"&_
	  "<td class=""message"">系统检测到你的主机空间不支持Scripting.FileSystemObject组件,论坛安装无法继续。"&_
	  "</td></tr></table><br><br><br><br><br><br>"
  elseif IsObjInstalled("ADOX.Catalog") = False Then
      Response.Write "<tr><td><br><br><br><br><br><table width=""560"" cellspacing=""1"" bgcolor=""#000000"" border=""0"" align=""center"">"&_
	  "<tr bgcolor=""#085878""><td width=""20%"" style=""color: #FFFFFF; padding-left: 10px"">错误信息</td></tr><tr align=""center"" bgcolor=""#E3E3EA"">"&_
	  "<td class=""message"">系统检测到你的主机空间不支持ADOX创建数据库的组件,论坛安装无法继续。"&_
	  "</td></tr></table><br><br><br><br><br><br>"
  else
   Set fso = Server.CreateObject("Scripting.FileSystemObject")
   lockfile = Server.MapPath("install/install.lock")
   
   TestFile = Server.MapPath("test.htm")
   fso.CreateTextFile(TestFile)
   set textStream = fso.OpenTextFile(TestFile,ForWriting,False)
   textStream.Write("")
   textStream.Close()
   
   If fso.FileExists(TestFile) = False Then
      Response.Write "<tr><td><br><br><br><br><br><table width=""560"" cellspacing=""1"" bgcolor=""#000000"" border=""0"" align=""center"">"&_
	  "<tr bgcolor=""#085878""><td width=""20%"" style=""color: #FFFFFF; padding-left: 10px"">错误信息</td></tr><tr align=""center"" bgcolor=""#E3E3EA"">"&_
	  "<td class=""message"">系统检测到你的主机Scripting.FileSystemObject组件没有<font color=red>写入权限</font>即不能生成静态页面,请设置好主机空间的相关写入、修改权限后再安装,本次论坛安装无法继续。"&_
	  "</td></tr></table><br><br><br><br><br><br>"
   elseif fso.FileExists(lockfile) Then
      Response.Write "<tr><td><br><br><br><br><br><table width=""560"" cellspacing=""1"" bgcolor=""#000000"" border=""0"" align=""center"">"&_
	  "<tr bgcolor=""#085878""><td width=""20%"" style=""color: #FFFFFF; padding-left: 10px"">错误信息</td></tr><tr align=""center"" bgcolor=""#E3E3EA"">"&_
	  "<td class=""message"">您已经安装过论坛，为了保证论坛数据安全，请手动删除 setup.asp 文件 和 install 文件夹下的所有文件，如果您想重新安装论坛，请删除 install/install.lock 文件，再次运行安装文件。"&_
	  "</td></tr></table><br><br><br><br><br><br>"
   Else
     fso.DeleteFile(TestFile)
	 Set fso = nothing
%>
<tr><td><b>当前状态: </b><font color="#0000EE">FTBBS用户许可协议</font></td></tr>
<tr><td><hr noshade align="center" width="100%" size="1"></td></tr>
<tr><td><br>
<table width="90%" cellspacing="1" bgcolor="#000000" border="0" align="center">
<tr><td class="altbg1">
<table width="99%" cellspacing="1" border="0" align="center">
<tr><td><p class="subtitle">

<p>版权所有 &copy;-<%=year(now())%>-2020，零心一度保留所有LOVE1℃权利。

<p>感谢您选择 LOVE1℃论坛产品。希望我们的努力能为您提供一个高效快速和强大的社区论坛解决方案。

<p>LOVE1℃英文全称为 LOVE1℃ Board，中文全称为 LOVE1℃论坛，以下简称 LOVE1℃。

                        <p>陈惠添为LOVE1℃的开发者，依法独立拥有LOVE1℃著作权。
 <p>LOVE1℃ 著作权受到法律和国际公约保护。使用者：无论个人或组织、盈利与否、用途如何 （包括以学习和研究为目的），均需仔细阅读本协议，在理解、同意、并遵守本协议的全部条款后，方可开始使用 
                          LOVE1℃。 
                        <p>本授权协议适用于零心一度所有版本，LOVE1℃论坛拥有对本授权协议的最终解释权。 
                        <ul type="I">
                          <p>
                          <li><b>协议许可的权利</b> 
                            <ul type="1">
                              <li>您可以在完全遵守本最终用户授权协议的基础上，将本软件应用于非商业用途，而不必支付软件版权授权费用。 
                              <li>您可以在协议规定的约束和限制范围内修改LOVE1℃源代码(如果被提供的话)或界面风格以适应您的网站要求。 
                              <li>您拥有使用本软件构建的论坛中全部会员资料、文章及相关信息的所有权，并独立承担与文章内容的相关法律义务。 
                              <li>获得商业授权之后，您可以将本软件应用于商业用途，同时依据所购买的授权类型中确定的技术支持期限、技术支持方式和技术支持内容， 
                                自购买时刻起，在技术支持期限内拥有通过指定的方式获得指定范围内的技术支持服务。商业授权用户享有反映和提出意见的权力，相关意见 
                                将被作为首要考虑，但没有一定被采纳的承诺或保证。 
                            </ul>
                            <p>
                          <li><b>有限担保和免责声明</b> 
                            <ul type="1">
                              <li>本软件及所附带的文件是作为不提供任何明确的或隐含的赔偿或担保的形式提供的。 
                              <li>用户出于自愿而使用本软件，您必须了解使用本软件的风险，在尚未购买产品技术服务之前，我们不承诺提供任何形式的技术支持、使用担保， 
                                也不承担任何因使用本软件而产生问题的相关责任。 
                              <li>love1度论坛官方不对使用本软件构建的论坛中的文章或信息承担责任。 
                            </ul>
                        </ul>

                        <p>有关LOVE1℃最终用户授权协议、商业授权与技术服务的详细内容，均由LOVE1℃独家提供。零心一度拥有在不 事先通知的情况下，修改授权协议和服务价目表的权力，修改后的协议或价目表对自改变之日起的新授权用户生效。 
                        <p>电子文本形式的授权协议如同双方书面签署的协议一样，具有完全的和等同的法律效力。您一旦开始安装LOVE1℃，即被视为完全理解并接受 
                          本协议的各项条款，在享有上述条款授予的权力的同时，受到相关的约束和限制。协议许可范围以外的行为，将直接违反本授权协议并构成侵权， 
                          我们有权随时终止授权，责令停止损害，并保留追究相关责任的权力。</td></tr>
</table></td></tr></table>
<tr><td align="center">
<br><form method="post" action="setup.asp">
<input type="hidden" name="action" value="config">
<input type="submit" name="submit" value="我同意" style="height: 25">&nbsp;
<input type="button" name="exit" value="我不同意" style="height: 25" onClick="javascript: window.close();">
</form></td></tr>
<%
   end if
  End If
end if
%>
<tr><td>
<!--#include file="install/bottom.asp" -->