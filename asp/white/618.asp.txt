<%
' ==============================================================
'论坛登陆
' ==============================================================
Sub Callbbs()
If W_BBsCataShowClose="True" Then
%>

<%
End If
End Sub
%>

<%
' ==============================================================
'网站调查投票
' ==============================================================
Sub WebsiteVote()
%>
<table width="180"  border="0" align="left" cellpadding="0" cellspacing="0">
          <tr>
            <td>
              <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="180" height="220">
                <param name="movie" value="../images/flashvote.swf">
                <param name="quality" value="high">
				<PARAM NAME=menu VALUE=false>
     <PARAM NAME=quality VALUE=best>
     <param name="wmode" value="transparent" />
                <embed src="../images/flashvote.swf" width="180" height="220" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" menu="false" wmode="transparent"></embed>
              </object></td>
          </tr>
</table>
<%
End Sub
%>

<%
' ==============================================================
'热门文章
' ==============================================================
Sub HotArticle()
%>
<table width="178"  border="0" align="center" cellpadding="0" cellspacing="0">

          <tr>
            <td height="33" ><table width="100%"  border="0" align="right" cellpadding="0" cellspacing="0">
                <tr>
                  <td align="left">
				  <table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td width="12%" height="14" align="center" valign="middle"><img src="image/l1.gif" width="12" height="13" /></td>
    <td width="40%" valign="middle" style="font-size:9pt;line-height:14px;"><strong>行业资讯</strong></td>
    <td width="48%" valign="middle" style="font-size:9pt;line-height:14px;"><img src="image/new.gif" width="23" height="11" /></td>
  </tr>
</table>

				  </td>
                </tr>
            </table></td>
          </tr>
<tr>
    <td height="3"  background="image/line3.gif"></td>
</tr>
          <tr>
            <td >
			<table width="100%"  border="0" cellspacing="0" cellpadding="0">
<%
Dim strParentPath,strParentPathw(),w
If ArtClassID="" Then
	ArtClassID=0
End If

If ArtClassID=0 Then
	sSql="Select Top "&W_TopArtRecoNum&" D_ID,D_Title,D_Count,D_ClassID,D_Recycle From NewsData Where D_Recycle=False Order By D_ID "
Else
	Dim ChildID
	sSql="Select ClassID,ClassName,ParentPath,Child From NewsClass Where ClassID="&ArtClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		if oRs("ClassID")>0 then
			if oRs("Child")>0 then
				ChildID=""
				set tClass=oConn.execute("select ClassID from NewsClass where ParentID=" & oRs("ClassID") & " or ParentPath like '" & oRs("ParentPath") & "," & oRs("ClassID") & ",%'")
				do while not tClass.eof
					if ChildID="" then
						ChildID=tClass(0)
					else
						ChildID=ChildID & "," & tClass(0)
					end if
					tClass.movenext
				loop
			else
				ChildID=ArtClassID
			end if
		end if
	End If
	oRs.Close
	sSql="Select Top "&W_TopArtRecoNum&" D_ID,D_Title,D_Count,D_ClassID,D_Recycle From NewsData Where d_classid in ("&ChildID&") and D_Recycle=False  Order By D_ID asc"
End If

oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>			  
			  
			  <tr>
                <td width="10" height="22px"><div align="center"><img src="../images/zw010.gif" width="4" height="4"></div></td>
                <td width="168"><a href="As<%=oRs("D_ID")%>.html" title="<%=oRs("D_Title")%>"><%=oRs("D_Title")%></a></td>
              </tr>		  
<%
	oRs.MoveNext
	Loop
Else
%>
			  <tr>
                <td width="10"><div align="center"><img src="../images/zw010.gif" width="4" height="4"></div></td>
                <td>暂无文章信息！</td>
              </tr>
<%
End If
oRs.Close
%>			  
			  
            </table><br /><br /><br />	</td>
          </tr>
</table>
	
<%
End Sub
%>



<%
' ==============================================================
'首页最新酷站
' ==============================================================
Sub HomeNewCoolSite()
If W_CoolSiteCataShowClose="True" Then
%>

<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>最新酷站</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif">
<%
Dim CoolNum
sSql="Select Top "&W_HomeCoolSiteRecoNum&" C_ID,C_SiteName,C_SitePicS,C_SiteCount,C_SiteClass From CoolSiteData Where C_Recycle=False Order By C_ID Desc"
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>		  
		  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
<%
	Do While Not oRs.Eof
		Response.Write "<tr>"
		For CoolNum =0 to 1
%>
              <td width="50%">
			  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td><div align="center"><a href="CoolSiteShow.asp?CoolSiteID=<%=oRs("C_ID")%>" target="_blank"><img src="<%=oRs("C_SitePicS")%>" alt="酷站名称：<%=oRs("C_SiteName")&vbcrlf%>点击次数：<%=oRs("C_SiteCount")%>次" width="100" height="100" border="0"></a></div></td>
                </tr>
                <tr>
                  <td><div align="center"><a href="CoolSiteShow.asp?CoolSiteID=<%=oRs("C_ID")%>" title="酷站名称：<%=oRs("C_SiteName")&vbcrlf%>点击次数：<%=oRs("C_SiteCount")%>次" target="_blank"><%=oRs("C_SiteName")%></a></div></td>
                </tr>
              </table>
			  </td>
<%
			oRs.MoveNext
			If oRs.Eof then
				If CoolNum = 0 Then
					Response.Write "<td width='50%'>&nbsp;</td>"
				End if
				Exit For
			End If
		Next
	Response.Write "</tr>"
	Loop
%>
          </table>
<%
Else
	Response.Write "　暂无酷站信息！"
End If
oRs.Close
%>		  
		  </td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End If
End Sub
%>


<%
' ==============================================================
'热门酷站
' ==============================================================
Sub CallCoolSite()
If W_CoolSiteCataShowClose="True" Then
%>

<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>热门酷站</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif">
<%
Dim CoolNum
If CoolSiteClassID="" Then
	CoolSiteClassID=0
End If

If CoolSiteClassID=0 Then
	sSql="Select Top "&W_TopCoolSiteRecoNum&" C_ID,C_SiteName,C_SitePicS,C_SiteCount,C_SiteClass From CoolSiteData Where C_Recycle=False And C_SiteCount<>0 Order By C_SiteCount Desc,C_ID Desc"
Else
	Dim ChildID
	ChildID=""
	Set oRs=oConn.Execute("Select ClassID,ParentID From CoolSiteClass Where ClassID="&CoolSiteClassID)
	If Not oRs.Eof Then
		If oRs("ParentID")=0 Then
			Set zRs=oConn.Execute("Select ClassID,ParentID From CoolSiteClass Where ParentID="&oRs("ClassID"))
			If Not zRs.Eof Then
				Do While Not zRs.Eof
					If ChildID="" Then
						ChildID=zRs("ClassID")
					Else
						ChildID=ChildID & "," & zRs("ClassID")
					End If
				zRs.MoveNext
				Loop
			Else
				ChildID=oRs("ClassID")
			End If
		zRs.Close
		Else
			ChildID=oRs("ClassID")
		End If
	End If
	oRs.Close
	'Response.Write ChildID
	'Response.End
	sSql="Select Top "&W_TopCoolSiteRecoNum&" C_ID,C_SiteName,C_SitePicS,C_SiteCount,C_SiteClass From CoolSiteData Where C_SiteClass in ("&ChildID&") And C_Recycle=False And C_SiteCount<>0 Order By C_SiteCount Desc,C_ID Desc"
End If
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>		  
		  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
<%
	Do While Not oRs.Eof
		Response.Write "<tr>"
		For CoolNum =0 to 1
%>
              <td width="50%">
			  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td><div align="center"><a href="CoolSiteShow.asp?CoolSiteID=<%=oRs("C_ID")%>" target="_blank"><img src="<%=oRs("C_SitePicS")%>" alt="酷站名称：<%=oRs("C_SiteName")&vbcrlf%>点击次数：<%=oRs("C_SiteCount")%>次" width="100" height="100" border="0"></a></div></td>
                </tr>
                <tr>
                  <td><div align="center"><a href="CoolSiteShow.asp?CoolSiteID=<%=oRs("C_ID")%>" title="酷站名称：<%=oRs("C_SiteName")&vbcrlf%>点击次数：<%=oRs("C_SiteCount")%>次" target="_blank"><%=oRs("C_SiteName")%></a></div></td>
                </tr>
              </table>
			  </td>
<%
			oRs.MoveNext
			If oRs.Eof then
				If CoolNum = 0 Then
					Response.Write "<td width='50%'>&nbsp;</td>"
				End if
				Exit For
			End If
		Next
	Response.Write "</tr>"
	Loop
%>
          </table>
<%
Else
	Response.Write "　暂无酷站信息！"
End If
oRs.Close
%>		  
		  </td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End If
End Sub
%>

<%
' ==============================================================
'文章栏目侧导航
' ==============================================================
Sub ArticleClass()
Dim zRs
If ArtClassID="" Then
	ArtClassID=0
End If
If IsNumeric(ArtClassID) = False Then
	GoError "文章分类ID参数错误，请不要试图破坏此系统。"
End If

If ArtClassID<>0 Then
Set oRs=oConn.Execute("Select ParentID From NewsClass Where ClassID="&ArtClassID)
ArtParentID=oRs("ParentID")
oRs.Close
End If

sSql="Select ClassID,ClassName,Child From NewsClass Where ParentID="&ArtClassID
oRs.Open sSql,oConn,1,1

%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><img src="../images/zw000.gif" width="1" height="8"></td>
  </tr>
  <tr>
    <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
        <tr>
          <td><strong>栏目导航</strong></td>
        </tr>
    </table></td>
  </tr>
            <tr>
              <td background="../images/zw008.gif"><table width="165" border="0" align="center" cellpadding="3" cellspacing="0">
				
<%
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="Article.asp?ArtClassID=<%=oRs("ClassID")%>"><%=oRs("ClassName")%></a></td>
                </tr>
<%
	oRs.MoveNext
	Loop
ElseIf ArtClassID<>0 Then
	Set zRs=oConn.Execute("Select ClassID,ClassName From NewsClass Where ParentID="&ArtParentID)
	If Not zRs.Eof Then
		Do While Not zRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="Article.asp?ArtClassID=<%=zRs("ClassID")%>"><%=zRs("ClassName")%></a></td>
                </tr>
<%
		zRs.MoveNext
		Loop
	End If
	zRs.Close
End If
%>
              </table></td>
            </tr>
            <tr>
              <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
            </tr>
</table>
<%
oRs.Close
End Sub
%>



<%
' ==============================================================
'文章横向导航提示
' ==============================================================
Sub HoriNavi()
Response.Write "  <a href='/index.html'>首页</a>"
If ArtClassID<>0 Then
	dim zClassID,zClassName,zParentPath,ParentPath1
	sSql="Select ClassID,ClassName,ParentPath From NewsClass Where ClassID="&ArtClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		zClassID=oRs("ClassID")
		zParentPath=oRs("ParentPath")
		zClassName=oRs("ClassName")
	End If
	oRs.Close
	If zParentPath<>0 Then
		zParentPath=Replace(zParentPath,"0,","")
		sSql="Select ClassID,ClassName,ParentPath From NewsClass Where ClassID in ("&zParentPath&")"
		oRs.Open sSql,oConn,1,1
		Do While Not oRs.Eof
			Response.Write " -&gt;&gt; <a href='A"&oRs("ClassID")&".html'>"&oRs("ClassName")&"</a>"
			oRs.MoveNext
		Loop
		oRs.Close
	End If
	Response.Write " -&gt;&gt; <a href='A"&zClassID&".html'>"&zClassName&"</a>"
End If

End Sub
%>


<%
'站内搜索
Sub CallSearch()
%>
<Script Language=JavaScript>
function doSubmit(){
	if (document.SearchForm.SearchKey.value==""){
		alert("搜索关键字能为空！");
		return false;
	}
}
</Script>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
          <tr>
            <td><img src="../images/zw000.gif" width="1" height="8"></td>
          </tr>
          <tr>
            <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>站内搜索</strong></td>
              </tr>
            </table></td>
          </tr>
          <tr>
            <td background="../images/zw008.gif">
              <table width="100%"  border="0" cellspacing="0" cellpadding="5">
                <form name="SearchForm" method="post" action="Search.asp" onsubmit="return doSubmit()"><tr>
                  <td width="60">关键字：</td>
                  <td><input name="SearchKey" type="text" class="input_text" id="username"></td>
                </tr>
                <tr>
                  <td width="60">类　型：</td>
                  <td><select name="SearchType">
                    <option selected value="Article">文章</option>
					<%If W_DownCataShowClose="True" Then%>
                    <option value="Software">软件</option>
                    <%End If%>
                  </select></td>
                </tr>
                <tr>
                  <td colspan="2"><div align="center">
                        <input type="submit" name="Submit" value=" 提 交 " class="input_submit">　　　
                        <input type="reset" name="Submit" value=" 重 填 " class="input_submit">
                  </div></td>
                  </tr></form>
              </table>              </td>
          </tr>
          <tr>
            <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
          </tr>
</table>
<%
End Sub
%>

<%
' ==============================================================
'酷站横向导航提示
' ==============================================================
Sub CoolSiteNavi()

Response.Write " -&gt;&gt; <a href='CoolSite.asp'>"&W_CoolSiteCataName&"</a>"
If CoolSiteClassID<>0 Then
	dim zClassID,zClassName,zParentPath,ParentPath1
	sSql="Select ClassID,ClassName,ParentPath From CoolSiteClass Where ClassID="&CoolSiteClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		zClassID=oRs("ClassID")
		zParentPath=oRs("ParentPath")
		zClassName=oRs("ClassName")
	End If
	oRs.Close
	If zParentPath<>0 Then
		zParentPath=Replace(zParentPath,"0,","")
		sSql="Select ClassID,ClassName,ParentPath From CoolSiteClass Where ClassID in ("&zParentPath&")"
		oRs.Open sSql,oConn,1,1
		Do While Not oRs.Eof
			Response.Write " -&gt;&gt; <a href='CoolSite.asp?CoolSiteClassID="&oRs("ClassID")&"'>"&oRs("ClassName")&"</a>"
			oRs.MoveNext
		Loop
		oRs.Close
	End If
	Response.Write " -&gt;&gt; <a href='CoolSite.asp?CoolSiteClassID="&zClassID&"'>"&zClassName&"</a>"
End If

End Sub
%>

<%
' ==============================================================
'酷站栏目侧导航
' ==============================================================
Sub CoolSiteClass()

Dim zRs,CoolSiteParentID
If CoolSiteClassID="" Then
	CoolSiteClassID=0
End If
If IsNumeric(CoolSiteClassID) = False Then
	GoError "酷站分类ID参数错误，请不要试图破坏此系统。"
End If

If CoolSiteClassID<>0 Then
Set oRs=oConn.Execute("Select ParentID From CoolSiteClass Where ClassID="&CoolSiteClassID)
	CoolSiteParentID=oRs("ParentID")
	oRs.Close
End If

sSql="Select ClassID,ClassName,Child From CoolSiteClass Where ParentID="&CoolSiteClassID&" Order By RootID,OrderID"
oRs.Open sSql,oConn,1,1

%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><img src="../images/zw000.gif" width="1" height="8"></td>
  </tr>
  <tr>
    <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
        <tr>
          <td><strong>栏目导航</strong></td>
        </tr>
    </table></td>
  </tr>
            <tr>
              <td background="../images/zw008.gif"><table width="165" border="0" align="center" cellpadding="3" cellspacing="0">
				
<%
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="CoolSite.asp?CoolSiteClassID=<%=oRs("ClassID")%>"><%=oRs("ClassName")%></a></td>
                </tr>
<%
	oRs.MoveNext
	Loop
ElseIf CoolSiteClassID<>0 Then
	Set zRs=oConn.Execute("Select ClassID,ClassName From CoolSiteClass Where ParentID="&CoolSiteParentID&" Order By RootID,OrderID")
	If Not zRs.Eof Then
		Do While Not zRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="CoolSite.asp?CoolSiteClassID=<%=zRs("ClassID")%>"><%=zRs("ClassName")%></a></td>
                </tr>
<%
		zRs.MoveNext
		Loop
	End If
	zRs.Close
End If
%>
              </table></td>
            </tr>
            <tr>
              <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
            </tr>
</table>
<%
oRs.Close
End Sub
%>


<%
' ==============================================================
'合作站点
' ==============================================================
Sub CoopSite()
%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>合作网站</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif"><table width="200" border="0" align="center" cellpadding="0" cellspacing="0">
            <tr>
              <td>

<%
sSql="Select F_ID,F_SiteName,F_SiteAdd,F_SiteLogo From FriendLink Where F_LinkType=3 And F_Recycle=True And F_ExamMark=True Order By F_AddTime Desc"
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>
<table border="0" cellpadding="3" cellspacing="0">
<%
Do While Not oRs.Eof
	Response.Write "<tr>"
	For i =0 To 1

%>	
	  
        <td width=100><div align="center"><a href="<%=oRs("F_SiteAdd")%>" target="_blank"><img src="<%=oRs("F_SiteLogo")%>" width=88 height=31 alt="<%=oRs("F_SiteName")%>" border="0"></a></div></td>
<%
		oRs.MoveNext
		If oRs.Eof Then
			If i = 0 Then
				Response.Write "<td></td></tr>"
			End If
			Exit For
		End If
	Next
	Response.Write "</tr>"
loop
%>
</table>
<%
End If
oRs.Close
%>		  
			  
			  </td>
            </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End Sub
%>


<%
' ==============================================================
'站内统计
' ==============================================================
Sub SiteCount()
%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>站内统计</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif"><table width="95%"  border="0" align="center" cellpadding="0" cellspacing="0">
            <tr>
              <td width="80">现共有文章：</td>
              <td>
			  <%
			  sSql="Select D_ID From NewsData Where D_Recycle=False"
			  oRs.Open sSql,oConn,1,1
			  If Not oRs.Eof Then
			  	Response.Write "<font color='#ff0000'>"&oRs.recordcount&"</font> 篇"
			  Else
			  	Response.Write "暂无文章"
			  End If
			  oRs.Close
			  %>
			  </td>
            </tr>
			<%
			If W_CoolSiteCataShowClose="True" Then
			%>
            <tr>
              <td width="80">现共有酷站： </td>
              <td>			  <%
			  sSql="Select C_ID From CoolSiteData Where C_Recycle=False"
			  oRs.Open sSql,oConn,1,1
			  If Not oRs.Eof Then
			  	Response.Write "<font color='#ff0000'>"&oRs.recordcount&"</font> 个"
			  Else
			  	Response.Write "暂无酷站"
			  End If
			  oRs.Close
			  %></td>
            </tr>
			<%
			End If
			If W_DownCataShowClose="True" Then
			%>
            <tr>
              <td>现共有软件：</td>
              <td><%
			  sSql="Select S_ID From SoftData Where S_Recycle=False"
			  oRs.Open sSql,oConn,1,1
			  If Not oRs.Eof Then
			  	Response.Write "<font color='#ff0000'>"&oRs.recordcount&"</font> 个"
			  Else
			  	Response.Write "暂无软件"
			  End If
			  oRs.Close
			  %></td>
            </tr>
			<%
			End If
			If W_PicCataShowClose="True" Then
			%>
            <tr>
              <td>现共有图片：</td>
              <td><%
			  sSql="Select P_ID From PictureData Where P_Recycle=False"
			  oRs.Open sSql,oConn,1,1
			  If Not oRs.Eof Then
			  	Response.Write "<font color='#ff0000'>"&oRs.recordcount&"</font> 个"
			  Else
			  	Response.Write "暂无图片"
			  End If
			  oRs.Close
			  %></td>
            </tr>
			<%
			End If
			%>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End Sub
%>

<%
' ==============================================================
'友情链接添加
' ==============================================================
Sub FriendLinkAppl()
%>
<Script Language=JavaScript>
function doSubmitFriendLinkAppl(){
	if (document.FriendLinkAppl.SiteName.value==""){
		alert("网站名称不能为空！");
		return false;
	}
	if (document.FriendLinkAppl.SiteAdd.value==""){
		alert("网站地址不能为空！");
		return false;
	}
	if (document.FriendLinkAppl.LinkType.value==1){
		if (document.FriendLinkAppl.SiteLogo.value==""){
			alert("网站LOGO不能为空！");
			return false;
		}
	}
	if (document.FriendLinkAppl.LinkType.value==3){
		if (document.FriendLinkAppl.SiteLogo.value==""){
			alert("网站LOGO不能为空！");
			return false;
		}
	}}
</Script>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>链接申请</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif">
          
            <table width="95%"  border="0" align="center" cellpadding="3" cellspacing="0">
            <form name="FriendLinkAppl" method="post" action="FriendLink.asp" onsubmit="return doSubmitFriendLinkAppl()"><tr>
              <td width="65">网站名称：</td>
              <td><input name="SiteName" type="text" class="input_text" id="SiteName" size="19"></td>
            </tr>
            <tr>
              <td width="65">网站地址：</td>
              <td><input name="SiteAdd" type="text" class="input_text" id="SiteAdd" size="19"></td>
            </tr>
            <tr>
              <td width="65">网站LOGO：</td>
              <td><input name="SiteLogo" type="text" class="input_text" id="SiteLogo" size="19"></td>
            </tr>
            <tr>
              <td width="65">链接类型：</td>
              <td><select name="LinkType" class="input_text" id="LinkType">
                <option value="1" selected>图标链接</option>
                <option value="2">文字链接</option>
                <option value="3">合作网站</option>
              </select></td>
            </tr>
            <tr>
              <td colspan="2"><div align="center">
                <input type="submit" name="Submit" value=" 提 交 " class="input_submit">
               　  
               <input type="reset" name="Submit" value=" 重 置 " class="input_submit">
</div></td>
              </tr>
            <tr>
              <td>本站LOGO：</td>
              <td><img src="<%=W_FrieLinkLogoUrl%>" width="88" height="31"></td>
            </tr>
            <tr>
              <td width="65">链接代码：</td>
              <td><textarea name="textarea" cols="20" class="input_text" rows="1"><%=W_FrieLinkCode%></textarea></td>
            </tr></form>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End Sub
%>

<%
' ==============================================================
'友情链接显示
' ==============================================================
Sub FriendLink()
Dim i
%>
<table width="1010"  border="0" cellspacing="0" cellpadding="0">
  <tr bgcolor="#FFFFFF">
    <td colspan="3"><img src="../images/zw000.gif" width="1" height="2"></td>
  </tr>
  <tr>
    <td width="50" height="26" background="../images/zw022.gif"><div align="center"><img src="../images/zw026.gif" width="10" height="11"></div></td>
    <td width="880" background="../images/zw022.gif"><strong>友情链接</strong></td>
    <td width="80" height="26" background="../images/zw022.gif"><a href="#"><img src="../images/zw021.gif" alt="更多" width="34" height="11" border="0"></a></td>
  </tr>
  <tr>
    <td colspan="3" background="../images/zw023.gif"><img src="../images/zw000.gif" width="1" height="10"></td>
  </tr>
  <tr>
    <td colspan="3" background="../images/zw024.gif"><table width="1000" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td>
<%
sSql="Select Top 20 F_ID,F_SiteName,F_SiteAdd,F_SiteLogo From FriendLink Where F_LinkType=1 And F_Recycle=True And F_ExamMark=True Order By F_AddTime Desc"
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>
<table border="0" cellpadding="3" cellspacing="0">
<%
Do While Not oRs.Eof
	Response.Write "<tr>"
	For i =0 To 9

%>	
	  
        <td width=100><div align="center"><a href="<%=oRs("F_SiteAdd")%>" target="_blank"><img src="<%=oRs("F_SiteLogo")%>" width=88 height=31 alt="<%=oRs("F_SiteName")%>" border="0"></a></div></td>
<%
		oRs.MoveNext
		If oRs.Eof Then
			If i = 9 Then
				Response.Write "<td></td></tr>"
			End If
			Exit For
		End If
	Next
	Response.Write "</tr>"
loop
'Else
%>
</table>
<%
End If
oRs.Close
%>		
    </td>
  </tr>

<%
sSql="Select Top 20 F_ID,F_SiteName,F_SiteAdd,F_SiteLogo From FriendLink Where F_LinkType=2 And F_Recycle=True And F_ExamMark=True Order By F_AddTime Desc"
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>
  <tr>
    <td><img src="../images/zw000.gif" width="1" height="5"></td>
  </tr>
  <tr>
    <td>
<table border="0" cellpadding="0" cellspacing="0">
<%
Do While Not oRs.Eof
	Response.Write "<tr>"
	For i =0 To 9

%>	
	  
        <td width=100><div align="center"><a href="<%=oRs("F_SiteAdd")%>" target="_blank" title="<%=oRs("F_SiteName")%>"><%=oRs("F_SiteName")%></a></div></td>
<%
		oRs.MoveNext
		If oRs.Eof Then
			If i = 9 Then
				Response.Write "<td></td></tr>"
			End If
			Exit For
		End If
	Next
	Response.Write "</tr>"
loop
%>
</table>
</td>
  </tr>
<%
End If
oRs.Close
%>		
    
</table>
</td>
  </tr>
  <tr>
    <td colspan="3" background="../images/zw025.gif"><img src="../images/zw000.gif" width="1" height="11"></td>
  </tr>
</table>
<%
End Sub
%>

<%
Sub search163()
%>
<table width="100%"  border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td><img src="../images/zw000.gif" width="5" height="1"></td>
          </tr>
          <tr>
            <td><img src="../images/zw000.gif" width="1" height="5"></td>
          </tr>
          <tr>
            <td><div align="center">
</div></td>
          </tr>
</table>
<%
End Sub
%>

<%
' ==============================================================
'下载专区栏目侧导航
' ==============================================================
Sub SoftDownClass()
Dim zRs
If SoftClassID="" Then
	SoftClassID=0
End If
If IsNumeric(SoftClassID) = False Then
	GoError "下载分类ID参数错误，请不要试图破坏此系统。"
End If

If SoftClassID<>0 Then
Set oRs=oConn.Execute("Select ParentID From SoftClass Where ClassID="&SoftClassID)
SoftParentID=oRs("ParentID")
oRs.Close
End If

sSql="Select ClassID,ClassName,Child From SoftClass Where ParentID="&SoftClassID&" Order By RootID,OrderID"
oRs.Open sSql,oConn,1,1

%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td><img src="../images/zw000.gif" width="1" height="8"></td>
  </tr>
  <tr>
    <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
        <tr>
          <td><strong>栏目导航</strong></td>
        </tr>
    </table></td>
  </tr>
            <tr>
          <td background="../images/zw008.gif"><table width="165" border="0" align="center" cellpadding="3" cellspacing="0">
				
<%
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="SoftDown.asp?SoftClassID=<%=oRs("ClassID")%>"><%=oRs("ClassName")%></a></td>
                </tr>
<%
	oRs.MoveNext
	Loop
ElseIf SoftClassID<>0 Then
	Set zRs=oConn.Execute("Select ClassID,ClassName From SoftClass Where ParentID="&SoftParentID&" Order By RootID,OrderID")
	If Not zRs.Eof Then
		Do While Not zRs.Eof
%>				
				<tr>
                  <td width="30"><div align="center"><img src="../images/zw012.gif" width="3" height="5"></div></td>
                  <td width="130"><a href="SoftDown.asp?SoftClassID=<%=zRs("ClassID")%>"><%=zRs("ClassName")%></a></td>
                </tr>
<%
		zRs.MoveNext
		Loop
	End If
	zRs.Close
End If
%>
              </table></td>
            </tr>
            <tr>
              <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
            </tr>
</table>
<%
oRs.Close
End Sub
%>
<%
' ==============================================================
'下载专区横向导航提示
' ==============================================================
Sub SoftDownNavi()
Response.Write " -&gt;&gt; <a href='SoftDown.asp?SoftClassID=0'>"&W_DownCataName&"</a>"
If SoftClassID<>0 Then
	dim zClassID,zClassName,zParentPath,ParentPath1
	sSql="Select ClassID,ClassName,ParentPath From SoftClass Where ClassID="&SoftClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		zClassID=oRs("ClassID")
		zParentPath=oRs("ParentPath")
		zClassName=oRs("ClassName")
	End If
	oRs.Close
	If zParentPath<>0 Then
		zParentPath=Replace(zParentPath,"0,","")
		sSql="Select ClassID,ClassName,ParentPath From SoftClass Where ClassID in ("&zParentPath&")"
		oRs.Open sSql,oConn,1,1
		Do While Not oRs.Eof
			Response.Write " -&gt;&gt; <a href='SoftDown.asp?SoftClassID="&oRs("ClassID")&"'>"&oRs("ClassName")&"</a>"
			oRs.MoveNext
		Loop
		oRs.Close
	End If
	Response.Write " -&gt;&gt; <a href='SoftDown.asp?SoftClassID="&zClassID&"'>"&zClassName&"</a>"
End If

End Sub
%>

<%
' ==============================================================
'热门下载
' ==============================================================
Sub HotSoftDown()
If W_DownCataShowClose="True" Then
%>
<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
          <tr>
            <td><img src="../images/zw000.gif" width="1" height="8"></td>
          </tr>
          <tr>
            <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
                <tr>
                  <td><strong>热门下载</strong></td>
                </tr>
            </table></td>
          </tr>
          <tr>
            <td background="../images/zw008.gif">
			<table width="100%"  border="0" cellspacing="0" cellpadding="3">
<%
Dim strParentPath,strParentPathw(),w
If SoftClassID="" Then
	SoftClassID=0
End If

If SoftClassID=0 Then
	sSql="Select Top "&W_TopSoftRecoNum&" S_ID,S_SoftName,S_SoftClassID,S_Recycle,S_SoftDownCount From SoftData Where S_Recycle=False And S_SoftDownCount<>0 Order By S_SoftDownCount Desc,S_ID Desc"
Else
	Dim ChildID
	sSql="Select ClassID,ClassName,ParentPath,Child From SoftClass Where ClassID="&SoftClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		if oRs("ClassID")>0 then
			if oRs("Child")>0 then
				ChildID=""
				set tClass=oConn.execute("select ClassID from SoftClass where ParentID=" & oRs("ClassID") & " or ParentPath like '" & oRs("ParentPath") & "," & oRs("ClassID") & ",%'")
				do while not tClass.eof
					if ChildID="" then
						ChildID=tClass(0)
					else
						ChildID=ChildID & "," & tClass(0)
					end if
					tClass.movenext
				loop
			else
				ChildID=SoftClassID
			end if
		end if
	End If
	oRs.Close
	
	sSql="Select Top "&W_TopSoftRecoNum&" S_ID,S_SoftName,S_SoftClassID,S_Recycle,S_SoftDownCount From SoftData Where S_SoftClassID in ("&ChildID&") And S_Recycle=False And S_SoftDownCount<>0 Order By S_SoftDownCount Desc,S_ID Desc"
End If

oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>			  
			  
			  <tr>
                <td width="10"><div align="center"><img src="../images/zw010.gif" width="4" height="4"></div></td>
                <td><a href="SoftDownShow.asp?SoftID=<%=oRs("S_ID")%>&SoftClassID=<%=oRs("S_SoftClassID")%>" title="软件名称：<%=oRs("S_SoftName")&vbcrlf%>下载次数：<%=oRs("S_SoftDownCount")%>次"><%=gotTopic(oRs("S_SoftName"),26)%></a></td>
              </tr>
			  
<%
	oRs.MoveNext
	Loop
Else
%>
			  <tr>
                <td width="10"><div align="center"><img src="../images/zw010.gif" width="4" height="4"></div></td>
                <td>暂无软件下载信息！</td>
              </tr>
<%
End If
oRs.Close
%>			  
			  
            </table></td>
          </tr>
          <tr>
            <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
          </tr>
</table>
		
<%
End If
End Sub
%>



<%
' ==============================================================
'首页最新图片
' ==============================================================
Sub HomeNewPic()
If W_PicCataShowClose="True" Then
%>

<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>最新藏品</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif">
<%
Dim PicNum
sSql="Select Top "&W_HomePicRecoNum&" P_ID,P_PictureName,P_PictureUrlS,P_PictureBrowseCount From PictureData Where P_Recycle=False Order By P_ID Desc"
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>		  
		  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
<%
	Do While Not oRs.Eof
		Response.Write "<tr>"
		For PicNum =0 to 1
%>
              <td width="50%">
			  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td><div align="center"><a href="PictureShow.asp?PicID=<%=oRs("P_ID")%>" target="_blank"><img src="<%=oRs("P_PictureUrlS")%>" alt="图片名称：<%=oRs("P_PictureName")&vbcrlf%>点击次数：<%=oRs("P_PictureBrowseCount")%>次" width="100" height="100" border="0"></a></div></td>
                </tr>
                <tr>
                  <td><div align="center"><a href="PictureShow.asp?PicID=<%=oRs("P_ID")%>" title="图片名称：<%=oRs("P_PictureName")&vbcrlf%>点击次数：<%=oRs("P_PictureBrowseCount")%>次" target="_blank"><%=oRs("P_PictureName")%></a></div></td>
                </tr>
              </table>
			  </td>
<%
			oRs.MoveNext
			If oRs.Eof then
				If PicNum = 0 Then
					Response.Write "<td width='50%'>&nbsp;</td>"
				End if
				Exit For
			End If
		Next
	Response.Write "</tr>"
	Loop
%>
          </table>
<%
Else
	Response.Write "　暂无图片信息！"
End If
oRs.Close
%>		  
		  </td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End If
End Sub
%>


<%
' ==============================================================
'热门图片
' ==============================================================
Sub HotPic()
If W_PicCataShowClose="True" Then
%>

<table width="212"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><img src="../images/zw000.gif" width="1" height="8"></td>
        </tr>
        <tr>
          <td height="29" background="../images/zw007.gif"><table width="80%"  border="0" align="right" cellpadding="0" cellspacing="0">
              <tr>
                <td><strong>热门藏品</strong></td>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td background="../images/zw008.gif">
<%
Dim PicNum
If PicClassID="" Then
	PicClassID=0
End If

If PicClassID=0 Then
	sSql="Select Top "&W_TopPicRecoNum&" P_ID,P_PictureName,P_PictureUrlS,P_PictureBrowseCount,P_PictureClassID From PictureData Where P_Recycle=False And P_PictureBrowseCount<>0 Order By P_PictureBrowseCount Desc,P_ID Desc"
Else
	Dim ChildID
	ChildID=""
	Set oRs=oConn.Execute("Select ClassID,ParentID From PictureClass Where ClassID="&PicClassID)
	If Not oRs.Eof Then
		If oRs("ParentID")=0 Then
			Set zRs=oConn.Execute("Select ClassID,ParentID From PictureClass Where ParentID="&oRs("ClassID"))
			If Not zRs.Eof Then
				Do While Not zRs.Eof
					If ChildID="" Then
						ChildID=zRs("ClassID")
					Else
						ChildID=ChildID & "," & zRs("ClassID")
					End If
				zRs.MoveNext
				Loop
			Else
				ChildID=oRs("ClassID")
			End If
		zRs.Close
		Else
			ChildID=oRs("ClassID")
		End If
	End If
	oRs.Close
	sSql="Select Top "&W_TopPicRecoNum&" P_ID,P_PictureName,P_PictureUrlS,P_PictureBrowseCount,P_PictureClassID From PictureData Where P_PictureClassID in ("&ChildID&") And P_Recycle=False And P_PictureBrowseCount<>0 Order By P_PictureBrowseCount Desc,P_ID Desc"
End If
oRs.Open sSql,oConn,1,1
If Not oRs.Eof Then
%>		  
		  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
<%
	Do While Not oRs.Eof
		Response.Write "<tr>"
		For PicNum =0 to 1
%>
              <td width="50%">
			  <table width="100%"  border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td><div align="center"><a href="PictureShow.asp?PicID=<%=oRs("P_ID")%>" target="_blank"><img src="<%=oRs("P_PictureUrlS")%>" alt="图片名称：<%=oRs("P_PictureName")&vbcrlf%>点击次数：<%=oRs("P_PictureBrowseCount")%>次" width="100" height="100" border="0"></a></div></td>
                </tr>
                <tr>
                  <td><div align="center"><a href="PictureShow.asp?PicID=<%=oRs("P_ID")%>" title="图片名称：<%=oRs("P_PictureName")&vbcrlf%>点击次数：<%=oRs("P_PictureBrowseCount")%>次" target="_blank"><%=oRs("P_PictureName")%></a></div></td>
                </tr>
              </table>
			  </td>
<%
			oRs.MoveNext
			If oRs.Eof then
				If PicNum = 0 Then
					Response.Write "<td width='50%'>&nbsp;</td>"
				End if
				Exit For
			End If
		Next
	Response.Write "</tr>"
	Loop
%>
          </table>
<%
Else
	Response.Write "　暂无图片信息！"
End If
oRs.Close
%>		  
		  </td>
        </tr>
        <tr>
          <td background="../images/zw009.gif"><img src="../images/zw000.gif" width="1" height="7"></td>
        </tr>
</table>
<%
End If
End Sub
%>


<%
' ==============================================================
'图片横向导航提示
' ==============================================================
Sub PicNavi()
Response.Write " <a href='Picture.asp'>"&W_PicCataName&"</a>"
If PicClassID<>0 Then
	dim zClassID,zClassName,zParentPath,ParentPath1
	sSql="Select ClassID,ClassName,ParentPath From PictureClass Where ClassID="&PicClassID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		zClassID=oRs("ClassID")
		zParentPath=oRs("ParentPath")
		zClassName=oRs("ClassName")
	End If
	oRs.Close
	If zParentPath<>0 Then
		zParentPath=Replace(zParentPath,"0,","")
		sSql="Select ClassID,ClassName,ParentPath From PictureClass Where ClassID in ("&zParentPath&")"
		oRs.Open sSql,oConn,1,1
		Do While Not oRs.Eof
			Response.Write " -&gt;&gt; <a href='P"&oRs("ClassID")&".html'>"&oRs("ClassName")&"</a>"
			oRs.MoveNext
		Loop
		oRs.Close
	End If
	Response.Write " -&gt;&gt; <a href='P"&zClassID&".html'>"&zClassName&"</a>"
End If

End Sub
%>

<%
' ==============================================================
'图片栏目侧导航
' ==============================================================
Sub PictureClass()
Dim zRs,PicParentID
If PicClassID="" Then
	PicClassID=0
End If
If IsNumeric(PicClassID) = False Then
	GoError "图片分类ID参数错误，请不要试图破坏此系统。"
End If

If PicClassID<>0 Then
Set oRs=oConn.Execute("Select ParentID From PictureClass Where ClassID="&PicClassID)
	PicParentID=oRs("ParentID")
	oRs.Close
End If

sSql="Select ClassID,ClassName,Child From PictureClass Where ParentID="&PicClassID&" Order By RootID,OrderID"
oRs.Open sSql,oConn,1,1

%>
<div style="padding-left:20px;background-image:url(/images/m_l.jpg);width:200px;height:25px;"><h1 style="height:22px;font-size:10pt;color:#69A5CE;line-height:22px;padding-top:2px;padding-right:0;padding-left:0;padding-bottom:0;margin:0"><a href="/pro1.htm" style="color:#69A5CE">网站建设案例及模板</a></h1></div>
<table width="220"  border="0" cellspacing="0" cellpadding="0" bgcolor="#D7E7EE">
<tr>
<td height="6">
</td>	
</tr>			
<%
If Not oRs.Eof Then
	Do While Not oRs.Eof
%>				
<tr>
                 
                 <td height=25 style="padding-left:20px;"><a href="picture.asp?PicClassID=<%=oRs("ClassID")%>"><%=oRs("ClassName")%></a></td>
                </tr>
			
<%
	oRs.MoveNext
	Loop
ElseIf PicClassID<>0 Then
	Set zRs=oConn.Execute("Select ClassID,ClassName From PictureClass Where ParentID="&PicParentID&" Order By RootID,OrderID")
	If Not zRs.Eof Then
		Do While Not zRs.Eof
%>				
			<tr>
                 
                  <td height=25 style="padding-left:20px;"><a href="picture.asp?PicClassID=<%=zRs("ClassID")%>"><%=zRs("ClassName")%></a></td>
                </tr>
<%
		zRs.MoveNext
		Loop
	End If
	zRs.Close
End If
%>
<tr>
<td height="6">
</td>	
</tr>
</table>
<%
oRs.Close
End Sub
%>

<%
' ==============================================================
'非系统频道横向导航提示
' ==============================================================
Sub ChaHoriNavi()
Response.Write " <a href='/index.html'>首页</a>"
If ChannelID<>0 Then
	dim zClassID,zClassName,zParentPath,ParentPath1
	sSql="Select ClassID,ClassName,ParentPath From OtherChannel Where ClassID="&ChannelID
	oRs.Open sSql,oConn,1,1
	If Not oRs.Eof Then
		zClassID=oRs("ClassID")
		zParentPath=oRs("ParentPath")
		zClassName=oRs("ClassName")
	End If
	oRs.Close
	If zParentPath<>0 Then
		zParentPath=Replace(zParentPath,"0,","")
		sSql="Select ClassID,ClassName,ParentPath From OtherChannel Where ClassID in ("&zParentPath&")"
		oRs.Open sSql,oConn,1,1
		Do While Not oRs.Eof
			Response.Write " -&gt;&gt; <a href='C"&oRs("ClassID")&".html'>"&oRs("ClassName")&"</a>"
			oRs.MoveNext
		Loop
		oRs.Close
	End If
	Response.Write " -&gt;&gt; <a href='C"&zClassID&".html'>"&zClassName&"</a>"
End If

End Sub
%>

<%
' ==============================================================
'非系统频道栏目侧导航
' ==============================================================
Sub ChaClass()
Dim zRs,ChaParentID
If ChannelID = "" Then
	ChannelID=1
End If

If ChannelID<>0 Then
	Set oRs=oConn.Execute("Select ParentID From OtherChannel Where ClassID=1")
	ChaParentID=oRs("ParentID")
	oRs.Close
	sSql="Select * From OtherChannel Where ParentID=1 order by pai,ClassID"
	oRs.Open sSql,oConn,1,1
%>
<div class="rbox">
<ul>		
<%
If Not oRs.Eof Then
	for p=1 to ors.recordcount
%>				
<%If oRs("ChannelType")=0 Then%>
<li><a href="<%if ors("url")<>"" then%><%=oRs("url")%><%else%>channel_<%=oRs("ClassID")%>.htm<%end if%>" ><%=oRs("ClassName")%></a></li><%ElseIf  oRs("ChannelType")=1 Then%>
<li><a href="<%=oRs("ChannelUrl")%>"><%=oRs("ClassName")%></a></li>
				  <%End If%>
<%
	oRs.MoveNext
	next
ElseIf ChannelID<>0 And ChaParentID<>0 Then
	Set zRs=oConn.Execute("Select ClassID,ClassName,ChannelType,ChannelUrl From OtherChannel Where ParentID="&ChaParentID)
	If Not zRs.Eof Then
		Do While Not zRs.Eof
%>				
<%If zRs("ChannelType")=0 Then%>
<li><a href="<%if zrs("url")<>"" then%><%=zRs("url")%><%else%>channel_<%=zRs("ClassID")%>.htm<%end if%>"><%=zRs("ClassName")%></a></li><%ElseIf  zRs("ChannelType")=1 Then%>
<li><a href="<%=zRs("ChannelUrl")%>"><%=zRs("ClassName")%></a></li> 
				  <%End If%>
<%
		zRs.MoveNext
		Loop
	End If
	zRs.Close
Else
		Set wRs=oConn.Execute("Select ClassID,ClassName,ChannelType,ChannelUrl From OtherChannel Where ClassID="&ChannelID)
		If Not wRs.Eof Then	
%>
<li><a href="<%if wrs("url")<>"" then%><%=wRs("url")%><%else%>channel_<%=wRs("ClassID")%>.htm<%end if%>"><%=wRs("ClassName")%></a></li> 
<%
		End If
		wRs.Close
End If
%>
</ul>
</div>
<%
End If
oRs.Close
End Sub
%>
<%
' ==============================================================
'非系统频道栏目侧导航
' ==============================================================
Sub ChaClass3()
Dim zRs,ChaParentID
If ChannelID<>0 Then
	Set oRs=oConn.Execute("Select ParentID From OtherChannel Where ClassID="&ChannelID)
	ChaParentID=oRs("ParentID")
	oRs.Close
	sSql="Select * From OtherChannel Where ParentID="&ChannelID&" order by pai,ClassID"
	oRs.Open sSql,oConn,1,1
%>	
<%
If Not oRs.Eof Then
for p=1 to ors.recordcount
%>				
<%If oRs("ChannelType")=0 Then%><li <%if int(ChannelID)=int(oRs("ClassID")) then %>class=currentpage<%end if%>><a href="<%if ors("url")<>"" then%><%=oRs("url")%><%else%>channel_<%=oRs("ClassID")%>.htm<%end if%>" <%if int(ChannelID)=int(oRs("ClassID")) then%>class="a9"<%end if%>><%=oRs("ClassName")%></a></li><%ElseIf  oRs("ChannelType")=1 Then%><li <%if int(ChannelID)=int(oRs("ClassID")) then %>class=currentpage<%end if%>><a href="<%=oRs("ChannelUrl")%>" <%if int(ChannelID)=int(oRs("ClassID")) then%>class="a9"<%end if%>><%=oRs("ClassName")%></a></li><%End If%><%
oRs.MoveNext
next
ElseIf ChannelID<>0 And ChaParentID<>0 Then
	Set zRs=oConn.Execute("Select * From OtherChannel Where ParentID="&ChaParentID&" order by pai,ClassID")
	If Not zRs.Eof Then
	Do While Not zRs.Eof
%>				
<%If zRs("ChannelType")=0 Then%><li <%if int(ChannelID)=int(zRs("ClassID")) then %>class=currentpage<%end if%>><a href="<%if zrs("url")<>"" then%><%=zRs("url")%><%else%>channel_<%=zRs("ClassID")%>.htm<%end if%>" <%if int(ChannelID)=int(zRs("ClassID")) then%>class="a9"<%end if%>><%=zRs("ClassName")%></a></li><%ElseIf  zRs("ChannelType")=1 Then%><li <%if int(ChannelID)=int(zRs("ClassID")) then %>class=currentpage<%end if%>><a href="<%=zRs("ChannelUrl")%>" <%if int(ChannelID)=int(zRs("ClassID")) then%>class="a9"<%end if%>><%=zRs("ClassName")%></a></li><%End If%>
<%
	zRs.MoveNext
	Loop
	End If
	zRs.Close
Else
Set wRs=oConn.Execute("Select * From OtherChannel Where ClassID="&ChannelID)
If Not wRs.Eof Then	
End If
wRs.Close
End If
End If
oRs.Close
End Sub
%>
<%
' ==============================================================
'非系统频道栏目侧导航
' ==============================================================
Sub ChaClass2()
%>
<div style="padding-left:20px;background-image:url(/images/m_l.jpg);width:200px;height:25px;"><h1 style="height:22px;font-size:10pt;color:#69A5CE;line-height:22px;padding-top:2px;padding-right:0;padding-left:0;padding-bottom:0;margin:0"><a href="/con_contact.asp" style="color:#69A5CE">联系新能力</a></h1></div>
<table width="220"  border="0" cellspacing="0" cellpadding="0" bgcolor="#D7E7EE">
<tr>
<td height="6">
</td>	
</tr>									
<tr>    
    <td height=25 style="padding-left:20px;"><a href="/abo_aboutus.asp" class="a6">关于我们</a></td>
</tr>
<tr>    
    <td height=25 style="padding-left:20px;"><a href="/news_1.htm" class="a6">新能力动态</a></td>
</tr>
<tr>    
    <td height=25 style="padding-left:20px;"><a href="/news_3.htm" class="a6">问题集锦</a></td>
</tr>
<tr>    
    <td height=25 style="padding-left:20px;"><a href="/feedback.asp" class="a6">在线留言</a></td>
</tr>
<tr>    
    <td height=25 style="padding-left:20px;"><a href="/con_contact.asp" class="a6">联系我们</a></td>
</tr>
<tr>
<td height="15">
</td>
</tr>
              </table>
<%
End Sub
%>
 
 <%
   '带时间的新闻列表
Function TopArticles_Time(ID,num)
	
	Set zRs1=Server.CreateObject("ADODB.Recordset")
	zSql="Select top "&num&" * From NewsData  where D_ClassID="&ID&" and d_recycle=false ORDER BY d_id DESC"
	zRs1.Open zSql,oConn,1,1
	if not zrs1.eof then
	for g=1 to zrs1.recordcount
	dadad=formatdatetime(zRs1("D_Time"),vbShortDate)
	t=len(formatdatetime(zRs1("D_Time"),vbShortDate))
	tt=int(t-0)
	dada=right(dadad,tt)
	%>
    
    <h3><a href="ArticleShow.asp?ArtID=<%=zrs1("D_ID")%>" title="<%=zrs1("D_Title")%>">・<%=zRs1("D_Title")%></a><span> <%=dada%></span></h3>
	
	<%
	zrs1.movenext
	next
	else
	response.Write "<li>暂无相关信息</li>"
	end if
	zrs1.close

End Function
%>