<!--#include file="../../conn.asp"-->
<!--#include file="../inc/setup.asp"-->
<!--#include file="../inc/const.asp"-->
<!--#include file="../inc/check.asp"-->
<%
Admin_header
'=====================================================================
' 软件名称：新云网站管理系统
' 当前版本：NewAsp Content Management System Version 4.0
' 文件名称：admin_setting.asp
' 更新日期：2008-05-16
' 官方网站：新云网络(www.newasp.net www.newasp.cn) QQ：94022511
'=====================================================================
' Copyright 2003-2008 newasp.net - All Rights Reserved.
' newasp is a trademark of newasp.net
'=====================================================================
%>
<table class="table1" cellspacing="1" cellpadding="3" align="center" border="0">
	<tr>
		<td class="tableline linetitle" width="200" align="left">网站常规设置</td>
		<td class="tableline" width="*" align="right"><a href="admin_setting.asp">基本设置</a>
			 - <a href="admin_setting.asp?action=upload">上传设置</a>
			 - <a href="admin_setting.asp?action=plus">联盟插件设置</a>
			 - <a href="admin_setting.asp?action=editkey">内容关键字管理</a>
			 - <a href="admin_lockip.asp">IP限制管理</a>
			 - <a href="admin_badword.asp">过滤字符管理</a>
		</td>
	</tr>
</table>
<%
Dim Action
If Not ChkAdmin("Setting") Then
	Call Transfer_error()
End If
Action = LCase(Request("action"))
Select Case Trim(Action)
	Case "savemain"
		Call saveMainSetting()
	Case "saveupload"
		Call saveUploadSetting()
	Case "saveplus"
		Call savePlusSetting()
	Case "upload"
		Call showUploadSetting()
	Case "plus"
		Call showPlusSetting()
	Case "editkey"
		Call editKeywordList()
	Case "savekey"
		Call saveKeywordList()
	Case Else
		Call showmain()
End Select
If FoundErr = True Then
	ReturnError(ErrMsg)
End If
Admin_footer
SaveLogInfo(AdminName)
NewAsp.PageEnd
Sub showmain()
	Dim Rs,i,MainSetting
	Dim m_strInstallDir,m_strMainDomain
	Set Rs = NewAsp.Execute("SELECT InstallDir,MainDomain,MainSetting,Templates,HostPath,syskey,syscode FROM NC_Setup")
	If Rs.BOF And Rs.EOF Then
		Set Rs = Nothing
		FoundErr = True
		ErrMsg = "系统安装错误,找不到系统设置!"
		Exit Sub
	End If
	MainSetting = Split(Rs("MainSetting") & "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||", "|||")
	m_strInstallDir = Left(LCase(Request.ServerVariables("SCRIPT_NAME")), InStrRev(LCase(Request.ServerVariables("SCRIPT_NAME")), "/") - 1)
	m_strInstallDir = Left(m_strInstallDir, InStrRev(m_strInstallDir, "/")-1)
	m_strInstallDir = Left(m_strInstallDir, InStrRev(m_strInstallDir, "/"))
	
	m_strMainDomain = "http://"& LCase(Request.ServerVariables("HTTP_HOST"))
	If m_strMainDomain = Trim(LCase(Rs("MainDomain"))) Then
		m_strMainDomain = Trim(LCase(Rs("MainDomain")))
	End If
	If m_strInstallDir=LCase(Rs("InstallDir")) Then m_strInstallDir=Rs("InstallDir")
%>
<div onkeydown="CtrlEnter()">
<form name="myform" method="post" action="?action=savemain">
<table id="tablehovered1" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">网站基本信息 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="InstallDir">系统安装目录</u>：</td>
	<td class="tablerow1" width="75%"><input type="text" name="InstallDir" size="35" value="<%=m_strInstallDir%>"> <font color="red">* 系统可以自动获取，如果程序安装在根目录请输入“/”</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainDomain">网站主域名</u>：</td>
	<td class="tablerow2"><input type="text" name="MainDomain" size="35" value="<%=m_strMainDomain%>"> <font color="red">* 如果你的网站更换了域名，请务必修改</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="Templates">保存系统模板的目录</u>：</td>
	<td class="tablerow1"><input type="text" name="Templates" size="35" value="<%=Server.HTMLEncode(Rs("Templates"))%>"> <font color="red">* 如果修改了系统模板目录，请手工修改相应的目录名称</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(0)">默认模板皮肤目录</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(0)" size="35" value="<%=Server.HTMLEncode(MainSetting(0))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(1)">网站名称</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(1)" size="35" value="<%=Server.HTMLEncode(MainSetting(1))%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(2)">首页文件名</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(2)" size="35" value="<%=Server.HTMLEncode(MainSetting(2))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(3)">管理员Email</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(3)" size="35" value="<%=Server.HTMLEncode(MainSetting(3))%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(4)">站点关键字</u>：<br/>搜索引擎用来搜索您网站的关键内容</td>
	<td class="tablerow2"><textarea name="MainSetting(4)" rows="3" cols="60"><%=Server.HTMLEncode(MainSetting(4))%></textarea></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(5)">网站版权信息</u>：</td>
	<td class="tablerow1"><textarea name="MainSetting(5)" rows="5" cols="60"><%=Server.HTMLEncode(MainSetting(5))%></textarea></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(6)">是否禁止代理服务器访问(建议关闭)</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(6)" value="0"<%If NewAsp.ChkNumeric(MainSetting(6)) = 0 Then Response.Write (" checked=""checked""")%>/> 否
		<input type="radio" name="MainSetting(6)" value="1"<%If NewAsp.ChkNumeric(MainSetting(6)) = 1 Then Response.Write (" checked=""checked""")%>/> 是
		<font color="red">* 只限于ASP动态页面</font>
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(7)">生成HTML文件方式</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(7)" value="0"<%If NewAsp.ChkNumeric(MainSetting(7)) = 0 Then Response.Write (" checked=""checked""")%>/> FSO
		<input type="radio" name="MainSetting(7)" value="1"<%If NewAsp.ChkNumeric(MainSetting(7)) = 1 Then Response.Write (" checked=""checked""")%>/> Stream
		<input type="radio" name="MainSetting(7)" value="2"<%If NewAsp.ChkNumeric(MainSetting(7)) = 2 Then Response.Write (" checked=""checked""")%>/> UTF-8
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(8)">网站访问状态</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(8)" value="0"<%If NewAsp.ChkNumeric(MainSetting(8)) = 0 Then Response.Write (" checked=""checked""")%>/> 打开
		<input type="radio" name="MainSetting(8)" value="1"<%If NewAsp.ChkNumeric(MainSetting(8)) = 1 Then Response.Write (" checked=""checked""")%>/> 关闭
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(9)">网站访问状态说明(支持HTML语法)</u>：</td>
	<td class="tablerow1"><textarea name="MainSetting(9)" rows="3" cols="60"><%=Server.HTMLEncode(MainSetting(9))%></textarea></td>
</tr>
</table>
<table id="tablehovered2" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">系统邮件设置 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="MainSetting(10)">发送邮件组件(如果不支持请选择关闭)</u>：</td>
	<td class="tablerow1" width="75%">
		<select size="1" name="MainSetting(10)"  onChange="chkselect(options[selectedIndex].value,'knowinfo');">
			<option value="0"<%If NewAsp.ChkNumeric(MainSetting(10)) = 0 Then Response.Write (" selected")%>>关闭邮件功能</option>
			<option value="1"<%If NewAsp.ChkNumeric(MainSetting(10)) = 1 Then Response.Write (" selected")%>>JMAIL</option>
			<option value="2"<%If NewAsp.ChkNumeric(MainSetting(10)) = 2 Then Response.Write (" selected")%>>CDONTS</option>
			<option value="3"<%If NewAsp.ChkNumeric(MainSetting(10)) = 3 Then Response.Write (" selected")%>>ASPEMAIL</option>
			<option value="4"<%If NewAsp.ChkNumeric(MainSetting(10)) = 4 Then Response.Write (" selected")%>>CDO</option>
		</select>
		<span id="knowinfo"></span>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(11)">显示的邮件来源Email</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(11)" size="35" value="<%=Server.HTMLEncode(MainSetting(11))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(12)">SMTP Server地址</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(12)" size="35" value="<%=Server.HTMLEncode(MainSetting(12))%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(13)">邮件登录用户名</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(13)" size="35" value="<%=Server.HTMLEncode(MainSetting(13))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(14)">邮件登录密码</u>：</td>
	<td class="tablerow1"><input type="password" name="MainSetting(14)" size="35" value="<%=Server.HTMLEncode(MainSetting(14))%>"></td>
</tr>
</table>
<table id="tablehovered3" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">用户注册/登录设置 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="MainSetting(15)">是否允许新用户注册</u>：</td>
	<td class="tablerow1" width="75%">
		<input type="radio" name="MainSetting(15)" value="0"<%If NewAsp.ChkNumeric(MainSetting(15)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(15)" value="1"<%If NewAsp.ChkNumeric(MainSetting(15)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(16)">注册会员是否要管理员认证</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(16)" value="0"<%If NewAsp.ChkNumeric(MainSetting(16)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(16)" value="1"<%If NewAsp.ChkNumeric(MainSetting(16)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(17)">注册会员是否Email通知密码</u>：<br/>所包含密码为系统随机生成</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(17)" value="0"<%If NewAsp.ChkNumeric(MainSetting(17)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="MainSetting(17)" value="1"<%If NewAsp.ChkNumeric(MainSetting(17)) = 1 Then Response.Write (" checked")%>> 打开
		<font color="red">* 确认您的站点支持发送E-mail</font>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(18)">一个E-mail只能注册一个会员</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(18)" value="0"<%If NewAsp.ChkNumeric(MainSetting(18)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="MainSetting(18)" value="1"<%If NewAsp.ChkNumeric(MainSetting(18)) = 1 Then Response.Write (" checked")%>> 打开
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(19)">发送注册邮件信息</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(19)" value="0"<%If NewAsp.ChkNumeric(MainSetting(19)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="MainSetting(19)" value="1"<%If NewAsp.ChkNumeric(MainSetting(19)) = 1 Then Response.Write (" checked")%>> 打开
		<font color="red">* 确认您的站点支持发送E-mail</font>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(20)">是否禁止代理服务器注册/登录</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(20)" value="0"<%If NewAsp.ChkNumeric(MainSetting(20)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(20)" value="1"<%If NewAsp.ChkNumeric(MainSetting(20)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(21)">是否禁止用户同时登录</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(21)" value="0"<%If NewAsp.ChkNumeric(MainSetting(21)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(21)" value="1"<%If NewAsp.ChkNumeric(MainSetting(21)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(22)">注册是否采用验证码</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(22)" value="0"<%If NewAsp.ChkNumeric(MainSetting(22)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(22)" value="1"<%If NewAsp.ChkNumeric(MainSetting(22)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(23)">登录是否采用验证码</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(23)" value="0"<%If NewAsp.ChkNumeric(MainSetting(23)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(23)" value="1"<%If NewAsp.ChkNumeric(MainSetting(23)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(24)">评论是否采用验证码</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(24)" value="0"<%If NewAsp.ChkNumeric(MainSetting(24)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(24)" value="1"<%If NewAsp.ChkNumeric(MainSetting(24)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(25)">会员取回密码是否采用验证码</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(25)" value="0"<%If NewAsp.ChkNumeric(MainSetting(25)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(25)" value="1"<%If NewAsp.ChkNumeric(MainSetting(25)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(26)">会员取回密码次数限制</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(26)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(26))%>">
	<font color="red">* 0=表示无限制；999=禁止使用密码找回功能</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(27)">最短用户名长度</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(27)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(27))%>">
	<font color="red">* 填写数字，不能小于1大于50</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(28)">最长用户名长度</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(28)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(28))%>">
	<font color="red">* 填写数字，不能小于1大于50</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(29)">同一IP注册间隔时间</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(29)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(29))%>">
	<font color="red">* 0则表示无限制</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(30)">注册新用户增加的点数</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(30)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(30))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(31)">注册是否采用问题验证</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(31)" value="0"<%If NewAsp.ChkNumeric(MainSetting(31)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(31)" value="1"<%If NewAsp.ChkNumeric(MainSetting(31)) = 1 Then Response.Write (" checked")%>> 是
		<font color="blue">开启此项可以防止恶意注册</font>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(32)">注册验证问题</u>：<br/>可以设置多个验证问题，<br/>每个问题使用,(英文逗号)分隔</td>
	<td class="tablerow2"><textarea name="MainSetting(32)" rows="5" cols="60"><%=Server.HTMLEncode(MainSetting(32))%></textarea></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(33)">注册验证答案</u>：<br/>设置回答上述问题的答案，<br/>每个问题答案,(英文逗号)分隔，<br/>和上面的问题顺序对应</td>
	<td class="tablerow1"><textarea name="MainSetting(33)" rows="5" cols="60"><%=Server.HTMLEncode(MainSetting(33))%></textarea></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(34)">禁止的邮件地址中包含的字符</u>：<br/>每个字符请使用,(英文逗号)分隔</td>
	<td class="tablerow2"><input type="text" name="MainSetting(34)" size="45" value="<%=Server.HTMLEncode(MainSetting(34))%>">
	<font color="red">* 邮件中所包含的此字符将被禁止注册</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(35)">禁止的用户名中包含的字符</u>：<br/>每个字符请使用,(英文逗号)分隔</td>
	<td class="tablerow1"><input type="text" name="MainSetting(35)" size="45" value="<%=Server.HTMLEncode(MainSetting(35))%>">
	<font color="red">* 用户名中所包含的此字符将被禁止使用</font></td>
</tr>
</table>
<table id="tablehovered4" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">系统设置 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="MainSetting(36)">服务器时差</u>：</td>
	<td class="tablerow1" width="75%">
		<select name="MainSetting(36)"><%For i=-23 to 23%>
			<option value="<%=i%>"<%If i=NewAsp.CheckNumeric(MainSetting(36)) Then%> selected<%End If%>><%=i%></option><%Next%>
		</select>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(37)">脚本超时时间</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(37)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(37))%>"> 秒
	<font color="red">* 默认为300，一般不做更改</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(38)">删除不活动用户时间</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(38)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(38))%>"> 分钟</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(39)">是否显示页面执行时间</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(39)" value="0"<%If NewAsp.ChkNumeric(MainSetting(39)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(39)" value="1"<%If NewAsp.ChkNumeric(MainSetting(39)) = 1 Then Response.Write (" checked")%>> 是
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(40)">是否关闭友情连接申请</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(40)" value="0"<%If NewAsp.ChkNumeric(MainSetting(40)) = 0 Then Response.Write (" checked")%>> 打开
		<input type="radio" name="MainSetting(40)" value="1"<%If NewAsp.ChkNumeric(MainSetting(40)) = 1 Then Response.Write (" checked")%>> 关闭
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(41)">搜索功能选项</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="MainSetting(41)" value="0"<%If NewAsp.ChkNumeric(MainSetting(41)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="MainSetting(41)" value="1"<%If NewAsp.ChkNumeric(MainSetting(41)) = 1 Then Response.Write (" checked")%>> 开启
		<input type="radio" name="MainSetting(41)" value="2"<%If NewAsp.ChkNumeric(MainSetting(41)) = 2 Then Response.Write (" checked")%>> 会员搜索
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(42)">是否开启全文搜索</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="MainSetting(42)" value="0"<%If NewAsp.ChkNumeric(MainSetting(42)) = 0 Then Response.Write (" checked")%>> 否
		<input type="radio" name="MainSetting(42)" value="1"<%If NewAsp.ChkNumeric(MainSetting(42)) = 1 Then Response.Write (" checked")%>> 是
		<font color="blue">* 全文搜索相当占用服务器资源</font>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(43)">每次搜索时间间隔</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(43)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(43))%>"> 秒</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(44)">搜索字串最小长度</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(44)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(44))%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(45)">搜索字串最大长度</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(45)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(45))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(46)">搜索返回最多的结果数</u>：</td>
	<td class="tablerow1"><input type="text" name="MainSetting(46)" size="10" value="<%=NewAsp.ChkNumeric(MainSetting(46))%>"> 条</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(47)">FSO组件的名称</u>：</td>
	<td class="tablerow2"><input type="text" name="MainSetting(47)" size="35" value="<%=Server.HTMLEncode(MainSetting(47))%>">
	<font color="blue">FSO默认名称：Scripting.FileSystemObject</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(48)">初始标题颜色</u>：<br/>每个颜色的值请用“,”(英文逗号)分开</td>
	<td class="tablerow1"><textarea name="MainSetting(48)" rows="3" cols="60"><%=Server.HTMLEncode(MainSetting(48))%></textarea></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="MainSetting(49)">允许链接本站的域名(用于防盗链)</u>：<br/>每个域名请用“,”(英文逗号)分开</td>
	<td class="tablerow2"><textarea name="MainSetting(49)" rows="5" cols="60"><%=Server.HTMLEncode(MainSetting(49))%></textarea></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="MainSetting(50)">盗链提示信息(支持HTML)</u>：</td>
	<td class="tablerow1"><textarea name="MainSetting(50)" rows="5" cols="60"><%=Server.HTMLEncode(MainSetting(50))%></textarea></td>
</tr>
<tr>
	<td class="tablerow2" align="right">&nbsp;</td>
	<td class="tablerow2"><input type="submit" value="保存设置" name="submit_button" id="submit_button" class="button"> [按Ctrl+Enter直接提交]</td>
</tr>
</table>
</form>
</div>
<%
	Set Rs = Nothing
	MainSetting = Null
	Dim InstalledObjects(4)
	Response.Write "<div id=""Issubport0"" style=""display:none"">关闭发送邮件功能</div>" & vbCrLf
	InstalledObjects(1) = "JMail.Message"				'JMail 4.3
	InstalledObjects(2) = "CDONTS.NewMail"				'CDONTS
	InstalledObjects(3) = "Persits.MailSender"			'ASPEMAIL
	InstalledObjects(4) = "CDO.Message"					'CDO.Message
	For i = 1 To 4
		Response.Write "<div id=""Issubport" & i & """ style=""display:none"">"
		If Not CheckObjInstalled(InstalledObjects(i)) Then
			Response.Write InstalledObjects(i) & " <b>×</b>服务器不支持!"
		Else
			Response.Write InstalledObjects(i) & " <font color=""red""><b>√</b>服务器支持!</font>"
		End If
		Response.Write "</div>"
	Next
	Response.Write "<script language=""JavaScript"">" & vbCrLf
	Response.Write "<!--" & vbCrLf
	Response.Write "function chkselect(s,divid)" & vbCrLf
	Response.Write "{" & vbCrLf
	Response.Write "var divname='Issubport';" & vbCrLf
	Response.Write "var chkreport;" & vbCrLf
	Response.Write "s=Number(s)" & vbCrLf
	Response.Write "divname=divname+s;" & vbCrLf
	Response.Write "document.getElementById(divid).innerHTML=divname;" & vbCrLf
	Response.Write "chkreport=document.getElementById(divname).innerHTML;" & vbCrLf
	Response.Write "document.getElementById(divid).innerHTML=chkreport;" & vbCrLf
	Response.Write "}" & vbCrLf
	Response.Write "//-->"
	Response.Write "</script>" & vbCrLf
End Sub

Sub showUploadSetting()
	Dim Rs,i,UploadSetting
	Set Rs = NewAsp.Execute("SELECT id,UploadSetting FROM NC_Setup")
	If Rs.BOF And Rs.EOF Then
		Set Rs = Nothing
		FoundErr = True
		ErrMsg = "系统安装错误,找不到系统设置!"
		Exit Sub
	End If
	UploadSetting = Split(Rs("UploadSetting") & "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||", "|||")
%>
<iframe width="260" height="165" id="colourPalette" src="../script/selcolor.htm" style="visibility:hidden; position: absolute; left:0px;top:0px;border:1px gray solid" frameborder="0" scrolling="no" ></iframe>
<div onkeydown="CtrlEnter()">
<form name="myform" method="post" action="?action=saveupload">
<table id="tablehovered1" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">上传文件设置 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="UploadSetting(0)">选取上传组件</u>：</td>
	<td class="tablerow1" width="75%"><select size="1" name="UploadSetting(0)" onChange="chkselect(options[selectedIndex].value,'know1');">
			<option value="999"<%If NewAsp.ChkNumeric(UploadSetting(0)) = 999 Then Response.Write (" selected")%>>关闭上传功能</option>
			<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(0)) = 0 Then Response.Write (" selected")%>>无组件上传类</option>
			<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(0)) = 1 Then Response.Write (" selected")%>>Aspupload3.0组件</option>
			<option value="2"<%If NewAsp.ChkNumeric(UploadSetting(0)) = 2 Then Response.Write (" selected")%>>SA-FileUp 4.0组件</option>
		</select> <span id="know1"></span>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(1)">上传文件大小 单位(KB)</u>：</td>
	<td class="tablerow2"><input type="text" name="UploadSetting(1)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(1))%>"><b>KB</b> <font color="red">* 只对后台有效</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(2)">上传文件类型</u>：<br/>每个文件类型请用“,”(英文逗号)分开</td>
	<td class="tablerow1"><input type="text" name="UploadSetting(2)" size="60" value="<%=Server.HTMLEncode(UploadSetting(2))%>"> <font color="red">* 只对后台有效</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(3)">上传目录设定</u>：</td>
	<td class="tablerow2"><input type="text" name="UploadSetting(3)" size="15" value="<%=Server.HTMLEncode(UploadSetting(3))%>"> <font color="red">* 相对网站根目录</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(4)">选取预览图片组件</u></td>
	<td class="tablerow1"><select size="1" name="UploadSetting(4)" onChange="chkselect(options[selectedIndex].value,'know2');">
			<option value="999"<%If NewAsp.ChkNumeric(UploadSetting(4)) = 999 Then Response.Write (" selected")%>>关闭预览图片功能</option>
			<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(4)) = 0 Then Response.Write (" selected")%>>CreatePreviewImage组件</option>
			<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(4)) = 1 Then Response.Write (" selected")%>>AspJpeg组件</option>
			<option value="2"<%If NewAsp.ChkNumeric(UploadSetting(4)) = 2 Then Response.Write (" selected")%>>SA-ImgWriter组件</option>
		</select> <span id="know2"></span>
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(5)">生成预览图片大小规则选项</u></td>
	<td class="tablerow2"><select size="1" name="UploadSetting(5)">
	<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(5)) = 0 Then Response.Write (" selected")%>>固定大小</option>
	<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(5)) = 1 Then Response.Write (" selected")%>>等比例缩小</option>
	<option value="9"<%If NewAsp.ChkNumeric(UploadSetting(5)) = 9 Then Response.Write (" selected")%>>关闭预览图</option>
	</select></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(6)">图片水印设置开关</u></td>
	<td class="tablerow1"><select size="1" name="UploadSetting(6)">
	<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(6)) = 0 Then Response.Write (" selected")%>>关闭水印效果</option>
	<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(6)) = 1 Then Response.Write (" selected")%>>水印文字效果</option>
	<option value="2"<%If NewAsp.ChkNumeric(UploadSetting(6)) = 2 Then Response.Write (" selected")%>>水印图片效果</option>
	</select></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(7/8)">生成预览图片大小设置(宽度|高度)</u></td>
	<td class="tablerow2">
	宽度：<input type="text" name="UploadSetting(7)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(7))%>"> 象素 |
	高度：<input type="text" name="UploadSetting(8)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(8))%>"> 象素
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(9)">上传图片添加水印文字信息（可为空或0）</u></td>
	<td class="tablerow1"><input type="text" name="UploadSetting(9)" size="30" value="<%=Server.HTMLEncode(UploadSetting(9))%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(10)">上传添加水印字体大小</u></td>
	<td class="tablerow2"><input type="text" name="UploadSetting(10)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(10))%>"> <b>px<b></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(11)">上传添加水印字体颜色</u></td>
	<td class="tablerow1"><input type="text" name="UploadSetting(11)" id="UploadSetting11" size="10" value="<%=Trim(UploadSetting(11))%>">
	<img border="0" src="../images/rect.gif" align="absMiddle" style="cursor:pointer;background-Color:<%=Trim(UploadSetting(11))%>;" onclick="Getcolor(this,'UploadSetting11');" title="选取颜色!"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(12)">上传添加水印所用字体</u></td>
	<td class="tablerow2"><select size="1" name="UploadSetting(12)">
	<option value="宋体"<%If Trim(UploadSetting(12)) = "宋体" Then Response.Write (" selected")%>>宋体</option>
	<option value="楷体_GB2312"<%If Trim(UploadSetting(12)) = "楷体_GB2312" Then Response.Write (" selected")%>>楷体</option>
	<option value="新宋体"<%If Trim(UploadSetting(12)) = "新宋体" Then Response.Write (" selected")%>>新宋体</option>
	<option value="黑体"<%If Trim(UploadSetting(12)) = "黑体" Then Response.Write (" selected")%>>黑体</option>
	<option value="隶书"<%If Trim(UploadSetting(12)) = "隶书" Then Response.Write (" selected")%>>隶书</option>
	<option value="Arial"<%If Trim(UploadSetting(12)) = "Arial" Then Response.Write (" selected")%>>Arial</option>
	<option value="Georgia"<%If Trim(UploadSetting(12)) = "Georgia" Then Response.Write (" selected")%>>Georgia</option>
	<option value="Impact"<%If Trim(UploadSetting(12)) = "Impact" Then Response.Write (" selected")%>>Impact</option>
	<option value="Tahoma"<%If Trim(UploadSetting(12)) = "Tahoma" Then Response.Write (" selected")%>>Tahoma</option>
	<option value="Stencil"<%If Trim(UploadSetting(12)) = "Stencil" Then Response.Write (" selected")%>>Stencil</option>
	<option value="Verdana"<%If Trim(UploadSetting(12)) = "Verdana" Then Response.Write (" selected")%>>Verdana</option>
	</select></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(13)">上传水印字体是否粗体</u></td>
	<td class="tablerow1"><select size="1" name="UploadSetting(13)">
	<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(13)) = 0 Then Response.Write (" selected")%>>≡否≡</option>
	<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(13)) = 1 Then Response.Write (" selected")%>>≡是≡</option>
	</select></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(14)">上传图片添加水印LOGO图片信息</u><br>填写LOGO的图片相对路径</td>
	<td class="tablerow2"><input type="text" name="UploadSetting(14)" size="30" value="<%=Trim(UploadSetting(14))%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(15)">上传图片添加水印透明度</u><br></td>
	<td class="tablerow1"><input type="text" name="UploadSetting(15)" size="10" value="<%=Trim(UploadSetting(15))%>"> <font color="blue">如50%请填写0.5</font></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(16)">水印图片去除底色</U><br>保留为空则水印图片不去除底色</td>
	<td class="tablerow2"><input type="text" name="UploadSetting(16)" id="UploadSetting16" size="10" value="<%=Trim(UploadSetting(16))%>">
	<img border="0" src="../images/rect.gif" align="absMiddle" style="cursor:pointer;background-Color:<%=Trim(UploadSetting(16))%>;" onclick="Getcolor(this,'UploadSetting16');" title="选取颜色!"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="UploadSetting(17/18)">水印文字或图片的长宽区域定义</u><br>如水印图片的宽度和高度</td>
	<td class="tablerow1">
	宽度：<input type="text" name="UploadSetting(17)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(17))%>"> 象素 |
	高度：<input type="text" name="UploadSetting(18)" size="10" value="<%=NewAsp.ChkNumeric(UploadSetting(18))%>"> 象素
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="UploadSetting(19)">上传图片添加水印LOGO位置坐标</u></td>
	<td class="tablerow2"><select size="1" name="UploadSetting(19)">
	<option value="0"<%If NewAsp.ChkNumeric(UploadSetting(19)) = 0 Then Response.Write (" selected")%>>≡左上≡</option>
	<option value="1"<%If NewAsp.ChkNumeric(UploadSetting(19)) = 1 Then Response.Write (" selected")%>>≡左下≡</option>
	<option value="2"<%If NewAsp.ChkNumeric(UploadSetting(19)) = 2 Then Response.Write (" selected")%>>≡居中≡</option>
	<option value="3"<%If NewAsp.ChkNumeric(UploadSetting(19)) = 3 Then Response.Write (" selected")%>>≡右上≡</option>
	<option value="4"<%If NewAsp.ChkNumeric(UploadSetting(19)) = 4 Then Response.Write (" selected")%>>≡右下≡</option>
	</select></td>
</tr>
<tr>
	<td class="tablerow1" align="right">&nbsp;</td>
	<td class="tablerow1"><input type="submit" value="保存上传设置" name="submit_button" id="submit_button" class="button"> [按Ctrl+Enter直接提交]</td>
</tr>
</table>
</form>
</div>
<%
	Set Rs = Nothing
	UploadSetting = Null
	Dim InstalledObjects(5)
	Dim InstallObjectInfo(5)
	Response.Write "<div id=""Issubport999"" style=""display:none""><b>×</b>关闭文件上传功能</div>" & vbCrLf
	Response.Write "<div id=""Issubport1002"" style=""display:none""><b>×</b>关闭预览图片功能</div>" & vbCrLf
	InstalledObjects(0) = "Adodb.Stream"				'无组件上传类
	InstalledObjects(1) = "Persits.Upload"				'Aspupload3.0
	InstalledObjects(2) = "SoftArtisans.FileUp"			'SA-FileUp 4.0

	InstalledObjects(3) = "CreatePreviewImage.cGvbox"	'CreatePreviewImage
	InstalledObjects(4) = "Persits.Jpeg"				'AspJpeg
	InstalledObjects(5) = "SoftArtisans.ImageGen"		'SoftArtisans ImgWriter V1.21

	InstallObjectInfo(0) = "无组件上传类"
	InstallObjectInfo(1) = "Aspupload3.0"
	InstallObjectInfo(2) = "SA-FileUp 4.0"
	InstallObjectInfo(3) = "CreatePreviewImage"
	InstallObjectInfo(4) = "AspJpeg"
	InstallObjectInfo(5) = "SoftArtisans"
	For i = 0 To 5
		Response.Write "<div id=""Issubport" & i & """ style=""display:none"">"
		If Not CheckObjInstalled(InstalledObjects(i)) Then
			Response.Write InstallObjectInfo(i) & " <b>×</b>服务器不支持!"
		Else
			Response.Write InstallObjectInfo(i) & " <font color=""red""><b>√</b>服务器支持!</font>"
		End If
		Response.Write "</div>"
	Next
	Response.Write "<script language=""JavaScript"">" & vbCrLf
	Response.Write "<!--" & vbCrLf
	Response.Write "function chkselect(s,divid)" & vbCrLf
	Response.Write "{" & vbCrLf
	Response.Write "var divname='Issubport';" & vbCrLf
	Response.Write "var chkreport;" & vbCrLf
	Response.Write "s=Number(s)" & vbCrLf
	Response.Write "if (divid==""know1"")" & vbCrLf
	Response.Write "{" & vbCrLf
	Response.Write "divname=divname+s;" & vbCrLf
	Response.Write "}" & vbCrLf
	Response.Write "if (divid==""know2"")" & vbCrLf
	Response.Write "{" & vbCrLf
	Response.Write "s+=3;" & vbCrLf
	Response.Write "divname=divname+s;" & vbCrLf
	Response.Write "}" & vbCrLf

	Response.Write "document.getElementById(divid).innerHTML=divname;" & vbCrLf
	Response.Write "chkreport=document.getElementById(divname).innerHTML;" & vbCrLf
	Response.Write "document.getElementById(divid).innerHTML=chkreport;" & vbCrLf
	Response.Write "}" & vbCrLf
	Response.Write "//-->"
	Response.Write "</script>" & vbCrLf
End Sub

Sub showPlusSetting()
	Dim Rs,i,PlusSetting
	Set Rs = NewAsp.Execute("SELECT id,PlusSetting FROM NC_Setup")
	If Rs.BOF And Rs.EOF Then
		Set Rs = Nothing
		FoundErr = True
		ErrMsg = "系统安装错误,找不到系统设置!"
		Exit Sub
	End If
	PlusSetting = Split(Rs("PlusSetting") & "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||", "|||")
%>
<div onkeydown="CtrlEnter()">
<form name="myform" method="post" action="?action=saveplus">
<table id="tablehovered1" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2">联盟插件设置 <span class="clicksubmit" onclick="document.myform.submit();">[保存设置]</span></th>
</tr>
<tr>
	<td class="tablerow1" width="25%" align="right"><u title="PlusSetting(0)">联盟插件设置开关</u>：</td>
	<td class="tablerow1" width="75%">
		<input type="radio" name="PlusSetting(0)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(0)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(0)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(0)) = 1 Then Response.Write (" checked")%>> 开启
	</td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(0)">是否开启迅雷联盟下载插件</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="PlusSetting(1)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(1)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(1)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(1)) = 1 Then Response.Write (" checked")%>> 开启
		&nbsp;&nbsp;<font color="blue">* 如果你还没注册迅雷下载联盟，请点此注册<a href="http://union.xunlei.com/" target="_blank"><font color="red"><strong>迅雷联盟</strong></font></a></font>
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(2)">迅雷下载联盟ID</u>：</td>
	<td class="tablerow1"><input type="text" name="PlusSetting(2)" size="30" value="<%=PlusSetting(2)%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(3)">是否开启快车联盟下载插件</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="PlusSetting(3)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(3)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(3)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(3)) = 1 Then Response.Write (" checked")%>> 开启
		&nbsp;&nbsp;<font color="blue">* 如果你还没注册快车下载联盟，请点此注册<a href="http://union.flashget.com/" target="_blank"><font color="red"><strong>快车联盟</strong></font></a></font>
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(4)">快车下载联盟ID</u>：</td>
	<td class="tablerow1"><input type="text" name="PlusSetting(4)" size="30" value="<%=PlusSetting(4)%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(5)">是否开启CC视频联盟插件</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="PlusSetting(5)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(5)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(5)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(5)) = 1 Then Response.Write (" checked")%>> 开启
		&nbsp;&nbsp;<font color="blue">* 如果你还没注册CC视频联盟，请点此注册<a href="http://union.bokecc.com/" target="_blank"><font color="red"><strong>CC视频联盟</strong></font></a></font>
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(6)">CC视频联盟ID</u>：</td>
	<td class="tablerow1"><input type="text" name="PlusSetting(6)" size="30" value="<%=PlusSetting(6)%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(7)">您的展区listid</u>：</td>
	<td class="tablerow2"><input type="text" name="PlusSetting(7)" size="30" value="<%=PlusSetting(7)%>"> <font color="red">* 请登录CC视频联盟后台的“视频展区”获得</font></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(8)">选择视频插件按钮样式</u>：</td>
	<td class="tablerow1"><input type="hidden" id="BokeccUnionIMG" value="<%=PlusSetting(8)%>"/>
				<select id="styleselecter" name="PlusSetting(8)" onchange="changestyle(this.value)">
					<option value="plugin.swf" selected="selected">01(72x24)</option>
					<option value="plugin_2.swf">02(72x24)</option>
					<option value="plugin_3.swf">03(72x24)</option>
					<option value="plugin_4.swf">04(72x24)</option>
					<option value="plugin_5.swf">05(72x24)</option>
					<option value="plugin_6.swf">06(72x24)</option>
					<option value="plugin_7.swf">07(72x24)</option>
					<option value="plugin_8.swf">08(71x24)</option>
					<option value="plugin_9.swf">09(72x24)</option>
					<option value="plugin_10.swf">10(72x24)</option>
					<option value="plugin_11.swf">11(72x24)</option>
					<option value="plugin_12.swf">12(72x24)</option>
					<option value="plugin_13.swf">13(72x24)</option>
					<option value="plugin_14.swf">14(72x24)</option>
					<option value="plugin_15.swf">15(72x24)</option>
					<option value="plugin_16.swf">16(86x22)</option>
				</select>
				<img id="pluginimg" src="../images/cc/<%=Replace(LCase(PlusSetting(8)), ".swf", ".gif")%>" width="<%=NewAsp.ChkNumeric(PlusSetting(9))%>" height="<%=NewAsp.ChkNumeric(PlusSetting(10))%>" border="0" align="absMiddle"/></td>
</tr>
<script language="JavaScript">
<!--
	function changestyle(style){
		this.style=style;
		document.images['pluginimg'].src='../images/cc/'+style.replace('swf','gif');
		//document.myform("BokeccUnionIMG").value=style;
		document.getElementById("BokeccUnionIMG").value=style;
	}
	
//-->
</script>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(9)/PlusSetting(10)">视频插件按钮大小</u>：</td>
	<td class="tablerow2"><input type="text" name="PlusSetting(9)" size="10" value="<%=PlusSetting(9)%>"> X <input type="text" name="PlusSetting(10)" size="10" value="<%=PlusSetting(10)%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(10)">是否开放展区</u>：</td>
	<td class="tablerow1">
		<input type="radio" name="PlusSetting(11)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(11)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(11)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(11)) = 1 Then Response.Write (" checked")%>> 开启
	</td>
</tr>

<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(12)">是否开启WSS统计功能</u>：</td>
	<td class="tablerow2">
		<input type="radio" name="PlusSetting(12)" value="0"<%If NewAsp.ChkNumeric(PlusSetting(12)) = 0 Then Response.Write (" checked")%>> 关闭
		<input type="radio" name="PlusSetting(12)" value="1"<%If NewAsp.ChkNumeric(PlusSetting(12)) = 1 Then Response.Write (" checked")%>> 开启
	</td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(13)">WSS统计域名</u>：</td>
	<td class="tablerow1"><input type="text" name="PlusSetting(13)" size="30" value="<%=PlusSetting(13)%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right"><u title="PlusSetting(14)">WSS统计站点ID</u>：</td>
	<td class="tablerow2"><input type="text" name="PlusSetting(14)" size="30" value="<%=PlusSetting(14)%>"></td>
</tr>
<tr>
	<td class="tablerow1" align="right"><u title="PlusSetting(15)">WSS统计登录密码</u>：</td>
	<td class="tablerow1"><input type="password" name="PlusSetting(15)" size="30" value="<%=PlusSetting(15)%>"></td>
</tr>
<tr>
	<td class="tablerow2" align="right">&nbsp;</td>
	<td class="tablerow2"><input type="submit" value="保存联盟插件设置" name="submit_button" id="submit_button" class="button"> [按Ctrl+Enter直接提交]</td>
</tr>
</table>
</form>
</div>
<%
	Set Rs = Nothing
	PlusSetting = Null
End Sub

Sub editKeywordList()
	Dim Rs,i,KeywordListStr,KeywordStr,iCount,lCount
	Set Rs = NewAsp.Execute("SELECT id,KeywordList FROM NC_setup")
	KeywordListStr = Split(Rs("KeywordList"), "@@@")

%>
<table id="tablehovered" border="0" align="center" cellpadding="3" cellspacing="1" class="tableborder">
<tr>
	<th colspan="2" align="left">内容关键字设置</th>
</tr>
<form name="myform" method="post" action="?action=savekey">
<tr>
	<td class="tablerow1"><b>内容关键字</b></td>
	<td class="tablerow1"><b>关键字连接URL</b></td>
</tr>
<%
If Trim(Rs("KeywordList")) <> "" Then

	For i = 0 To UBound(KeywordListStr)

		If KeywordListStr(i) <> "" Then
			KeywordStr = Split(KeywordListStr(i), "$$$")
		Else
			KeywordStr(0) = "del"
			KeywordStr(1) = "del"
		End If

		If (i mod 2) = 0 Then
			iCount = 2
			lCount = 1
		Else
			iCount = 1
			lCount = 2
		End If
%>
<tr>
	<td class="tablerow<%=iCount%> hovered"><input type="text" name="KeywordStr" size="45" value="<%=Server.HTMLEncode(KeywordStr(0))%>"></td>
	<td class="tablerow<%=iCount%> hovered"><input type="text" name="KeywordUrl" size="45" value="<%=Server.HTMLEncode(KeywordStr(1))%>"></td>
</tr>
<%
	Next
Else
%>
<tr>
	<td class="tablerow2 hovered"><input type=text name="KeywordStr" size="45" value="del"></td>
	<td class="tablerow2 hovered"><input type=text name="KeywordUrl" size="45" value="del"></td>
</tr>
<%
	iCount = 2
	lCount = 1
End If
%>
<tr>
	<td class="tablerow<%=lCount%>" colspan="2" align="center"><input type="submit" value="保存设置" class="button"></td>
</tr>
<tr>
	<td class="tablerow<%=iCount%>" colspan="2"><strong>说明:</strong><br>&nbsp;&nbsp;本功能用于在文章中找到适当的关键字, 并为其设置合适当的链接.
如: 设置了关键字 新云网络, 指向地址 http://www.newasp.net  那么当文章中出现"新云网络"这些字时, 页面上能自动为这些字加上指向http://www.newasp.net这个地址的链接.   注意: 不能设置重复的关键字, 也不能设置包含相同文字的关键字,如果想清除该关键字，请在对应的文本框中输入"del"，
如果要设置多个关键字用一个连接请用“|”分开。</td>
</tr>
</form>
</table>
<%
	Rs.Close:Set Rs = Nothing
End Sub

Sub saveKeywordList()
	Dim TempKeywordStr,TempKeywordUrl
	Dim i
	Dim KeywordList,KeywordListStr
	TempKeywordStr = Request.Form("KeywordStr")
	TempKeywordUrl = Request.Form("KeywordUrl")
	For i = 1 To Request.Form("KeywordStr").Count
		TempKeywordStr = Replace(Replace(Replace(Request.Form("KeywordStr")(i), "|||", ""), "$$$", ""), "@@@", "")
		TempKeywordUrl = Replace(Replace(Replace(Request.Form("KeywordUrl")(i), "|||", ""), "$$$", ""), "@@@", "")
		If Trim(TempKeywordStr) = "" Or Trim(TempKeywordUrl) = "" Then
			FoundErr = True
			ErrMsg = ErrMsg + "<li>内容关键字和关键字连接URL不能为空！</li>"
			Exit Sub
		End If
		If LCase(Trim(TempKeywordStr)) <> "del" And LCase(Trim(TempKeywordUrl)) <> "del" Then
			KeywordList = KeywordList & Trim(TempKeywordStr) & "$$$" & Trim(TempKeywordUrl) & "@@@"
		End If
	Next
	KeywordListStr = Newasp.CheckStr(KeywordList)
	Newasp.Execute ("UPDATE [NC_setup] SET KeywordList='" & KeywordListStr & "'")
	NewAsp.DelCache("setup")
	Succeed("恭喜您！设置内容关键字成功。")
End Sub

Sub saveMainSetting()
	Dim Rs,SQL,i
	Dim m_strInstallDir,m_strMainDomain,m_strMainSetting,m_strTemplates,m_strSysKey
	m_strSysKey = NewAsp.GetRandomCode(16)
	m_strInstallDir = Trim(Request.Form("InstallDir"))
	m_strMainDomain = Trim(Request.Form("MainDomain"))
	m_strTemplates = Replace(Replace(Trim(Request.Form("Templates")), "/", ""), "\", "")
	If Len(m_strInstallDir) = 0 Then
		FoundErr = True : ErrMsg = ErrMsg & "<li>系统安装路径不能为空!</li>"
	End If
	If Len(m_strMainDomain) = 0 Then
		FoundErr = True : ErrMsg = ErrMsg & "<li>网站主域名不能为空!</li>"
	End If
	If Len(m_strTemplates) = 0 Then
		FoundErr = True : ErrMsg = ErrMsg & "<li>统模板目录不能为空!</li>"
	End If
	m_strMainSetting = ""
	For i = 0 To 50
		m_strMainSetting = m_strMainSetting & Replace(Trim(Request.Form("MainSetting(" & i & ")")), "|||", "") & "|||"
	Next
	If FoundErr = True Then Exit Sub
	If Not IsObject(Conn) Then ConnectionDatabase
	Set Rs = NewAsp.CreateAXObject("ADODB.Recordset")
	SQL = "SELECT * FROM NC_Setup"
	Rs.Open SQL,Conn,1,3
		Rs("InstallDir") = m_strInstallDir
		Rs("MainDomain") = m_strMainDomain
		Rs("MainSetting") = m_strMainSetting & "0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||"
		Rs("Templates") = m_strTemplates
		Rs("syskey") = m_strSysKey
	Rs.Update
	Rs.Close:Set Rs = Nothing
	NewAsp.DelCache("setup")
	Succeed("<li>恭喜您！保存常规设置成功。</li>")
End Sub

Sub saveUploadSetting()
	Dim Rs,SQL,i,m_strUploadSetting
	m_strUploadSetting = ""
	For i = 0 To 19
		m_strUploadSetting = m_strUploadSetting & Replace(Trim(Request.Form("UploadSetting(" & i & ")")), "|||", "") & "|||"
	Next
	If FoundErr = True Then Exit Sub
	If Not IsObject(Conn) Then ConnectionDatabase
	Set Rs = NewAsp.CreateAXObject("ADODB.Recordset")
	SQL = "SELECT * FROM NC_Setup"
	Rs.Open SQL,Conn,1,3
		Rs("UploadSetting") = m_strUploadSetting & "0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||"
	Rs.Update
	Rs.Close:Set Rs = Nothing
	NewAsp.DelCache("setup")
	Succeed("<li>恭喜您！保存上传设置成功。</li>")
End Sub

Sub savePlusSetting()
	Dim Rs,SQL,i,m_strPlusSetting
	m_strPlusSetting = ""
	For i = 0 To 15
		m_strPlusSetting = m_strPlusSetting & Replace(Trim(Request.Form("PlusSetting(" & i & ")")), "|||", "") & "|||"
	Next
	If FoundErr = True Then Exit Sub
	If Not IsObject(Conn) Then ConnectionDatabase
	Set Rs = NewAsp.CreateAXObject("ADODB.Recordset")
	SQL = "SELECT * FROM NC_Setup"
	Rs.Open SQL,Conn,1,3
		Rs("PlusSetting") = m_strPlusSetting & "0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||0|||"
	Rs.Update
	Rs.Close:Set Rs = Nothing
	NewAsp.DelCache("setup")
	Succeed("<li>恭喜您！保存联盟插件设置成功。</li>")
End Sub

%>
<script Language="JScript" runat="server">
//*************************************
//检测系统组件是否安装
//*************************************
function CheckObjInstalled(strClassString){
	try{
		var TmpObj = Server.CreateObject(strClassString);
		return true
	}catch(e){
		return false
	}
}
</script>