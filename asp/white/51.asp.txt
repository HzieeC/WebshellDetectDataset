<!--#include file="Cai_Vip_Conn.asp" -->
<!--#include file="Cai_Vip_Adn.asp" --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>ADN自定义采集系统</title>
<link href="Cai_Vip_Style.css" type=text/css rel=stylesheet>
</head>
<BODY leftMargin=0 topMargin=0 scroll=yes MARGINHEIGHT="0" MARGINWIDTH="0">
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <tbody>
    <tr>
      <td class=xingmu>采集管理</td>
    </tr>
    <tr>
      <td class="hback"><a href="Cai_Vip_Main.asp">采集管理首页</a> | <a href="Cai_Vip_Main.asp?Action=Add">采集添加</a> | <a href="Cai_Vip_Main.asp?Action=Delall" onClick="return confirm('删除后将不能恢复,确定要删除吗?');">删除所有</a><%If GetBreakpoint=True Then%> | <a href="Cai_Vip_Main.asp?Action=DuanDian"><font color="red">上次采集因为您停止了采集项目或XMLHTTP组件服务器故障导致中止，现在您是否继续上次的采集项目？</font></a><%End If%></td>
    </tr>
  </tbody>
</table>
<% 
Dim Action,Page
Action=Trim(request.QueryString("Action"))
Page=Adn_CLng(request.QueryString ("page"))
If page<=0 or page="" Then page=1
Call OpenConn()
Select Case Action
Case "Add"
	Call Add()
Case "Add2"
	Call Add2()
Case "Add3"
	Call Add3()
Case "Add4"
	Call Add4()
Case "AddSever"
	Session("ListUrl")=""
	Session("selEncoding")=""
	Session("ListCode")=""
	Session("NewsCode")=""
	Call Admin_ShowErr("<li>采集栏目添加成功！</li>","Cai_Vip_Main.asp",1)
Case "Edit"
	Call Edit()
Case "Edit2"
	Call Edit2()
Case "Edit3"
	Call Edit3()
Case "Edit4"
	Call Edit4()
Case "EditSever"
		Session("ListUrl")=""
		Session("selEncoding")=""
		Session("ListCode")=""
		Session("NewsCode")=""
	Call Admin_ShowErr("<li>采集栏目修改成功</li>","Cai_Vip_Main.asp",1)
Case "Del"
	Call Del()
Case "Delall"
	Call DelAll()
Case "DelCai"
	Call DelCai()	
Case "CaiAll"
	Response.Redirect("Cai_Vip_Ing.asp?ItemType="&Action&"&ItemID="&Request("ItemID")&"")
Case "DuanDian"
	Call DuanDian()
Case "Copy"
	Call Copy()
Case Else
	Call List()
End Select
Call CloseConn()
Sub List()
%>
<script language = "javaScript" src = "../Adn_All.js" type="text/javascript"></script>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <tbody>
  <form name="myform" method="get" action="Cai_Vip_Main.asp">
  <input name="Action" type="hidden" value="CaiAll">
    <tr>
      <td width="5%" align="center" class=xingmu>ID</td>
      <td align="center" class=xingmu>采集项目名称</td>
      <td width="25%" align="center" class=xingmu>最后一次采集时间</td>
      <td width="20%" align="center" class=xingmu>操作</td>
    </tr>
<%  Set Rs = server.CreateObject(Adn_Cms_CollConst)
sql="Select ID,CollectName,CollectTime from Collect_Class order by id asc"
Rs.open sql,Connx,1,1
If Rs.eof then
    Response.Write"<TR  class=""hback""><TD colspan=""4"" class=""hback"" height=""40"">没有记录。</TD></TR>"
Else
	i=0
	rs.pagesize=15       '每页数据
	rs.AbsolutePage=page
	m=rs.recordcount     '总记录
	n=rs.PageCount       '总页数
	z=rs.pagesize        '每页数量
	Do while not rs.eof  and i<rs.pagesize
%>
    <tr>
      <td height=32 align="center" class="hback" style="text-align:left"><input name='ItemID' type='checkbox' onclick='CheckItem(this)' value='<%=RS("ID")%>' style="border:none"><%=RS("ID")%></td>
      <td height=32 class="hback"><%=RS("CollectName")%></td>
      <td height=32 align="center" class="hback"><%=RS("CollectTime")%></td>
      <td align="center" class="hback"><A href="Cai_Vip_Ing.asp?ID=<%= RS("ID") %>">采集</A>｜<A href="Cai_Vip_Main.asp?Action=Edit&ID=<%=RS("ID")%>">修改</A>｜<A href="Cai_Vip_Main.asp?Action=Copy&ID=<%= RS("ID") %>">复制</A>｜<A href="Cai_Vip_Main.asp?Action=Del&ID=<%=RS("ID")%>">删除</A></td>
    </tr>
<%i=i+1
Rs.MoveNext
Loop 
End If%>
    <tr align="right">
      <td height=32 colspan="4" class="hback"><span style="float:left"><input name='chkAll' type='checkbox' id='All' onclick='CheckAll(this.form)' value='checkbox' style="border:none">选中本页显示的所有项目 <input type='submit' name='Submit3' value=" 批量采集 " onClick="document.myform.Action.value='CaiAll'"> <input type='submit' name='Submit3' value=" 批量删除 " onClick="document.myform.Action.value='DelCai';return confirm('删除后将不能恢复,确定要删除吗?');"></span><%=ShowPage("Cai_Vip_Main.asp", m, z, page, True, True, "条", False)%></td>
    </tr>
  </tbody>
</table>
<%Rs.Close
Set Rs = nothing
End sub

Sub Del()
	Connx.execute "delete from Collect_Class where ID="&Request.QueryString("ID")
	Call Admin_ShowErr("<li>采集项目删除成功！</li>","Cai_Vip_Main.asp",1)
End Sub
Sub DelAll()
	Connx.execute "delete from Collect_Class"
	Call Admin_ShowErr("<li>所有采集项目删除成功！</li>","Cai_Vip_Main.asp",1)
End Sub
Sub DelCai()
	Connx.execute "delete from Collect_Class where ID in("&Request.QueryString("ItemID")&")"
	Call Admin_ShowErr("<li>选中的采集项目删除成功！</li>","Cai_Vip_Main.asp",1)
End Sub
Sub DuanDian()
	Set rs = Connx.Execute("Select Top 1 id,Breakpoint From [Collect_DuanDian] order by id asc")
	If Not rs.eof Then
	    Response.Write(rs("Breakpoint"))
	Else
	    Call Admin_ShowErr("<li>没有需要断点续采的项目!</li>","Cai_Vip_Main.asp",0)
	End If
	Set rs=Nothing
End Sub
Sub Add()%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
 <form name="Form" action="Cai_Vip_Main.asp?Action=Add2" method="post">
  <tbody>
    <tr>
      <td colspan="2" class=xingmu>采集项目添加</td>
    </tr>
    <tr>
      <td width="21%" height=32 align="right" class="hback">采集名称：</td>
      <td height=7 class="hback"><input name="CollectName" type="text" id="CollectName" size="40"></td>
    </tr>
        <tr>
      <td height=32 align="right" class="hback">目标编码：</td>
      <td height=7 class="hback"><select name="selEncoding" size="1">
          <option value="GB2312" selected="selected">GB2312</option>
          <option value="UTF-8">UTF-8</option>
          <option value="BIG5">BIG5</option>
        </select></td>
    </tr>
        <tr>
      <td height=32 align="right" class="hback">分页设置：</td>
      <td height=32 class="hback"><input type="radio" value="0" name="ListPaingType" checked="checked" onClick="ChangeCutPara(0);">
不分页&nbsp;&nbsp;
<input type="radio" value="1" name="ListPaingType" onClick="ChangeCutPara(1);">
批量分页&nbsp;
<input type="radio" value="2" name="ListPaingType" onClick="ChangeCutPara(2);">
手动分页&nbsp;
<input type="radio" value="3" name="ListPaingType" onClick="ChangeCutPara(3);"> 
按ID直接采集内容</td>
      </tr>
    <tr ID="IndexCutPage">
      <td height=32 align="right" class="hback">采集对象页：</td>
      <td height=7 class="hback"><input name="ListPaingStr" type="text" size="60"></td>
    </tr>
    <tr ID="HandCutPage" style="display:none">
      <td height=32 align="right" class="hback"><span id="CutPageName"></span>：</td>
      <td height=7 class="hback"><input name="ListPaingStr2" type="text" value="" size="60">
        分页代码 <font color=red>{$ID}</font><br>
格式：http://www.qvodzy.com.cn/list.asp?page={$ID}<br>
采集范围：
<input name="ListPaingID1" type="text" value="0" size="4">
 To 
<input name="ListPaingID2" type="text" value="0" size="4">
例如：1 - 9</td>
    </tr>
    <tr ID="ListContent" style="display:none">
      <td height=32 align="right" class="hback">手动分页：</td>
      <td height=7 class="hback"><textarea name="ListPaingStr3" cols="60" rows="7"></textarea></td>
    </tr>
    <tr>
      <td height=32 align="right" class="hback">采集参数：</td>
      <td height=7 class="hback"><input name="SaveFiles" type="checkbox" value="1"> 保存图片 <input name="CollecOrder" type="checkbox" value="1"> 倒序采集 <input name="AdnDinShi" type="checkbox" value="1"> 加入定时采集项目</td>
    </tr>
    <tr>
      <td height=32 align="right" class="hback">过滤选项：</td>
      <td height=16 class="hback"><input name="Script_Iframe" type="checkbox" value="1">
Iframe
<input name="Script_Object" type="checkbox" value="1">
Object
<input name="Script_Script" type="checkbox" value="1">
Script
<input name="Script_Div" type="checkbox"  value="1">
Div
<input name="Script_Class" type="checkbox"  value="1">
Class
<input name="Script_Table" type="checkbox"  value="1">
Table
<input name="Script_Tr" type="checkbox"  value="1">
Tr
<input name="Script_Span" type="checkbox"  value="1">
Span
<input name="Script_Img" type="checkbox" value="1">
Img
<input name="Script_Font" type="checkbox"  value="1">
Font
<input name="Script_A" type="checkbox" value="1">
A
<input name="Script_Html" type="checkbox" value="1">
Html
<input name="Script_Td" type="checkbox"  value="1">
Td </td>
    </tr>
	<tr>
        <td height=32 align="right" class="hback">片源服务器组选择：</td>
        <td height=7 class="hback"><select name="RepeatCollect" style=" width:100px;"><%=EditServerID(0)%></select></td>
	</tr>
	<tr>
        <td height=32 align="right" class="hback">获取影片图片路径：</td>
        <td height=7 class="hback"><select name="AdnPicType" style=" width:100px;"><option value="0">列表页获取</option><option value="1" selected="selected">内容页获取</option></select></td>
	</tr>
      <tr>
        <td height=32 align="right" class="hback">是否开启全局过滤功能：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnReplaceType" checked="checked" onClick="Adnre.style.display='none';"> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnReplaceType" onClick="Adnre.style.display='';"> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="Adnre" style="display:none;">
        <td height=32 align="right" class="hback">替换规则设置：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.AdnReplace.rows>2)document.Form.AdnReplace.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.AdnReplace.rows+=1" style='cursor:hand'><b>扩大</b></span><br><textarea name="AdnReplace" cols="70" rows="6" id="Rurl"></textarea> <br><font color="#FF0000">一行一个替换规则,用$$$隔开 如:163.com$$$pp023.com<br>影片地址不在过滤范围内,请单独设置,不得有空行<br>全局范围:名称/主演/图片路径/分类/地区/简介</font></td>
      </tr>			
    <tr>
      <td height=32 colspan="2" align="center" class="hback"><input type="submit" name="Submit" value="下一步"></td>
    </tr>
  </tbody>
</form>
</table>
<script language="JavaScript">
function ChangeCutPara(Flag)
{
	switch (Flag)
	{
		case 0 :
			document.all.IndexCutPage.style.display='';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='none';
			break;
		case 1 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='';
			document.all.ListContent.style.display='none';
			document.getElementById("CutPageName").innerHTML='批量分页';
			break;
		case 2 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='';
			break;
		case 3 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='';
			document.all.ListContent.style.display='none';
			document.getElementById("CutPageName").innerHTML='按ID采集内容页';
			break;
		default :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='none';
			break;
	}
}
</script>
<%end sub
Sub Add2()
	Select Case Request.Form("ListPaingType")
	Case 0
	    ListUrl=request.Form("ListPaingStr")
	Case 1,3
		ListUrl=Replace(request.Form("ListPaingStr2"),"{$ID}",CStr(request.Form("ListPaingID1")))
	Case 2
	    If  Instr(request.Form("ListPaingStr3"),"|")>0  Then
		    ListUrl=Left(request.Form("ListPaingStr3"),Instr(request.Form("ListPaingStr3"),"|")-1)
		Else
			ListUrl=request.Form("ListPaingStr3")
		End  If
	End Select
	'
	ListCode=GetHttpPage(ListUrl,Request.Form("selEncoding"))
	If ListCode=False Then
		Call Admin_ShowErr("<li>在获取:"&ListUrl&"网页源码时发生错误！</li>","javascript:history.go(-1)",0)
	End If
	Session("ListUrl")=ListUrl
	Session("selEncoding")=Request.Form("selEncoding")
	Session("ListCode")=ListCode
	Set Rs=Server.CreateObject(Adn_Cms_CollConst)
	sql="select * from Collect_Class"
	Rs.open sql,Connx,1,3
	RS.Addnew
	RS("CollectName")=Request.Form("CollectName")
	RS("selEncoding")=Request.Form("selEncoding")
	RS("ListPaingType")=Request.Form("ListPaingType")
	RS("ListPaingStr")=Request.Form("ListPaingStr")
	RS("ListPaingStr2")=Request.Form("ListPaingStr2")
	RS("ListPaingID1")=Request.Form("ListPaingID1")
	RS("ListPaingID2")=Request.Form("ListPaingID2")
	RS("ListPaingStr3")=Request.Form("ListPaingStr3")
	RS("Script_Iframe")=Request.Form("Script_Iframe")
	RS("Script_Object")=Request.Form("Script_Object")
	RS("Script_Script")=Request.Form("Script_Script")
	RS("Script_Div")=Request.Form("Script_Div")
	RS("Script_Class")=Request.Form("Script_Class")
	RS("Script_Table")=Request.Form("Script_Table")
	RS("Script_Tr")=Request.Form("Script_Tr")
	RS("Script_Span")=Request.Form("Script_Span")
	RS("Script_Img")=Request.Form("Script_Img")
	RS("Script_Font")=Request.Form("Script_Font")
	RS("Script_A")=Request.Form("Script_A")
	RS("Script_Html")=Request.Form("Script_Html")
	RS("Script_Td")=Request.Form("Script_Td")
	RS("SaveFiles")=Request.Form("SaveFiles")
	RS("CollecOrder")=Request.Form("CollecOrder")
	RS("RepeatCollect")=Request.Form("RepeatCollect")
	RS("AdnDinShi")=Request.Form("AdnDinShi")
	RS("AdnPicType")=Request.Form("AdnPicType")
	RS("AdnReplaceType")=Request.Form("AdnReplaceType")
	RS("AdnReplace")=Request.Form("AdnReplace")	
	RS.Update
	ID=RS("ID")
	RS.close   
	Set RS=nothing
	If Request.Form("ListPaingType")=3 then
	Response.Redirect "Cai_Vip_Main.asp?Action=Add3&ListPaingType="&Request.Form("ListPaingType")&"&ID="&ID
	End If%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="Form" action="Cai_Vip_Main.asp?Action=Add3" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集列表连接设置>><a href="<%=Session("ListUrl")%>" target="_blank"><%=Session("ListUrl")%></a></td>
      </tr>
      <tr>
        <td width="21%" height=32 align="right" class="hback">影片列表开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.LsString.rows>2)document.Form.LsString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.LsString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="LsString" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片列表结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.LoString.rows>2)document.Form.LoString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.LoString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="LoString" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片链接开始代码：</td>
        <td height=32 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HsString.rows>2)document.Form.HsString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HsString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="HsString" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片链接结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HoString.rows>2)document.Form.HoString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HoString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="HoString" cols="70" rows="7"></textarea></td>
      </tr>
	  <%If Request.Form("AdnPicType")=0 Then%>
       <tr>
        <td height=32 align="right" class="hback">影片图片开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htupian.rows>2)document.Form.Htupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Htupian" cols="70" rows="7" id="Htupian"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片图片结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftupian.rows>2)document.Form.Ftupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Ftupian" cols="70" rows="7" id="Ftupian"></textarea></td>
      </tr>	
	  <%End If%>
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input type="hidden" name="ID" id="ID" value="<%=ID%>">
          <input  type="button" name="button" value="上一步" onClick="window.location.href='javascript:history.go(-1)'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input name="Submit" type="submit" id="Submit" value="下一步"></td>
      </tr>	  
    </tbody>
  </form>
</table>
<%End Sub
Sub Add3()
	If Request.QueryString("ListPaingType")<>"" then
	    Session("NewsCode")=Session("ListCode")
	    ID=Request.QueryString("ID")
		AdnPicType=1
		UrlTest=Session("ListUrl")
	Else
		ListCode=GetBody(Session("ListCode"),request.Form("LsString"),request.Form("LoString"))
		NewsArrayCode=GetArray(ListCode,request.Form("HsString"),request.Form("HoString"))
		Select Case NewsArrayCode
		Case False
			Call Admin_ShowErr("<li>在获取链接列表时出错。</li>","javascript:history.go(-1)",0)
		Case Else
			NewsArray=Split(NewsArrayCode,"$Array$")
			UrlTest=NewsArray(0)
			UrlTest=DefiniteUrl(UrlTest,Session("ListUrl"))
			NewsCode=GetHttpPage(UrlTest,Session("selEncoding"))
			Session("NewsCode")=NewsCode
			Session("ListUrl")=UrlTest
		End Select
		'
		Set Rs=Server.CreateObject(Adn_Cms_CollConst)
		sql="select * from Collect_Class Where ID="&Request.Form("ID")&""
		Rs.open sql,Connx,1,3
		RS("LsString")=Request.Form("LsString")
		RS("LoString")=Request.Form("LoString")
		RS("HsString")=Request.Form("HsString")
		RS("HoString")=Request.Form("HoString")
		If RS("AdnPicType")=0 Then'列表页获取图片时调用
			'列表页取图片
			PicArrayCode=GetArray(ListCode,request.Form("Htupian"),request.Form("Ftupian"))
			Select Case PicArrayCode
			Case False
			Call Admin_ShowErr("<li>在获取图片列表时出错。</li>","javascript:history.go(-1)",0)
			Case Else	
			PicArray=Split(PicArrayCode,"$Array$")
			PicTest=PicArray(0)
			'PicTest=DefiniteUrl(PicTest,Session("ListUrl"))
			Session("PicTest")=PicTest
			End Select
			RS("Htupian")=Request.Form("Htupian")
			RS("Ftupian")=Request.Form("Ftupian")
		End If		
		RS.Update
		ID=RS("ID")
		Htupian=RS("Htupian")
		Ftupian=RS("Ftupian")
		AdnPicType=RS("AdnPicType")
		RS.close   
		Set RS=nothing
	End If%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="Form" action="Cai_Vip_Main.asp?Action=Add4" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集内容与影片地址设置>><a href="<%=UrlTest%>" target="_blank"><%=UrlTest%></a></td>
      </tr>
      <tr>
        <td width="21%" height=32 align="right" class="hback">影片名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htitle.rows>2)document.Form.Htitle.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htitle.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Htitle" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片名称结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftitle.rows>2)document.Form.Ftitle.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftitle.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Ftitle" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片演员开始代码：</td>
        <td height=32 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hname.rows>2)document.Form.Hname.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hname.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Hname" cols="70" rows="7"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片演员结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fname.rows>2)document.Form.Fname.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fname.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Fname" cols="70" rows="7"></textarea></td>
      </tr>
      <tr <%If AdnPicType=0 Then Response.Write "style='display:none'"%>>
        <td height=32 align="right" class="hback">影片图片开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htupian.rows>2)document.Form.Htupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Htupian" cols="70" rows="7" id="Htupian"><%=Htupian%></textarea></td>
      </tr>
      <tr <%If AdnPicType=0 Then Response.Write "style='display:none'"%>>
        <td height=32 align="right" class="hback">影片图片结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftupian.rows>2)document.Form.Ftupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Ftupian" cols="70" rows="7" id="Ftupian"><%=Ftupian%></textarea></td>
      </tr>
	  <tr>
        <td height=32 align="right" class="hback">影片栏目设置：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="ClassType" onClick="ChangeCutPara(0,'CollectClassN','HClassN','FClassN');" checked>
          固定栏目&nbsp;&nbsp; <input type="radio" value="1" name="ClassType" onClick="ChangeCutPara(1,'CollectClassN','HClassN','FClassN');">
按对应栏目自动转换</td>
	  </tr>
	  <tr id="CollectClassN">
        <td height=32 align="right" class="hback">选择栏目：</td>
        <td height=7 class="hback"><select name="CollectClass" id="CollectClass"><%Response.Write EditClassID(0,"","")%></select></td>
      </tr>
      <tr id="HClassN">
        <td height=32 align="right" class="hback">影片栏目开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HClass.rows>2)document.Form.HClass.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HClass.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HClass" cols="70" rows="7" id="HClass"></textarea></td>
      </tr>
      <tr id="FClassN">
        <td height=32 align="right" class="hback">影片栏目结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FClass.rows>2)document.Form.FClass.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FClass.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="FClass" cols="70" rows="7" id="FClass"></textarea></td>
      </tr>	
	  <tr>
        <td height=32 align="right" class="hback">影片地区设置：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="RegionType" onClick="ChangeCutPara(0,'CollectRegionN','HRegionN','FRegionN');" checked>
          固定地区&nbsp;&nbsp; <input type="radio" value="1" name="RegionType" onClick="ChangeCutPara(1,'CollectRegionN','HRegionN','FRegionN');">
按对应地区自动转换</td>
	  </tr>
	  <tr id="CollectRegionN">
        <td height=32 align="right" class="hback">选择地区：</td>
        <td height=7 class="hback"><%Call MovieRegion("CollectRegion","")%></td>
      </tr>
      <tr id="HRegionN">
        <td height=32 align="right" class="hback">影片地区开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HRegion.rows>2)document.Form.HRegion.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HRegion.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HRegion" cols="70" rows="7" id="HRegion"></textarea></td>
      </tr>
      <tr id="FRegionN">
        <td height=32 align="right" class="hback">影片地区结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FRegion.rows>2)document.Form.FRegion.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FRegion.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="FRegion" cols="70" rows="7" id="FRegion"></textarea></td>
      </tr>	
      <tr>
        <td height=32 align="right" class="hback">影片介绍开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hcontent.rows>2)document.Form.Hcontent.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hcontent.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Hcontent" cols="70" rows="7" id="Hcontent"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片介绍结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fcontent.rows>2)document.Form.Fcontent.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fcontent.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Fcontent" cols="70" rows="7" id="Fcontent"></textarea></td>
      </tr>    
	  <tr>
        <td height=32 align="right" class="hback">影片列表范围：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="ScopeOn" checked="checked" onClick="ScopeN1.style.display='none';ScopeN2.style.display='none'">
          关闭&nbsp;&nbsp; <input type="radio" value="1" name="ScopeOn" onClick="ScopeN1.style.display='';ScopeN2.style.display=''">
开启</td>
	  </tr> 
	  <tr id="ScopeN1" style="display:none;">
        <td height=32 align="right" class="hback">播放列表开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hscope.rows>2)document.Form.Hscope.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hscope.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hscope" cols="70" rows="7" id="Hscope"></textarea></td>
      </tr>
       <tr id="ScopeN2" style="display:none;">
        <td height=32 align="right" class="hback">播放列表结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fscope.rows>2)document.Form.Fscope.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fscope.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fscope" cols="70" rows="7" id="Fscope"></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">播放链接开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hweburl.rows>2)document.Form.Hweburl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hweburl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hweburl" cols="70" rows="7" id="Hweburl"></textarea></td>
      </tr>
       <tr>
        <td height=32 align="right" class="hback">播放链接结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fweburl.rows>2)document.Form.Fweburl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fweburl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fweburl" cols="70" rows="7" id="Fweburl"></textarea></td>
      </tr>
       <tr>
        <td height=32 align="right" class="hback">特殊播放链接处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="urlType" checked="checked" onClick="Listurl2.style.display='none';Listurl3.style.display='none'" >
不作设置&nbsp;&nbsp;<input type="radio" value="1" name="urlType" onClick="Listurl2.style.display='';Listurl3.style.display=''" /> 替换地址&nbsp;&nbsp;<input type="radio" value="2" name="urlType" onClick="Listurl2.style.display='none';Listurl3.style.display='none'" /> 不需要新页面获取地址<br>&nbsp;&nbsp;<font color="red">对于使用了JavaScript:openwindow形式的连接请使用以下格式处理:<br>
&nbsp;&nbsp;脚本连接:内容[变量] 内容 如:javaScript:OpenWnd([变量])<br>
&nbsp;&nbsp;实际连接:内容[变量] 内容 如:play.asp?id=[变量]</font></td>
      </tr>
      <tr id="Listurl2" style="display:none;">
        <td height=32 align="right" class="hback">要替换的地址：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Rurl.rows>2)document.Form.Rurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Rurl.rows+=1" style='cursor:hand'><b>扩大</b></span> &nbsp;&nbsp;可用标签：<font onmouseover="getActiveText(document.Form.Rurl);" onClick="addTag('[变量]')" style="CURSOR: hand"><b>[变量]</b></font>
        <textarea name="Rurl" cols="70" rows="4" id="Rurl"></textarea></td>
      </tr>
        <tr id="Listurl3" style="display:none;">
        <td height=32 align="right" class="hback">替换为的地址：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Reurl.rows>2)document.Form.Reurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Reurl.rows+=1" style='cursor:hand'><b>扩大</b></span> &nbsp;&nbsp;可用标签：<font onmouseover="getActiveText(document.Form.Reurl);" onClick="addTag('[变量]')" style="CURSOR: hand"><b>[变量]</b></font>
        <textarea name="Reurl" cols="70" rows="4" id="Reurl"></textarea></td>
      </tr>
	  <!-- -->
      <tr>
        <td height=32 align="right" class="hback">分集名称特殊处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnNameType" checked="checked" onClick="AdnName2.style.display='none';AdnName3.style.display='none'"> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnNameType" onClick="AdnName2.style.display='';AdnName3.style.display=''"> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="AdnName2" style="display:none;">
        <td height=32 align="right" class="hback">分集名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HAdnName.rows>2)document.Form.HAdnName.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HAdnName.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="HAdnName" cols="70" rows="4" id="Rurl"></textarea></td>
      </tr>
      <tr id="AdnName3" style="display:none;">
        <td height=32 align="right" class="hback">分集名称结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FAdnName.rows>2)document.Form.FAdnName.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FAdnName.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="FAdnName" cols="70" rows="4" id="Reurl"></textarea></td>
      </tr>	
	  <!-- --> 	  
      <tr>
        <td height=32 align="right" class="hback">影片地址开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hpurl.rows>2)document.Form.Hpurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hpurl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hpurl" cols="70" rows="7" id="Hpurl"></textarea></td>
      </tr>
       <tr>
        <td height=32 align="right" class="hback">影片地址结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fpurl.rows>2)document.Form.Fpurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fpurl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fpurl" cols="70" rows="7" id="Fpurl"></textarea></td>
      </tr>
	  <!-- -->
      <tr>
        <td height=32 align="right" class="hback">影片地址特殊处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnUrlType" checked="checked" onClick="AdnUrl.style.display='none';"> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnUrlType" onClick="AdnUrl.style.display='';"> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="AdnUrl" style="display:none;">
        <td height=32 align="right" class="hback">分集名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.AdnUrlIntro.rows>2)document.Form.AdnUrlIntro.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.AdnUrlIntro.rows+=1" style='cursor:hand'><b>扩大</b></span><br><textarea name="AdnUrlIntro" cols="70" rows="4" id="Rurl"><%=AdnUrlIntro%></textarea> 一行一个用$$$隔开 如:163.com$$$pp023.com</td>
      </tr>		  
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input name="button"  type="button" id="button" onClick="window.location.href='javascript:history.go(-1)'" value="上一步">
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="hidden" name="ID" id="ID" value="<%=ID%>"><input name="Submit" type="submit" id="Submit" value="下一步"></td>
      </tr>
    </tbody>
  </form>
</table>
<script language="JavaScript">
ChangeCutPara(0,'CollectClassN','HClassN','FClassN');
ChangeCutPara(0,'CollectRegionN','HRegionN','FRegionN');
function ChangeCutPara(Flag,name1,name2,name3)
{
	switch (Flag)
	{
		case 0 :
			document.getElementById(name1).style.display="block";
			document.getElementById(name2).style.display="none";
			document.getElementById(name3).style.display="none";
			break;
		case 1 :
			document.getElementById(name1).style.display="none";
			document.getElementById(name2).style.display="block";
			document.getElementById(name3).style.display="block";
			break;
		default :
			document.getElementById(name1).style.display="none";
			document.getElementById(name2).style.display="none";
			document.getElementById(name3).style.display="none";
			break;
	}
}
</script>
<%end sub
Sub Add4()
Set Rs=Server.CreateObject(Adn_Cms_CollConst)
	sql="select * from Collect_Class Where ID="&Request.Form("ID")&""
	Rs.open sql,Connx,1,3
	RS("Htitle")=Request.Form("Htitle")
	RS("Ftitle")=Request.Form("Ftitle")
	RS("Hname")=Request.Form("Hname")
	RS("Fname")=Request.Form("Fname")
	RS("Htupian")=Request.Form("Htupian")
	RS("Ftupian")=Request.Form("Ftupian")
	RS("ClassType")=Request.Form("ClassType")
	RS("CollectClass")=Request.Form("CollectClass")
	RS("HClass")=Request.Form("HClass")
	RS("FClass")=Request.Form("FClass")
	RS("RegionType")=Request.Form("RegionType")
	RS("CollectRegion")=Request.Form("CollectRegion")
	RS("HRegion")=Request.Form("HRegion")
	RS("FRegion")=Request.Form("FRegion")
	RS("Hcontent")=Request.Form("Hcontent")
	RS("Fcontent")=Request.Form("Fcontent")
	RS("ScopeOn")=Request.Form("ScopeOn")
	RS("Hscope")=Request.Form("Hscope")
	RS("Fscope")=Request.Form("Fscope")
	RS("Hweburl")=Request.Form("Hweburl")
	RS("Fweburl")=Request.Form("Fweburl")
	RS("urlType")=Request.Form("urlType")
	RS("Rurl")=Request.Form("Rurl")
	RS("Reurl")=Request.Form("Reurl")
	RS("Hpurl")=Request.Form("Hpurl")
	RS("Fpurl")=Request.Form("Fpurl")
	RS("AdnNameType")=Request.Form("AdnNameType")
	RS("HAdnName")=Request.Form("HAdnName")
	RS("FAdnName")=Request.Form("FAdnName")	
	RS("AdnUrlType")=Request.Form("AdnUrlType")
	RS("AdnUrlIntro")=Request.Form("AdnUrlIntro")
	RS.Update
	AdnPicType=Rs("AdnPicType")
	AdnUrlType=Rs("AdnUrlType")
	AdnUrlIntro=Rs("AdnUrlIntro")
    AdnReplaceType=RS("AdnReplaceType")
    AdnReplace=RS("AdnReplace")	
	ID=RS("ID")
	RS.close   
	Set RS=nothing

title=GetBody(Session("NewsCode"),request.Form("Htitle"),request.Form("Ftitle"))
name=GetBody(Session("NewsCode"),request.Form("Hname"),request.Form("Fname"))
If AdnPicType=0 Then '列表页获取图片时
    tupian=Session("PicTest"):Session("PicTest")=""
Else
    tupian=GetBody(Session("NewsCode"),request.Form("Htupian"),request.Form("Ftupian"))
End If
If request.Form("ClassType")=1 then
	typeid=GetBody(Session("NewsCode"),request.Form("HClass"),request.Form("FClass"))
	typeidname=typeid
Else
	typeid=Request.Form("CollectClass")
	typeidname=GetClassName(typeid)'取中文分类名
End if
If request.Form("RegionType")=1 then
	region=GetBody(Session("NewsCode"),request.Form("HRegion"),request.Form("FRegion"))
	regionname=region
Else
	regionname=Request.Form("CollectRegion")
	'regionname=CollectRegionName(region)
End if
content=GetBody(Session("NewsCode"),request.Form("Hcontent"),request.Form("Fcontent"))
'是否缩小链接范围
If Request.Form("ScopeOn")=1 then
    Urlscope=GetBody(Session("NewsCode"),request.Form("Hscope"),request.Form("Fscope"))
Else
    Urlscope=Session("NewsCode")
End if
'是否替换全局
If AdnReplaceType=1 Then
    title=ReplaceAdn(title,AdnReplace)
	name=ReplaceAdn(name,AdnReplace)
	tupian=ReplaceAdn(tupian,AdnReplace)
	typeidname=ReplaceAdn(typeidname,AdnReplace)
	regionname=ReplaceAdn(regionname,AdnReplace)
	content=ReplaceAdn(content,AdnReplace)
End If	
%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="form" action="Cai_Vip_Main.asp?Action=AddSever" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集测试效果</td>
      </tr>
      <tr>
        <td width="21%" height=31 align="right" class="hback">影片名称：</td>
        <td height=31 class="hback"><%=title%></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片演员：</td>
        <td height=7 class="hback"><%=name%></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片图片：</td>
        <td height=32 class="hback"><%=tupian%></td>
      </tr>
	  <tr>
        <td height=32 align="right" class="hback">影片栏目：</td>
        <td height=32 class="hback"><%=typeidname%></td>
      </tr>
	  <tr>
        <td height=32 align="right" class="hback">影片地区：</td>
        <td height=32 class="hback"><%=regionname%></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片介绍：</td>
        <td height=7 class="hback"><%=content%></td>
      </tr>
<%
weburl=GetArray(Urlscope,request.Form("Hweburl"),request.Form("Fweburl"))
Response.Write "<!-- "&weburl&" -->"
'''''处理是否自定义分集名称
If request.Form("AdnNameType")=1 Then
    webname=GetArray(Urlscope,request.Form("HAdnName"),request.Form("FAdnName"))
    playArray=Split(webname,"$Array$")
End If
''''''
If weburl<>False Then
	webArray=Split(weburl,"$Array$")
	For i=0 To Ubound(webArray)
	UrlTest=webArray(i)
	If Request.Form("UrlType")=1 then
		Keyurl = Split(Request.Form("Rurl"),"[变量]",-1,1)
		urli=GetBody(UrlTest,Keyurl(0),Keyurl(1))		
		If urli=False Then Exit For End if
		UrlTest=Replace(Request.Form("Reurl"),"[变量]",urli)		
	End If
	UrlTest=DefiniteUrl(UrlTest,Session("ListUrl"))
	'判断新页面or内容页取地址
	If Request.Form("UrlType")=2 Then
		url=webArray(i)
	Else
		webCode=GetHttpPage(UrlTest,Session("selEncoding"))
		url=GetBody(webCode,Request.Form("Hpurl"),request.Form("Fpurl"))
	End If
	'是否替换播放地址
	If AdnUrlType=1 Then url=ReplaceAdn(url,AdnUrlIntro) End If
	'显示分集名称
	If request.Form("AdnNameType")=1 Then Playname=playArray(i)&"|" End If
%><tr>
        <td height=32 align="right" class="hback">播放列表：</td>
        <td height=7 class="hback"><%=UrlTest%></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片地址：</td>
        <td height=7 class="hback"><%=Playname&url%></td>
      </tr>
<%Next
End if%>
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input name="button"  type="button" id="button" onClick="window.location.href='javascript:history.go(-1)'" value="上一步">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<input name="Submit" type="submit" id="Submit" value="完 成"></td>
      </tr>
    </tbody>
  </form>
</table>
<%End sub
Sub Edit()
Set Rs=Server.CreateObject(Adn_Cms_CollConst)
sql="select ID,CollectName,selEncoding,ListPaingStr,ListPaingType,ListPaingStr2,ListPaingID1,ListPaingID2,ListPaingStr3,Script_Iframe,Script_Object,Script_Script,Script_Div,Script_Class,Script_Table,Script_Tr,Script_Span,Script_Img,Script_Font,Script_A,Script_Html,Script_Td,SaveFiles,CollecOrder,RepeatCollect,AdnDinShi,AdnPicType,AdnReplaceType,AdnReplace from Collect_Class where id="&Request.QueryString("id")
RS.open sql,connx,1,1
ID=RS("ID")
CollectName=RS("CollectName")
selEncoding=RS("selEncoding")
ListPaingStr=RS("ListPaingStr")
ListPaingType=RS("ListPaingType")
ListPaingStr2=RS("ListPaingStr2")
ListPaingID1=RS("ListPaingID1")
ListPaingID2=RS("ListPaingID2")
ListPaingStr3=RS("ListPaingStr3")
Script_Iframe=RS("Script_Iframe")
Script_Object=RS("Script_Object")
Script_Script=RS("Script_Script")
Script_Div=RS("Script_Div")
Script_Class=RS("Script_Class")
Script_Table=RS("Script_Table")
Script_Tr=RS("Script_Tr")
Script_Span=RS("Script_Span")
Script_Img=RS("Script_Img")
Script_Font=RS("Script_Font")
Script_A=RS("Script_A")
Script_Html=RS("Script_Html")
Script_Td=RS("Script_Td")
SaveFiles=RS("SaveFiles")
CollecOrder=RS("CollecOrder")
RepeatCollect=RS("RepeatCollect")
AdnDinShi=RS("AdnDinShi")
AdnPicType=RS("AdnPicType")
AdnReplaceType=RS("AdnReplaceType")
AdnReplace=RS("AdnReplace")
RS.close
set RS=nothing%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="Form" action="Cai_Vip_Main.asp?Action=Edit2" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集项目修改</td>
      </tr>
      <tr>
        <td width="21%" height=32 align="right" class="hback">采集名称：</td>
        <td height=7 class="hback"><input name="CollectName" type="text" id="CollectName" value="<%=CollectName%>" size="40"></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">目标编码：</td>
        <td height=7 class="hback"><select name="selEncoding" size="1">
          <option value="GB2312" <%if selEncoding="GB2312" then Response.Write"selected"%>>GB2312</option>
          <option value="UTF-8" <%if selEncoding="UTF-8" then Response.Write"selected"%>>UTF-8</option>
          <option value="BIG5" <%if selEncoding="BIG5" then Response.Write"selected"%>>BIG5</option>
        </select></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">分页设置：</td>
        <td height=32 class="hback"><input type="radio" value="0" name="ListPaingType" checked="checked" onClick="ChangeCutPara(0);" <% if ListPaingType=0 then Response.Write "checked" %>>
不分页&nbsp;&nbsp;
<input type="radio" value="1" name="ListPaingType" onClick="ChangeCutPara(1);" <% if ListPaingType=1 then Response.Write "checked" %>>
批量分页&nbsp;
<input type="radio" value="2" name="ListPaingType" onClick="ChangeCutPara(2);" <% if ListPaingType=2 then Response.Write "checked" %>>
手动分页&nbsp;
<input type="radio" value="3" name="ListPaingType" onClick="ChangeCutPara(3);" <% if ListPaingType=3 then Response.Write "checked" %>>
按ID直接采集内容页</td>
      </tr>
      <tr ID="IndexCutPage">
        <td height=32 align="right" class="hback">采集对象页：</td>
        <td height=7 class="hback"><input name="ListPaingStr" type="text" size="60" value="<%=ListPaingStr%>"></td>
      </tr>
      <tr ID="HandCutPage">
        <td height=32 align="right" class="hback"><span id="CutPageName"></span>：</td>
        <td height=7 class="hback"><input name="ListPaingStr2" type="text" value="<%=ListPaingStr2%>" size="60">
          分页代码 <font color=red>{$ID}</font><br>
          格式：http://www.qvodzy.com.cn/list.asp?page={$ID}<br>
          采集范围：
          <input name="ListPaingID1" type="text" size="4" value="<%=ListPaingID1%>">
           To 
          <input name="ListPaingID2" type="text" size="4" value="<%=ListPaingID2%>">
          例如：1 - 9</td>
      </tr>
      <tr ID="ListContent">
        <td height=32 align="right" class="hback">手动分页：</td>
        <td height=7 class="hback"><textarea name="ListPaingStr3" cols="60" rows="7"><%=ListPaingStr3%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">采集参数：</td>
        <td height=7 class="hback"><input name="SaveFiles" type="checkbox" value="1" <%If SaveFiles=1 Then response.write "checked"%>> 保存图片 <input name="CollecOrder" type="checkbox" value="1" <%If CollecOrder=1 Then response.write "checked"%>> 倒序采集  <input name="AdnDinShi" type="checkbox" value="1" <%If AdnDinShi=1 Then response.write "checked"%>> 加入定时采集项目</td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">过滤选项：</td>
        <td height=16 class="hback"><input name="Script_Iframe" type="checkbox" value="1" <%If Script_Iframe=1 Then response.write "checked"%>>
          Iframe
          <input name="Script_Object" type="checkbox" value="1" <%If Script_Object=1 Then response.write "checked"%>>
          Object
          <input name="Script_Script" type="checkbox" value="1" <%If Script_Script=1 Then response.write "checked"%>>
          Script
          <input name="Script_Div" type="checkbox"  value="1" <%If Script_Div=1 Then response.write "checked"%>>
          Div
          <input name="Script_Class" type="checkbox"  value="1" <%If Script_Class=1 Then response.write "checked"%>>
          Class
          <input name="Script_Table" type="checkbox"  value="1" <%If Script_Table=1 Then response.write "checked"%>>
          Table
          <input name="Script_Tr" type="checkbox"  value="1" <%If Script_Tr=1 Then response.write "checked"%>>
          Tr
          <input name="Script_Span" type="checkbox"  value="1" <%If Script_Span=1 Then response.write "checked"%>>
          Span
          <input name="Script_Img" type="checkbox" value="1" <%If Script_Img=1 Then response.write "checked"%>>
          Img
          <input name="Script_Font" type="checkbox"  value="1" <%If Script_Font=1 Then response.write "checked"%>>
          Font
          <input name="Script_A" type="checkbox" value="1" <%If Script_A=1 Then response.write "checked"%>>
          A
          <input name="Script_Html" type="checkbox" value="1" <%If Script_Html=1 Then response.write "checked"%>>
          Html
          <input name="Script_Td" type="checkbox"  value="1" <%If Script_Td=1 Then response.write "checked"%>>
          Td </td>
      </tr>
	  <tr>
        <td height=32 align="right" class="hback">片源服务器组选择：</td>
        <td height=7 class="hback"><select name="RepeatCollect" style=" width:100px;"><%=EditServerID(RepeatCollect)%></select></td>
	</tr>
	<tr>
        <td height=32 align="right" class="hback">获取影片图片路径：</td>
        <td height=7 class="hback"><select name="AdnPicType" style=" width:100px;"><option value="0">列表页获取</option><option value="1" <%If AdnPicType=1 Then response.write "selected='selected'"%>>内容页获取</option></select></td>
	</tr>
      <tr>
        <td height=32 align="right" class="hback">是否开启全局过滤功能：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnReplaceType" checked="checked" onClick="Adnre.style.display='none';" <% if AdnReplaceType=0 then Response.Write "checked"%>> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnReplaceType" onClick="Adnre.style.display='';" <% if AdnReplaceType=1 then Response.Write "checked"%>> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="Adnre" <% if AdnReplaceType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">替换规则设置：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.AdnReplace.rows>2)document.Form.AdnReplace.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.AdnReplace.rows+=1" style='cursor:hand'><b>扩大</b></span><br><textarea name="AdnReplace" cols="70" rows="4" id="Rurl"><%=AdnReplace%></textarea> <br><font color="#FF0000">一行一个替换规则,用$$$隔开 如:163.com$$$pp023.com<br>影片地址不在过滤范围内,请单独设置,不得有空行<br>全局范围:名称/主演/图片路径/分类/地区/简介</font></td>
      </tr>			
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input type="hidden" name="ID" id="ID" value="<%=ID%>"><input type="submit" name="Submit" value="下一步"></td>
      </tr>
    </tbody>
  </form>
</table>
<script language="JavaScript">
ChangeCutPara(<%=ListPaingType%>);
function ChangeCutPara(Flag)
{
	switch (Flag)
	{
		case 0 :
			document.all.IndexCutPage.style.display='';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='none';
			break;
		case 1 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='';
			document.all.ListContent.style.display='none';
			document.getElementById("CutPageName").innerHTML='批量分页';
			break;
		case 2 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='';
			break;
		case 3 :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='';
			document.all.ListContent.style.display='none';
			document.getElementById("CutPageName").innerHTML='按ID采集内容页';
			break;
		default :
			document.all.IndexCutPage.style.display='none';
			document.all.HandCutPage.style.display='none';
			document.all.ListContent.style.display='none';
			break;
	}
}
</script>
<%end sub
sub Edit2()
Select Case Request.Form("ListPaingType")
	Case 0
		ListUrl=request("ListPaingStr")
	Case 1,3
		ListUrl=Replace(request.Form("ListPaingStr2"),"{$ID}",CStr(request.Form("ListPaingID1")))
	Case 2
		If  Instr(request.Form("ListPaingStr3"),"|")>0  Then
			ListUrl=Left(request.Form("ListPaingStr3"),Instr(request.Form("ListPaingStr3"),"|")-1)
		Else
			ListUrl=request.Form("ListPaingStr3")
		End  If
	End Select
	ListCode=GetHttpPage(ListUrl,Request.Form("selEncoding"))
	  If ListCode=False Then
	  call Admin_ShowErr("<li>在获取:"&ListUrl&"网页源码时发生错误！</li>","javascript:history.go(-1)",0)
	  End If
	Session("ListUrl")=ListUrl
	Session("selEncoding")=Request.Form("selEncoding")
	Session("ListCode")=ListCode
	Set Rs=Server.CreateObject(Adn_Cms_CollConst)
	sql="select * from Collect_Class Where ID="&Request.Form("ID")
	Rs.open sql,Connx,1,3
	RS("CollectName")=Request.Form("CollectName")
	RS("selEncoding")=Request.Form("selEncoding")
	RS("ListPaingType")=Request.Form("ListPaingType")
	RS("ListPaingStr")=Request.Form("ListPaingStr")
	RS("ListPaingStr2")=Request.Form("ListPaingStr2")
	RS("ListPaingID1")=Request.Form("ListPaingID1")
	RS("ListPaingID2")=Request.Form("ListPaingID2")
	RS("ListPaingStr3")=Request.Form("ListPaingStr3")
	RS("Script_Iframe")=Request.Form("Script_Iframe")
	RS("Script_Object")=Request.Form("Script_Object")
	RS("Script_Script")=Request.Form("Script_Script")
	RS("Script_Div")=Request.Form("Script_Div")
	RS("Script_Class")=Request.Form("Script_Class")
	RS("Script_Table")=Request.Form("Script_Table")
	RS("Script_Tr")=Request.Form("Script_Tr")
	RS("Script_Span")=Request.Form("Script_Span")
	RS("Script_Img")=Request.Form("Script_Img")
	RS("Script_Font")=Request.Form("Script_Font")
	RS("Script_A")=Request.Form("Script_A")
	RS("Script_Html")=Request.Form("Script_Html")
	RS("Script_Td")=Request.Form("Script_Td")
	RS("SaveFiles")=Request.Form("SaveFiles")
	RS("CollecOrder")=Request.Form("CollecOrder")
	RS("RepeatCollect")=Request.Form("RepeatCollect")
	RS("AdnDinShi")=Request.Form("AdnDinShi")
	RS("AdnPicType")=Request.Form("AdnPicType")
	RS("AdnReplaceType")=Request.Form("AdnReplaceType")
	RS("AdnReplace")=Request.Form("AdnReplace")
	RS.Update
	ID=RS("ID")
	LsString=RS("LsString")
	LoString=RS("LoString")
	HsString=RS("HsString")
	HoString=RS("HoString")
	Htupian=RS("Htupian")
	Ftupian=RS("Ftupian")
	RS.close   
	set RS=nothing
	if Request.Form("ListPaingType")=3 then
	Response.Redirect"Cai_Vip_Main.asp?Action=Edit3&ListPaingType="&Request.Form("ListPaingType")&"&ID="&ID
	Response.end()
	end if%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="Form" action="Cai_Vip_Main.asp?Action=Edit3" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集列表连接设置>><a href="<%=Session("ListUrl")%>" target="_blank"><%=Session("ListUrl")%></a></td>
      </tr>
      <tr>
        <td width="21%" height=32 align="right" class="hback">影片列表开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.LsString.rows>2)document.Form.LsString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.LsString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="LsString" cols="70" rows="7"><%=LsString%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片列表结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.LoString.rows>2)document.Form.LoString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.LoString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="LoString" cols="70" rows="7"><%=LoString%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片链接开始代码：</td>
        <td height=32 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HsString.rows>2)document.Form.HsString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HsString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HsString" cols="70" rows="7"><%=HsString%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片链接结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HoString.rows>2)document.Form.HoString.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HoString.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HoString" cols="70" rows="7"><%=HoString%></textarea></td>
      </tr>
	  <%If Request.Form("AdnPicType")=0 Then%>
       <tr>
        <td height=32 align="right" class="hback">影片图片开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htupian.rows>2)document.Form.Htupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Htupian" cols="70" rows="7" id="Htupian"><%=Htupian%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片图片结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftupian.rows>2)document.Form.Ftupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
        <textarea name="Ftupian" cols="70" rows="7" id="Ftupian"><%=Ftupian%></textarea></td>
      </tr>	
	  <%End If%>
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input type="hidden" name="ID" id="ID" value="<%=ID%>"><input  type="button" name="button" value="上一步" onClick="window.location.href='javascript:history.go(-1)'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input name="Submit" type="submit" id="Submit" value="下一步"></td>
      </tr>	  	  
    </tbody>
  </form>
</table>
<%End Sub
Sub Edit3()
	If Request.QueryString("ListPaingType")<>"" then
	Session("NewsCode")=Session("ListCode")
	UrlTest=Session("ListUrl")
	Else
	ListCode=GetBody(Session("ListCode"),request.Form("LsString"),request.Form("LoString"))
	NewsArrayCode=GetArray(ListCode,request.Form("HsString"),request.Form("HoString"))
	Select Case NewsArrayCode
	Case False
		Call Admin_ShowErr("<li>在获取链接列表时出错。</li>","javascript:history.go(-1)",0)
	Case Else
		NewsArray=Split(NewsArrayCode,"$Array$")
		UrlTest=NewsArray(0)
		UrlTest=DefiniteUrl(UrlTest,Session("ListUrl"))
		NewsCode=GetHttpPage(UrlTest,Session("selEncoding"))
		Session("NewsCode")=NewsCode
		Session("ListUrl")=UrlTest
	End Select
	End If
	Set Rs=Server.CreateObject(Adn_Cms_CollConst)
	sql="select * from Collect_Class Where ID="&Request("ID")&""
	Rs.open sql,Connx,1,3
	RS("LsString")=Request.Form("LsString")
	RS("LoString")=Request.Form("LoString")
	RS("HsString")=Request.Form("HsString")
	RS("HoString")=Request.Form("HoString")
If RS("AdnPicType")=0 Then'列表页获取图片时调用
	'列表页取图片
	PicArrayCode=GetArray(ListCode,request.Form("Htupian"),request.Form("Ftupian"))
	Select Case PicArrayCode
	Case False
	Call Admin_ShowErr("<li>在获取图片列表时出错。</li>","javascript:history.go(-1)",0)
	Case Else	
	PicArray=Split(PicArrayCode,"$Array$")
	PicTest=PicArray(0)
	'PicTest=DefiniteUrl(PicTest,Session("ListUrl"))
	Session("PicTest")=PicTest
	End Select
	RS("Htupian")=Request.Form("Htupian")
	RS("Ftupian")=Request.Form("Ftupian")	
End If
	RS.Update
	ID=RS("ID")
	Htitle=RS("Htitle")
	Ftitle=RS("Ftitle")
	Hname=RS("Hname")
	Fname=RS("Fname")
	Htupian=RS("Htupian")
	Ftupian=RS("Ftupian")
	RegionType=RS("RegionType")
	CollectRegion=RS("CollectRegion")
	HRegion=RS("HRegion")
	FRegion=RS("FRegion")
	ClassType=RS("ClassType")
	CollectClass=RS("CollectClass")
	HClass=RS("HClass")
	FClass=RS("FClass")
	Hcontent=RS("Hcontent")
	Fcontent=RS("Fcontent")
	ScopeOn=RS("ScopeOn")
	Hscope=RS("Hscope")
	Fscope=RS("Fscope")
	Hweburl=RS("Hweburl")
	Fweburl=RS("Fweburl")
	urlType=RS("urlType")
	Rurl=RS("Rurl")
	Reurl=RS("Reurl")
	Hpurl=RS("Hpurl")
	Fpurl=RS("Fpurl")
	AdnPicType=RS("AdnPicType")	
	AdnNameType=RS("AdnNameType")
	HAdnName=RS("HAdnName")
	FAdnName=RS("FAdnName")
	AdnUrlType=RS("AdnUrlType")
	AdnUrlIntro=RS("AdnUrlIntro")
	RS.close   
	Set RS=nothing%>
<table class=table cellspacing=1 cellpadding=3 width="98%" align=center border=0>
  <form name="Form" action="Cai_Vip_Main.asp?Action=Add4" method="post">
    <tbody>
      <tr>
        <td colspan="2" class=xingmu>采集内容与影片地址设置>><a href="<%=UrlTest%>" target="_blank"><%=UrlTest%></a></td>
      </tr>
      <tr>
        <td width="21%" height=32 align="right" class="hback">影片名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htitle.rows>2)document.Form.Htitle.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htitle.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Htitle" cols="70" rows="7" id="Htitle"><%=Htitle%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片名称结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftitle.rows>2)document.Form.Ftitle.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftitle.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Ftitle" cols="70" rows="7" id="Ftitle"><%=Ftitle%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片演员开始代码：</td>
        <td height=32 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hname.rows>2)document.Form.Hname.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hname.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hname" cols="70" rows="7" id="Hname"><%=Hname%></textarea></td>
      </tr>	  
      <tr>
        <td height=32 align="right" class="hback">影片演员结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fname.rows>2)document.Form.Fname.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fname.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fname" cols="70" rows="7" id="Fname"><%=Fname%></textarea></td>
      </tr>		  
      <tr <%If AdnPicType=0 Then Response.Write "style='display:none'"%>>
        <td height=32 align="right" class="hback">影片图片开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Htupian.rows>2)document.Form.Htupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Htupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Htupian" cols="70" rows="7" id="Htupian"><%=Htupian%></textarea></td>
      </tr>
      <tr <%If AdnPicType=0 Then Response.Write "style='display:none'"%>>
        <td height=32 align="right" class="hback">影片图片结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Ftupian.rows>2)document.Form.Ftupian.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Ftupian.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Ftupian" cols="70" rows="7" id="Ftupian"><%=Ftupian%></textarea></td>
      </tr> 
	  <tr>
        <td height=32 align="right" class="hback">影片栏目设置：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="ClassType" onClick="ChangeCutPara(0,'CollectClassN','HClassN','FClassN');" <% if ClassType=0 then Response.Write "checked" %>>固定栏目&nbsp;&nbsp; <input type="radio" value="1" name="ClassType" onClick="ChangeCutPara(1,'CollectClassN','HClassN','FClassN');" <% if ClassType=1 then Response.Write "checked" %>>按对应栏目自动转换</td>
	  </tr>
	  <tr id="CollectClassN">
        <td height=32 align="right" class="hback">选择栏目：</td>
        <td height=7 class="hback"><select name="CollectClass" id="CollectClass"><%Response.Write EditClassID(0,"",CollectClass)%></select></td>
      </tr>
      <tr id="HClassN">
        <td height=32 align="right" class="hback">影片栏目开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HClass.rows>2)document.Form.HClass.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HClass.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HClass" cols="70" rows="7" id="HClass"><%=HClass%></textarea></td>
      </tr>
      <tr id="FClassN">
        <td height=32 align="right" class="hback">影片栏目结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FClass.rows>2)document.Form.FClass.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FClass.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="FClass" cols="70" rows="7" id="FClass"><%=FClass%></textarea></td>
      </tr>	
	  <tr>
        <td height=32 align="right" class="hback">影片地区设置：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="RegionType" onClick="ChangeCutPara(0,'CollectRegionN','HRegionN','FRegionN');" <% if RegionType=0 then Response.Write "checked" %>>固定地区&nbsp;&nbsp; <input type="radio" value="1" name="RegionType" onClick="ChangeCutPara(1,'CollectRegionN','HRegionN','FRegionN');" <% if RegionType=1 then Response.Write "checked" %>>按对应地区自动转换</td>
	  </tr>
	  <tr id="CollectRegionN">
        <td height=32 align="right" class="hback">选择地区：</td>
        <td height=7 class="hback"><%Call MovieRegion("CollectRegion",CollectRegion)%></td>
      </tr>
      <tr id="HRegionN">
        <td height=32 align="right" class="hback">影片地区开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HRegion.rows>2)document.Form.HRegion.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HRegion.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="HRegion" cols="70" rows="7" id="HRegion"><%=HRegion%></textarea></td>
      </tr>
      <tr id="FRegionN">
        <td height=32 align="right" class="hback">影片地区结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FRegion.rows>2)document.Form.FRegion.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FRegion.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="FRegion" cols="70" rows="7" id="FRegion"><%=FRegion%></textarea></td>
      </tr>	
      <tr>
        <td height=32 align="right" class="hback">影片介绍开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hcontent.rows>2)document.Form.Hcontent.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hcontent.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hcontent" cols="70" rows="7" id="Hcontent"><%=Hcontent%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片介绍结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fcontent.rows>2)document.Form.Fcontent.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fcontent.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fcontent" cols="70" rows="7" id="Fcontent"><%=Fcontent%></textarea></td>
      </tr>
	  <tr>
        <td height=32 align="right" class="hback">影片列表范围：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="ScopeOn" onClick="ScopeN1.style.display='none';ScopeN2.style.display='none'" <% if ScopeOn=0 then Response.Write "checked" %>>          
        关闭&nbsp;&nbsp; <input type="radio" value="1" name="ScopeOn" onClick="ScopeN1.style.display='';ScopeN2.style.display=''" <% if ScopeOn=1 then Response.Write "checked" %>> 
        开启</td>
	  </tr> 
	  <tr id="ScopeN1" <% if ScopeOn<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">播放列表开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hscope.rows>2)document.Form.Hscope.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hscope.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hscope" cols="70" rows="7" id="Hscope"><%=Hscope%></textarea></td>
      </tr>
       <tr id="ScopeN2" <% if ScopeOn<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">播放列表结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fscope.rows>2)document.Form.Fscope.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fscope.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fscope" cols="70" rows="7" id="Fscope"><%=Fscope%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">播放链接开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hweburl.rows>2)document.Form.Hweburl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hweburl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hweburl" cols="70" rows="7" id="Hweburl"><%=Hweburl%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">播放链接结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fweburl.rows>2)document.Form.Fweburl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fweburl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fweburl" cols="70" rows="7" id="Fweburl"><%=Fweburl%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">播放链接特殊处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="urlType" checked="checked" onClick="Listurl2.style.display='none';Listurl3.style.display='none'" <% if urlType=0 then Response.Write "checked"%>> 不作设置&nbsp;&nbsp;<input type="radio" value="1" name="urlType" onClick="Listurl2.style.display='';Listurl3.style.display=''" <% if urlType=1 then Response.Write "checked"%>> 替换地址&nbsp;&nbsp;<input type="radio" value="2" name="urlType" onClick="Listurl2.style.display='none';Listurl3.style.display='none'" <% if urlType=2 then Response.Write "checked"%>> 不需要新页面获取地址<br>
          &nbsp;&nbsp;<font color="red">对于使用了JavaScript:openwindow形式的连接请使用以下格式处理:<br>
          &nbsp;&nbsp;脚本连接:内容[变量] 内容 如:javaScript:OpenWnd([变量])<br>
          &nbsp;&nbsp;实际连接:内容[变量] 内容 如:play.asp?id=[变量]</font></td>
      </tr>
      <tr id="Listurl2" <% if urlType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">要替换的地址：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Rurl.rows>2)document.Form.Rurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Rurl.rows+=1" style='cursor:hand'><b>扩大</b></span> &nbsp;&nbsp;可用标签：<font onmouseover="getActiveText(document.Form.Rurl);" onClick="addTag('[变量]')" style="CURSOR: hand"><b>[变量]</b></font>
          <textarea name="Rurl" cols="70" rows="4" id="Rurl"><%=Rurl%></textarea></td>
      </tr>
      <tr id="Listurl3" <% if urlType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">替换为的地址：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Reurl.rows>2)document.Form.Reurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Reurl.rows+=1" style='cursor:hand'><b>扩大</b></span> &nbsp;&nbsp;可用标签：<font onmouseover="getActiveText(document.Form.Reurl);" onClick="addTag('[变量]')" style="CURSOR: hand"><b>[变量]</b></font>
          <textarea name="Reurl" cols="70" rows="4" id="Reurl"><%=Reurl%></textarea></td>
      </tr>
	  <!-- -->
      <tr>
        <td height=32 align="right" class="hback">分集名称特殊处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnNameType" checked="checked" onClick="AdnName2.style.display='none';AdnName3.style.display='none'" <% if AdnNameType=0 then Response.Write "checked"%>> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnNameType" onClick="AdnName2.style.display='';AdnName3.style.display=''" <% if AdnNameType=1 then Response.Write "checked"%>> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="AdnName2" <% if AdnNameType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">分集名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.HAdnName.rows>2)document.Form.HAdnName.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.HAdnName.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="HAdnName" cols="70" rows="4" id="Rurl"><%=HAdnName%></textarea></td>
      </tr>
      <tr id="AdnName3" <% if AdnNameType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">分集名称结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.FAdnName.rows>2)document.Form.FAdnName.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.FAdnName.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
		<textarea name="FAdnName" cols="70" rows="4" id="Reurl"><%=FAdnName%></textarea></td>
      </tr>	
	  <!-- -->  
      <tr>
        <td height=32 align="right" class="hback">影片地址开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Hpurl.rows>2)document.Form.Hpurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Hpurl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Hpurl" cols="70" rows="7" id="Hpurl"><%=Hpurl%></textarea></td>
      </tr>
      <tr>
        <td height=32 align="right" class="hback">影片地址结束代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.Fpurl.rows>2)document.Form.Fpurl.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.Fpurl.rows+=1" style='cursor:hand'><b>扩大</b></span><br>
          <textarea name="Fpurl" cols="70" rows="7" id="Fpurl"><%=Fpurl%></textarea></td>
      </tr>
	  <!-- -->
      <tr>
        <td height=32 align="right" class="hback">影片地址特殊处理：</td>
        <td height=7 class="hback"><input type="radio" value="0" name="AdnUrlType" checked="checked" onClick="AdnUrl.style.display='none';" <% if AdnUrlType=0 then Response.Write "checked"%>> 关闭&nbsp;&nbsp;<input type="radio" value="1" name="AdnUrlType" onClick="AdnUrl.style.display='';" <% if AdnUrlType=1 then Response.Write "checked"%>> 开启&nbsp;&nbsp;</td>
      </tr>
      <tr id="AdnUrl" <% if AdnUrlType<>1 then Response.Write "style=""display:none""" %>>
        <td height=32 align="right" class="hback">分集名称开始代码：</td>
        <td height=7 class="hback">&nbsp;&nbsp;输入区域： <span onClick="if(document.Form.AdnUrlIntro.rows>2)document.Form.AdnUrlIntro.rows-=1" style='cursor:hand'><b>缩小</b></span> <span onClick="document.Form.AdnUrlIntro.rows+=1" style='cursor:hand'><b>扩大</b></span><br><textarea name="AdnUrlIntro" cols="70" rows="4" id="Rurl"><%=AdnUrlIntro%></textarea> 一行一个用$$$隔开 如:163.com$$$pp023.com</td>
      </tr>	  
	  <!-- -->
      <tr>
        <td height=32 colspan="2" align="center" class="hback"><input name="button"  type="button" id="button" onClick="window.location.href='javascript:history.go(-1)'" value="上一步">
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="hidden" name="ID" id="ID" value="<%=ID%>">
          <input name="Submit" type="submit" id="Submit" value="下一步"></td>
      </tr>
    </tbody>
  </form>
</table>
<script language="JavaScript">
ChangeCutPara(<%=ClassType%>,'CollectClassN','HClassN','FClassN');
ChangeCutPara(<%=RegionType%>,'CollectRegionN','HRegionN','FRegionN');
function ChangeCutPara(Flag,name1,name2,name3)
{
	switch (Flag)
	{
		case 0 :
			document.getElementById(name1).style.display="block";
			document.getElementById(name2).style.display="none";
			document.getElementById(name3).style.display="none";
			break;
		case 1 :
			document.getElementById(name1).style.display="none";
			document.getElementById(name2).style.display="block";
			document.getElementById(name3).style.display="block";
			break;
		default :
			document.getElementById(name1).style.display="none";
			document.getElementById(name2).style.display="none";
			document.getElementById(name3).style.display="none";
			break;
	}
}
</script>
<%End sub
Sub Copy()
		Set RsCopy = Connx.Execute("Select * from Collect_Class where ID="&Request.QueryString("ID"))
		if not RsCopy.eof then
			Set Rs = Server.CreateObject(Adn_Cms_CollConst)
			Rs.Open "Select * from Collect_Class",Connx,1,3
			Rs.AddNew
			For Each Filed In Rs.Fields
				if LCase(Filed.name) <> "id" then
				if LCase(Filed.name) = "collectname" then
					Rs(Filed.name) = RsCopy(Filed.name)&"-[复制]"
				else
					Rs(Filed.name) = RsCopy(Filed.name)
				end if
				end if
			Next
			Rs.Update
			Rs.MoveNext
		Set Rs= Nothing
		end if
		Set RsCopy  = Nothing
	call Admin_ShowErr("<li>复制采集栏目成功！</li>","Cai_Vip_Main.asp",1)
End Sub%>
<script language="JavaScript">
currObj = "uuuu";
function getActiveText(obj)
{
	obj.focus();
	currObj = obj;
}

function addTag(ibTag)
{
	var isClose = false;
	var obj_ta = currObj;
	if (obj_ta.isTextEdit)
	{
		obj_ta.focus();
		var sel = document.selection;
		var rng = sel.createRange();
		rng.colapse;

		if((sel.type == "Text" || sel.type == "None") && rng != null)
		{
			rng.text = ibTag;
		}
		obj_ta.focus();
		return isClose;
	}
	else return false;
}	
</script>
<%call connxclose()%>
</BODY></HTML>