<!-- #include file="codePage.asp" -->
<!-- #include file="check.asp" -->
<!-- #include file="../cache/system.asp" -->
<!-- #include file="../cache/userSys.asp" -->
<!-- #include file="../cache/infoSys.asp" -->
<!-- #include file="ckeditor/ckeditor.asp" -->
<%
Call CheckIframe()

'**** 版权所有 ****

' 网钛文章管理系统(OTCMS)
' 程序开发：网钛科技
' 官方网站：http://otcms.com
' 联系ＱＱ：877873666
' 联系邮箱：877873666@qq.com

'**** 版权所有 ****


'打开用户表，并检测用户是否登陆
Call OpenMemberexe(",MB_realname","login",0)

Call WebStyleTop("")

response.write(_
"<script language='javascript' type='text/javascript' src='js/inc/list.js'></script>"&_
"<script language='javascript' type='text/javascript' src='js/inc/trim.js'></script>"&_
"<script language='javascript' type='text/javascript' src='js/info.js'></script>"&_
"")





If mudi="manage" Or mudi="manage2" Then
	%><!-- #include file="inc/file_info.asp" --><%
End If

Select Case mudi
	Case "add"
		Call IsSecMenuRight("alertBack",9,dataType)
		Call AddOrRev()

	Case "rev"
		Call IsSecMenuRight("alertBack",10,dataType)
		Call AddOrRev()

	Case "manage"
		Call IsSecMenuRight("alertBack",51,dataType)
		Call manage()

	Case "manage2"
		Call IsSecMenuRight("alertBack",51,dataType)
		Call manage2()
End Select


Call CloseMemberexe()
Call CloseConobj()
Call WebStyleBottom()









'新增、修改信息
Private Sub AddOrRev()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")
	backURL		= ToGetStr("backURL")
	dataID		= ToGetInt("dataID")


	If mudi="rev" Then
		Set revexe=conobj.execute("select top 1 IF_ID,IF_time,IF_typeStr,IF_type1ID,IF_source,IF_writer,IF_theme,IF_themeColor,IF_URL,IF_themeKey,IF_contentKey,IF_content,IF_upImgStr,IF_pageNum,IF_isAudit,IF_isNew,IF_isHomeThumb,IF_isThumb,IF_isImg,IF_isFlash,IF_isMarquee,IF_isRecom,IF_isTop,IF_img,IF_fileName,IF_file,IF_voteMode,IF_voteStr,IF_isMarkNews,IF_isReply,IF_addiID,IF_readNum,IF_state,IF_userID,IF_isCheckUser,IF_userGroupID,IF_userLevel,IF_score1,IF_score2,IF_score3,IF_score4,IF_score5,IF_cutScore1,IF_cutScore2,IF_cutScore3,IF_cutScore4,IF_cutScore5 from OT_info where IF_ID="& dataID)
			If revexe.EOF Then
				Call JS_AlertBackEnd("无该记录！")
			End If
		IF_ID			= revexe("IF_ID")
		IF_time			= revexe("IF_time")
		IF_typeStr		= revexe("IF_typeStr")
		IF_type1ID		= revexe("IF_type1ID")
		IF_source		= revexe("IF_source")
		IF_writer		= revexe("IF_writer")
		IF_theme		= revexe("IF_theme")
		IF_themeColor	= revexe("IF_themeColor")
		IF_URL			= revexe("IF_URL")
		IF_themeKey		= revexe("IF_themeKey")
		IF_contentKey	= revexe("IF_contentKey")
		IF_content		= revexe("IF_content")
		IF_upImgStr		= revexe("IF_upImgStr")
		IF_pageNum		= revexe("IF_pageNum")
		IF_isAudit		= revexe("IF_isAudit")
		IF_isNew		= revexe("IF_isNew")
		IF_isHomeThumb	= revexe("IF_isHomeThumb")
		IF_isThumb		= revexe("IF_isThumb")
		IF_isImg		= revexe("IF_isImg")
		IF_isFlash		= revexe("IF_isFlash")
		IF_isMarquee	= revexe("IF_isMarquee")
		IF_isRecom		= revexe("IF_isRecom")
		IF_isTop		= revexe("IF_isTop")
		IF_img			= revexe("IF_img")
		IF_fileName		= revexe("IF_fileName")
		IF_file			= revexe("IF_file")
		IF_voteMode		= revexe("IF_voteMode")
		IF_voteStr		= revexe("IF_voteStr")
		IF_isMarkNews	= revexe("IF_isMarkNews")
		IF_isReply		= revexe("IF_isReply")
		IF_addiID		= revexe("IF_addiID")
		IF_readNum		= revexe("IF_readNum")
		IF_state		= revexe("IF_state")
		beforeURL=GetCurrUrlDir(1)
		imgUrl=beforeURL & InfoImgDir
		IF_content		= Replace(""& IF_content,InfoImgAdminDir,imgUrl)
		IF_userID		= revexe("IF_userID")
		IF_isCheckUser	= revexe("IF_isCheckUser")
		ID_userGroupID	= revexe("IF_userGroupID")
		IF_userLevel	= revexe("IF_userLevel")
		IF_score1		= revexe("IF_score1")
		IF_score2		= revexe("IF_score2")
		IF_score3		= revexe("IF_score3")
		IF_score4		= revexe("IF_score4")
		IF_score5		= revexe("IF_score5")
		IF_cutScore1	= revexe("IF_cutScore1")
		IF_cutScore2	= revexe("IF_cutScore2")
		IF_cutScore3	= revexe("IF_cutScore3")
		IF_cutScore4	= revexe("IF_cutScore4")
		IF_cutScore5	= revexe("IF_cutScore5")
		revexe.close
		Set revexe=Nothing

		mudiCN="修改"
	Else
		If dataID>0 Then
			Set revexe=conobj.execute("select top 1 IF_ID,IF_time,IF_typeStr,IF_type1ID,IF_source,IF_writer,IF_theme,IF_themeColor,IF_URL,IF_themeKey,IF_contentKey,IF_content,IF_upImgStr,IF_pageNum,IF_isAudit,IF_isNew,IF_isHomeThumb,IF_isThumb,IF_isImg,IF_isFlash,IF_isMarquee,IF_isRecom,IF_isTop,IF_img,IF_fileName,IF_file,IF_voteMode,IF_voteStr,IF_isMarkNews,IF_isReply,IF_addiID,IF_readNum,IF_state,IF_userID,IF_isCheckUser,IF_userGroupID,IF_userLevel,IF_score1,IF_score2,IF_score3,IF_score4,IF_score5,IF_cutScore1,IF_cutScore2,IF_cutScore3,IF_cutScore4,IF_cutScore5 from OT_info where IF_ID="& dataID)
				If Not revexe.EOF Then
'					IF_ID			= revexe("IF_ID")
'					IF_time			= revexe("IF_time")
					IF_typeStr		= revexe("IF_typeStr")
					IF_type1ID		= revexe("IF_type1ID")
					IF_source		= revexe("IF_source")
					IF_writer		= revexe("IF_writer")
'					IF_theme		= revexe("IF_theme")
					IF_themeColor	= revexe("IF_themeColor")
					IF_URL			= revexe("IF_URL")
'					IF_themeKey		= revexe("IF_themeKey")
'					IF_contentKey	= revexe("IF_contentKey")
'					IF_content		= revexe("IF_content")
'					IF_upImgStr		= revexe("IF_upImgStr")
					IF_pageNum		= revexe("IF_pageNum")
					IF_isAudit		= revexe("IF_isAudit")
					IF_isNew		= revexe("IF_isNew")
					IF_isHomeThumb	= revexe("IF_isHomeThumb")
					IF_isThumb		= revexe("IF_isThumb")
					IF_isImg		= revexe("IF_isImg")
					IF_isFlash		= revexe("IF_isFlash")
					IF_isMarquee	= revexe("IF_isMarquee")
					IF_isRecom		= revexe("IF_isRecom")
					IF_isTop		= revexe("IF_isTop")
'					IF_img			= revexe("IF_img")
'					IF_fileName		= revexe("IF_fileName")
'					IF_file			= revexe("IF_file")
					IF_voteMode		= revexe("IF_voteMode")
					IF_voteStr		= revexe("IF_voteStr")
					IF_isMarkNews	= revexe("IF_isMarkNews")
					IF_isReply		= revexe("IF_isReply")
					IF_addiID		= revexe("IF_addiID")
					IF_readNum		= revexe("IF_readNum")
					IF_state		= revexe("IF_state")
'					beforeURL=GetCurrUrlDir(1)
'					imgUrl=beforeURL & InfoImgDir
'					IF_content		= Replace(IF_content,InfoImgAdminDir,imgUrl)
					IF_userID		= revexe("IF_userID")
					IF_isCheckUser	= revexe("IF_isCheckUser")
					ID_userGroupID	= revexe("IF_userGroupID")
					IF_userLevel	= revexe("IF_userLevel")
					IF_score1		= revexe("IF_score1")
					IF_score2		= revexe("IF_score2")
					IF_score3		= revexe("IF_score3")
					IF_score4		= revexe("IF_score4")
					IF_score5		= revexe("IF_score5")
					IF_cutScore1	= revexe("IF_cutScore1")
					IF_cutScore2	= revexe("IF_cutScore2")
					IF_cutScore3	= revexe("IF_cutScore3")
					IF_cutScore4	= revexe("IF_cutScore4")
					IF_cutScore5	= revexe("IF_cutScore5")
				End If
			revexe.close
			Set revexe=Nothing
			dataID = 0

		Else
			IF_pageNum		= 0
			IF_isAudit		= IS_defIsAudit
			IF_isNew		= IS_defIsNew
			IF_isHomeThumb	= IS_defIsHomeThumb
			IF_isThumb		= IS_defIsThumb
			IF_isImg		= IS_defIsImg
			IF_isFlash		= IS_defIsFlash
			IF_isMarquee	= IS_defIsMarquee
			IF_isRecom		= IS_defIsRecom
			IF_isTop		= IS_defIsTop
			IF_isMarkNews	= IS_defMarkNews
			IF_voteMode		= IS_defVoteMode
			IF_voteStr		= IS_defVoteStr
			IF_isReply		= IS_defIsReply
			IF_addiID		= IS_defAddiID
			IF_readNum		= IS_defReadNum
			IF_state		= 1
			IF_userID		= 0
		End If
		mudiCN="添加"
	End If

	If IF_time="" Then IF_time=Now()

	voteItemArr=Array(0,0,0,0,0,0,0,0)
	voteArr = Split(""& IF_voteStr,",")
	For i=0 To UBound(voteArr)
		voteItemArr(i)=voteArr(i)
	Next
	

	response.write(_
	"<form name='addform' method='post' action='info_deal.asp?mudi="& mudi &"&nohrefStr=close' onsubmit='return CheckForm()'>"&_
	"<input type='hidden' id='dataID' name='dataID' value='"& IF_ID &"' />"&_
	"<input type='hidden' id='dataType' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' id='dataTypeCN' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"<input type='hidden' id='dataMode' name='dataMode' value='"& dataMode &"' />"&_
	"<input type='hidden' id='dataModeStr' name='dataModeStr' value='"& dataModeStr &"' />"&_
	"")
		If backURL<>"" Then
			response.write(_
			"<input type='hidden' id='backURL' name='backURL' value='"& backURL &"' />")
		Else
			response.write(_
			"<script language='javascript' type='text/javascript'>document.write(""<input type='hidden' id='backURL' name='backURL' value='""+ document.location.href +""' />"")</script>")
		End If

	Call ShareTableTop("share_"& mudi &".gif","",mudiCN & dataTypeCN)
		response.write(_
		"<table width='98%' align='center' cellpadding='0' cellspacing='0' summary='' class='padd3'>"&_
		"<tr>"&_
			"<td width='12%'></td>"&_
			"<td width='88%'></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"发布时间：</td>"&_
			"<td align='left'><input type='text' id='time' name='time' size='22' style='width:170px;' value='"& IF_time &"' onfocus=""WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss'})"" class='Wdate' /></td>"&_
		"</tr>"&_
		"")
			If IF_userID>0 Then
				userStr = ""
				Set userexe=conobj.execute("select UE_username,UE_realname from OT_users where UE_ID="& IF_userID)
					If userexe.EOF Then
						userStr = "[不存在]"
					Else
						userStr = userexe("UE_username") &"("& userexe("UE_realname") &")"
					End If
				userexe.close
				Set userexe=Nothing
		response.write(_
		"<tr>"&_
			"<td align='right' style='color:red;'>发表会员：</td>"&_
			"<td align='left'>"& userStr &"</td>"&_
		"</tr>"&_
		"")
			End If

		response.write(_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"文章标题：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='theme' name='theme' size='50' style='width:400px;' value="""& ReplaceStr(IF_theme,"input") &""" />"&_
				"&nbsp;&nbsp;&nbsp;"&_
				"标题颜色：<input type='text' id='themeColor' name='themeColor' style='width:55px;color:"& IF_themeColor &"' value="""& IF_themeColor &""" />"& UseColorBox("input","themeColor") &_
				"&nbsp;&nbsp;<a href='javascript:void(0);' onclick='CheckRepeatTheme();return false;' class='font1_2' style='text-decoration:underline;'>检测重复标题</a>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>来源：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='source' name='source' size='50' style='width:400px;' value="""& ReplaceStr(IF_source,"input") &""" />"&_
				"&nbsp;&lt;=&nbsp;"&_
				"<select id='sourceItem' name='sourceItem' onchange=""ToSource('')"">"&_
				"")
				Set sourceexe = conobj.execute("select TP_theme from OT_type where TP_type='source' order by TP_rank ASC")
					Do Until sourceexe.EOF
						response.write(_
						"<option value="""& sourceexe("TP_theme") &""">"& sourceexe("TP_theme") &"</option>"&_
						"")
					sourceexe.movenext()
					Loop
				sourceexe.close
				Set sourceexe=Nothing
				response.write(_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>作者：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='writer' name='writer' size='50' style='width:400px;' value="""& ReplaceStr(IF_writer,"input") &""" />"&_
				"&nbsp;&lt;=&nbsp;"&_
				"<select id='writerItem' name='writerItem' onchange=""ToWriter('')"">"&_
				"")

				Set sourceexe = conobj.execute("select TP_theme from OT_type where TP_type='writer' order by TP_rank ASC")
					Do Until sourceexe.EOF
						response.write(_
						"<option value="""& Replace(sourceexe("TP_theme"),"{%称呼%}",memberexe("MB_realname")) &""">"& sourceexe("TP_theme") &"</option>"&_
						"")
					sourceexe.movenext()
					Loop
				sourceexe.close
				Set sourceexe=Nothing
				response.write(_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>"& IsWriteRepSign(true) &"分类：</td>"&_
			"<td align='left'>"&_
				"<select id='typeStr' name='typeStr'>"&_
				"<option value=''></option>"&_
				"<option value='announ' "& IsSelected(IF_typeStr,"announ") &">0、"& SYS_homeAnnounName &"</option>"&_
				"")
				typeNum = 0
				Set typeexe=conobj.execute("select IT_ID,IT_theme from OT_infoType where IT_level=1 and IT_mode='item' order by IT_rank ASC")
					Do Until typeexe.EOF
						typeNum = typeNum + 1
						Set type2exe=conobj.execute("select IT_ID,IT_theme from OT_infoType where IT_level=2 and IT_fatID="& typeexe("IT_ID") &" and IT_mode='item' order by IT_rank ASC")
							If type2exe.EOF Then
						response.write(_
						"<option value=',"& typeexe("IT_ID") &",' "& IsInstrSelected(IF_typeStr,","& typeexe("IT_ID") &",") &">"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
						"")
							Else
						response.write(_
						"<optgroup label='"& typeNum &"、"& typeexe("IT_theme") &"' style='font-weight:normal;'></optgroup>"&_
						"")
							End If
							Do Until type2exe.EOF
								response.write(_
								"<option value=',"& typeexe("IT_ID") &","& type2exe("IT_ID") &",' "& IsInstrSelected(IF_typeStr,","& type2exe("IT_ID") &",") &">&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								"")
							type2exe.movenext()
							Loop
						type2exe.close

					typeexe.movenext()
					Loop
				typeexe.close
				Set typeexe=Nothing
				response.write(_
				"</select>&nbsp;"&_
				"<span class='font2_2'>如果有二级分类,一级分类不能选择</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>外部链接：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='webURL' name='webURL' size='50' style='width:400px;' value="""& IF_URL &""" />&nbsp;"&_
				"<span class='font2_2'>非外部链接请留空</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>"& IsWriteRepSign(true) &"内容：</td>"&_
			"<td align='left'>"&_
			"")
				' 插入编辑器
				Dim editor
				Set editor = new CKEditor
				editor.basePath = "ckeditor/"
				editor.editor "content", IF_content

			response.write(_
			"<input type='hidden' id='imgDir' name='imgDir' value="""& InfoImgDir &""" />"&_
			"<input type='hidden' id='imgAdminDir' name='imgAdminDir' value="""& InfoImgAdminDir &""" />"&_
			"<input type='hidden' id='upImgStr' name='upImgStr' value="""& IF_upImgStr &""" />"&_
			"<input type='button' onclick=""OT_OpenUpImg('editor','content','','')"" value='上传图片载入编辑器' />"&_
			"&nbsp;<input type='button' onclick=""InsertStrToEditor('content','[OT_page]')"" value='插入分页符' />"&_
			"&nbsp;<input type='button' onclick=""SetEditorHtml('content',GetEditorHTML('content').replace(/<a (.*?)>(.*?)<\/a>/gi,'$2'))"" value='清除所有超链接' />"&_
			"&nbsp;&nbsp;&nbsp;&nbsp;<label class='font3_2B'><input type='checkbox' name='isSaveImg' value='1'>保存内容中的图片到本地</label>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>自动分页字数：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='pageNum' name='pageNum' size='50' style='width:50px;' value="""& IF_pageNum &""" />"&_
				"&nbsp;<span class='font2_2'>页数=内容总字数÷自动分页字数；如果在内容中加入了手动分页符或不想分页,请填写0或留空</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>关键词(标签)：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='themeKey' name='themeKey' size='50' style='width:400px;' value="""& IF_themeKey &""" />"&_
				"&nbsp;&nbsp;<a href='javascript:void(0);' onclick='GetDzKeyWord();return false;' class='font1_2' style='text-decoration:underline;'>网络自动获取</a>"&_
				"&nbsp;&nbsp;<a href='javascript:void(0);' onclick='GetKeyWord();return false;' class='font1_2' style='text-decoration:underline;'>本地自动获取</a>"&_
				"&nbsp;<span id='onloadThemeKey' class='font3_2'></span>"&_
				"<br /><span class='font2_2'>多个关键词用空格、竖杆“|”或逗号“,”隔开</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>内容摘要：</td>"&_
			"<td align='left'>"&_
				"<textarea id='contentKey' name='contentKey' rows='5' cols='40' style='width:400px; height:80px;'>"& IF_contentKey &"</textarea>"&_
				"&nbsp;<a href='javascript:void(0);' onclick='ToContentKey();return false;' class='font1_2' style='text-decoration:underline;'>自动获取</a>"&_
				"&nbsp;<span class='font2_2'>若为空则自动获取</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>附件：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='file' name='file' size='50' style='width:320px;' value="""& IF_file &""" />"&_
				"<input type='button' onclick=""OT_OpenUpFile('input','file','download','')"" value='上传附件' />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;附件名称：<input type='text' id='fileName' name='fileName' size='50' style='width:140px;' value="""& IF_fileName &""" /><span class='font2_2'>(可选)</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>文章属性：</td>"&_
			"<td align='left'>"&_
				"<label title='已审核的文章才会在前台显示'><input type='checkbox' id='isAudit' name='isAudit' onclick='CheckAddition()' value='1' "& IsChecked(IF_isAudit,1) &" />已审核</label>&nbsp;&nbsp;"&_
				"<label title='出现在前台最新消息处'><input type='checkbox' id='isNew' name='isNew' onclick='CheckAddition()' value='1' "& IsChecked(IF_isNew,1) &" />最新消息</label>&nbsp;&nbsp;"&_
				"<label title='首页栏目显示图片文章需要此属性，同时所属栏目【在首页显示图片文章】需要开启'><input type='checkbox' id='isHomeThumb' name='isHomeThumb' onclick='CheckAddition()' value='1' "& IsChecked(IF_isHomeThumb,1) &" />首页缩略图</label>&nbsp;&nbsp;"&_
				"<label title='列表页中显示'><input type='checkbox' id='isThumb' name='isThumb' onclick='CheckAddition()' value='1' "& IsChecked(IF_isThumb,1) &" />缩略图</label>&nbsp;&nbsp;"&_
				"<label title='首页左上角幻灯片'><input type='checkbox' id='isFlash' name='isFlash' onclick='CheckAddition()' value='1' "& IsChecked(IF_isFlash,1) &" />幻灯片</label>&nbsp;&nbsp;"&_
				"<label title='首页中部滚动图片'><input type='checkbox' id='isImg' name='isImg' onclick='CheckAddition()' value='1' "& IsChecked(IF_isImg,1) &" />滚动图片</label>&nbsp;&nbsp;"&_
				"<label title='页头滚动信息'><input type='checkbox' id='isMarquee' name='isMarquee' onclick='CheckAddition()' value='1' "& IsChecked(IF_isMarquee,1) &" />滚动信息</label>&nbsp;&nbsp;"&_
				"<label title='出现在精彩推荐/本类推荐里'><input type='checkbox' id='isRecom' name='isRecom' onclick='CheckAddition()' value='1' "& IsChecked(IF_isRecom,1) &" />推荐</label>&nbsp;&nbsp;"&_
				"<label title='出现在最新消息第一条及列表页前几条'><input type='checkbox' id='isTop' name='isTop' onclick='CheckAddition()' value='1' "& IsChecked(IF_isTop,1) &" />置顶</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='imgBox' style='display:none;'>"&_
			"<td align='right' valign='top' style='padding-top:6px;'>缩略图/图片：</td>"&_
			"<td align='left'>"&_
				"<input type='text' id='img' name='img' size='50' style='width:320px;' value="""& IF_img &""" />"&_
				"<span style='position:relative;'><span style='position:absolute; left:-200px; top:22px;'><img id='imgView' src='' width='200' style='display:none;' onerror=""this.src='images/noPic2.gif';"" /></span></span>"&_
				"<input type='button' onclick=""OT_OpenUpImg('input','img','info','')"" value='上传图片' />"&_
				"&nbsp;<a href='javascript:void(0);' onclick='GetEditorImg();return false;' class='font1_2' style='text-decoration:underline;'>从编辑器中获取</a>"&_
				"&nbsp;&nbsp;<span class='font2_2'>(可使用外部图片链接http://)</span>"&_
				"<div id='editorImgBox'></div>"&_
			"</td>"&_
		"</tr>"&_
		"")
			If SYS_isNewsVote>0 Then
		response.write(_
		"<tr>"&_
			"<td align='right'>投票方式：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' id='voteMode0' name='voteMode' onclick='CheckVote()' value='0' "& IsChecked(IF_voteMode,0) &" />关闭</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' id='voteMode1' name='voteMode' onclick='CheckVote()' value='1' "& IsChecked(IF_voteMode,1) &" />心情</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' id='voteMode2' name='voteMode' onclick='CheckVote()' value='2' "& IsChecked(IF_voteMode,2) &" />顶踩</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='vote1Box' style='display:none;'>"&_
			"<td align='right'>心情投票：</td>"&_
			"<td align='left'>"&_
				"支持<input type='text' id='voteItem1' name='voteItem1' size='50' style='width:30px;' value="""& voteItemArr(0) &""" />&nbsp;&nbsp;"&_
				"感动<input type='text' id='voteItem2' name='voteItem2' size='50' style='width:30px;' value="""& voteItemArr(1) &""" />&nbsp;&nbsp;"&_
				"惊讶<input type='text' id='voteItem3' name='voteItem3' size='50' style='width:30px;' value="""& voteItemArr(2) &""" />&nbsp;&nbsp;"&_
				"同情<input type='text' id='voteItem4' name='voteItem4' size='50' style='width:30px;' value="""& voteItemArr(3) &""" />&nbsp;&nbsp;"&_
				"流汗<input type='text' id='voteItem5' name='voteItem5' size='50' style='width:30px;' value="""& voteItemArr(4) &""" />&nbsp;&nbsp;"&_
				"鄙视<input type='text' id='voteItem6' name='voteItem6' size='50' style='width:30px;' value="""& voteItemArr(5) &""" />&nbsp;&nbsp;"&_
				"愤怒<input type='text' id='voteItem7' name='voteItem7' size='50' style='width:30px;' value="""& voteItemArr(6) &""" />&nbsp;&nbsp;"&_
				"难过<input type='text' id='voteItem8' name='voteItem8' size='50' style='width:30px;' value="""& voteItemArr(7) &""" />&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr id='vote2Box' style='display:none;'>"&_
			"<td align='right'>顶踩投票：</td>"&_
			"<td align='left'>"&_
				"顶一下<input type='text' id='voteItem11' name='voteItem11' size='50' style='width:30px;' value="""& voteItemArr(0) &""" />&nbsp;&nbsp;"&_
				"踩一下<input type='text' id='voteItem12' name='voteItem12' size='50' style='width:30px;' value="""& voteItemArr(1) &""" />&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"")
			End If
		response.write(_
		"<tr>"&_
			"<td align='right'>相关文章：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isMarkNews' value='1' "& IsChecked(IF_isMarkNews,1) &" />开启</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isMarkNews' value='0' "& IsChecked(IF_isMarkNews,0) &" />关闭</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"")
			If SYS_isNewsReply>0 Then
		response.write(_
		"<tr>"&_
			"<td align='right'>评论区：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='isReply' value='1' "& IsChecked(IF_isReply,1) &" />开启</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='isReply' value='0' "& IsChecked(IF_isReply,0) &" />关闭</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"")
			End If
		response.write(_
		"<tr>"&_
			"<td align='right'>附加内容：</td>"&_
			"<td align='left'>"&_
				"<select id='addiID' name='addiID'>"&_
				"<option value='0'>无</option>"&_
				"")
				Set addiexe=conobj.execute("select IW_ID,IW_theme from OT_infoWeb where IW_type='"& dataType &"' order by IW_rank ASC")
					Do Until addiexe.EOF
						response.write(_
						"<option value='"& addiexe("IW_ID") &"' "& IsInstrSelected(IF_addiID,addiexe("IW_ID")) &">"& addiexe("IW_theme") &"</option>"&_
						"")
					addiexe.movenext()
					Loop
				addiexe.close
				Set addiexe=Nothing
				response.write(_
				"</select>&nbsp;"&_
				"&nbsp;<span class='font2_2'>放在内容最下面，如转载申明</span>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>查看次数：</td>"&_
			"<td align='left'><input type='text' id='readNum' name='readNum' size='50' style='width:50px;' value="""& IF_readNum &""" /></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>状态：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' name='state' value='1' "& IsChecked(IF_state,1) &" />显示</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' name='state' value='0' "& IsChecked(IF_state,0) &" />隐藏</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>仅限会员阅读：</td>"&_
			"<td align='left'>"&_
				"<label><input type='radio' id='isCheckUser1' name='isCheckUser' value='1' "& IsChecked(IF_isCheckUser,1) &" onclick='CheckIsCheckUser()' />开启</label>&nbsp;&nbsp;"&_
				"<label><input type='radio' id='isCheckUser0' name='isCheckUser' value='0' "& IsChecked(IF_isCheckUser,0) &" onclick='CheckIsCheckUser()' />关闭</label>&nbsp;&nbsp;"&_
			"</td>"&_
		"</tr>"&_
		"</table>"&_
		"")

		If US_isScore1=1 Then score1ColCss="" Else score1ColCss="display:none;"
		If US_isScore2=1 Then score2ColCss="" Else score2ColCss="display:none;"
		If US_isScore3=1 Then score3ColCss="" Else score3ColCss="display:none;"
		If US_isScore4=1 Then score4ColCss="" Else score4ColCss="display:none;"
		If US_isScore5=1 Then score5ColCss="" Else score5ColCss="display:none;"
		response.write(_
		"<table id='userScoreK' align='left' cellpadding='0' cellspacing='0' summary='' class='padd3' style='margin-top:10px;display:none;'>"&_
		"<colgroup>"&_
			"<col></col>"&_
			"<col style='"& score1ColCss &"'></col>"&_
			"<col style='"& score2ColCss &"'></col>"&_
			"<col style='"& score3ColCss &"'></col>"&_
			"<col style='"& score4ColCss &"'></col>"&_
			"<col style='"& score5ColCss &"'></col>"&_
		"</colgroup>"&_
		"<tr>"&_
			"<td style='width:100px;' align='right'></td>"&_
			"<td align='center'>"& US_score1Name &"</td>"&_
			"<td align='center'>"& US_score2Name &"</td>"&_
			"<td align='center'>"& US_score3Name &"</td>"&_
			"<td align='center'>"& US_score4Name &"</td>"&_
			"<td align='center'>"& US_score5Name &"</td>"&_
			"<td align='center'></td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>查看积分：</td>"&_
			"<td align='center'><input type='text' id='score1' name='score1' value='"& IF_score1 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='score2' name='score2' value='"& IF_score2 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='score3' name='score3' value='"& IF_score3 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='score4' name='score4' value='"& IF_score4 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='score5' name='score5' value='"& IF_score5 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'>"&_
				"<input type='hidden' id='userLevel' name='userLevel' value='"& IF_userLevel &"' />"&_
				"<select id='userLevelStr' name='userLevelStr' onchange='SetUserLevel();'>"&_
					"<option value=''>查看等级限制</option>"&_
					"")
					Set levexe=conobj.execute("select UL_num,UL_score1,UL_score2,UL_score3,UL_score4,UL_score5 from OT_userLevel order by UL_score1 ASC")
						Do Until levexe.EOF
							response.write("<option value='"& levexe("UL_num") &"|"& levexe("UL_score1") &"|"& levexe("UL_score2") &"|"& levexe("UL_score3") &"|"& levexe("UL_score4") &"|"& levexe("UL_score5") &"'>等级："& levexe("UL_num") &"</option>")
						levexe.movenext()
						Loop
					levexe.close
					Set levexe=Nothing
				response.write(_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='right'>阅读扣积分：</td>"&_
			"<td align='center'><input type='text' id='cutScore1' name='cutScore1' value='"& IF_cutScore1 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='cutScore2' name='cutScore2' value='"& IF_cutScore2 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='cutScore3' name='cutScore3' value='"& IF_cutScore3 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='cutScore4' name='cutScore4' value='"& IF_cutScore4 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'><input type='text' id='cutScore5' name='cutScore5' value='"& IF_cutScore5 &"' size='3' onkeyUp='this.value=FiltInt(this.value)' /></td>"&_
			"<td align='center'></td>"&_
		"</tr>"&_
		"</table>"&_
		"")
	Call ShareTableBottom()


	response.write(_
	"<table style='height:16px;' cellpadding='0' cellspacing='0' summary=''><tr><td></td></tr></table>"&_

	"<center><input type='image' src='images/button_"& mudi &".gif' /></center>"&_

	"</form>"&_
	"")


	If mudi="rev" Then
		response.write("<br /><center><a href='javascript:void(0);' onclick='history.back();' class='font2_1'>【返回】</a></center>")
	End If
End Sub









'查询信息
Private Sub manage()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	refTypeStr	= ToGetStr("refTypeStr")
		If refTypeStr<>"" And refTypeStr<>"announ" Then refTypeStr=","& RegExpStr(refTypeStr,"sql") &","
	refAddition	= ToGetRegExpStr("refAddition","sql")
	refState	= ToGetInt2("refState",-1)
	refTheme	= ToGetRegExpStr("refTheme","sql")
	refSource	= ToGetRegExpStr("refSource","sql")
	refWriter	= ToGetRegExpStr("refWriter","sql")
	refDate1	= ToGetStr("refDate1")
		If IsDate(refDate1)=False Then refDate1=""
	refDate2	= ToGetStr("refDate2")
		If IsDate(refDate2)=False Then refDate2=""

'	SQLstr="select IF_ID,IF_theme,IF_themeColor,IF_themeStyle,IF_typeStr,IF_isAudit,IF_isNew,IF_isHomeThumb,IF_isThumb,IF_isImg,IF_isFlash,IF_isMarquee,IF_isRecom,IF_isTop,IF_time,IF_readNum,IF_state from OT_info where IF_type='"& SqlForStr(dataType) &"'"
	SQLstr="select IF_ID,IF_time,IF_theme,IF_themeColor,IF_themeStyle,IF_typeStr,IF_img,IF_isAudit,IF_isNew,IF_isHomeThumb,IF_isThumb,IF_isImg,IF_isFlash,IF_isMarquee,IF_isRecom,IF_isTop,IF_readNum,IF_state from OT_info where 1=1"

	If refTypeStr<>"" Then SQLstr=SQLstr &" and IF_typeStr like '%"& SqlForStr(refTypeStr) &"%'"
	If refAddition<>"" Then
		Select Case refAddition
			Case "audit1"
				SQLstr=SQLstr &" and IF_isAudit=1"
			Case "audit0"
				SQLstr=SQLstr &" and IF_isAudit=0"
			Case "new1"
				SQLstr=SQLstr &" and IF_isNew=1"
			Case "new0"
				SQLstr=SQLstr &" and IF_isNew=0"
			Case "homeThumb1"
				SQLstr=SQLstr &" and IF_isHomeThumb=1"
			Case "homeThumb0"
				SQLstr=SQLstr &" and IF_isHomeThumb=0"
			Case "thumb1"
				SQLstr=SQLstr &" and IF_isThumb=1"
			Case "thumb0"
				SQLstr=SQLstr &" and IF_isThumb=0"
			Case "flash1"
				SQLstr=SQLstr &" and IF_isFlash=1"
			Case "flash0"
				SQLstr=SQLstr &" and IF_isFlash=0"
			Case "img1"
				SQLstr=SQLstr &" and IF_isImg=1"
			Case "img0"
				SQLstr=SQLstr &" and IF_isImg=0"
			Case "marquee1"
				SQLstr=SQLstr &" and IF_isMarquee=1"
			Case "marquee0"
				SQLstr=SQLstr &" and IF_isMarquee=0"
			Case "recom1"
				SQLstr=SQLstr &" and IF_isRecom=1"
			Case "recom0"
				SQLstr=SQLstr &" and IF_isRecom=0"
			Case "top1"
				SQLstr=SQLstr &" and IF_isTop=1"
			Case "top0"
				SQLstr=SQLstr &" and IF_isTop=0"
		End Select
	End If
	If refState>-1 Then SQLstr=SQLstr &" and IF_state="& refState
	If refTheme<>"" Then SQLstr=SQLstr &" and IF_theme like '%"& SqlForStr(refTheme) &"%'"
	If refSource<>"" Then SQLstr=SQLstr &" and IF_source like '%"& SqlForStr(refSource) &"%'"
	If refWriter<>"" Then SQLstr=SQLstr &" and IF_writer like '%"& SqlForStr(refWriter) &"%'"
	If refDate1<>"" Then SQLstr=SQLstr &" and IF_time>="& SqlForTime(refDate1)
	If refDate2<>"" Then SQLstr=SQLstr &" and IF_time<="& SqlForTime(DateAdd("d",1,refDate2))
	'If refDate2<>"" Then SQLstr=SQLstr &" and IF_time<="&SQLpartTime & refDate2 & SQLpartTime

	orderName=ToGetStr("orderName")
		If orderName<>"theme" And orderName<>"readNum" And orderName<>"typeStr" And orderName<>"state" And orderName<>"time" And orderName<>"ID" Then orderName="time"
	orderSort=ToGetStr("orderSort")
		If orderSort<>"ASC" Then orderSort="DESC"

	'response.write SQLstr
	'response.end

	moveOptionStr = ""
	Call ShareTableTop("share_refer.gif","",dataTypeCN &"查询")
		response.write(_
		"<form name='refForm' method='get' action=''>"&_
		"<input type='hidden' name='mudi' value='"& mudi &"' />"&_
		"<input type='hidden' name='dataType' value='"& dataType &"' />"&_
		"<input type='hidden' name='dataTypeCN' value='"& dataTypeCN &"' />"&_

		"<table width='98%' align='center' border='0' cellSpacing='0' cellPadding='0' summary='' class='padd5'>"&_
		"<tr>"&_
			"<td style='width:35%;'>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分类："&_
				"<select id='refTypeStr' name='refTypeStr'>"&_
				"<option value=''></option>"&_
				"<option value='announ' "& IsSelected(refTypeStr,"announ") &">0、"& SYS_homeAnnounName &"</option>"&_
				"")
				moveOptionStr = moveOptionStr &_
				"<option value='announ'>0、"& SYS_homeAnnounName &"</option>"&_
				""
				typeNum = 0
				Set typeexe=conobj.execute("select IT_ID,IT_theme from OT_infoType where IT_level=1 order by IT_rank ASC")
					Do Until typeexe.EOF
						typeNum = typeNum + 1
						Set type2exe=conobj.execute("select IT_ID,IT_theme from OT_infoType where IT_level=2 and IT_fatID="& typeexe("IT_ID") &" order by IT_rank ASC")
							If type2exe.EOF Then
						moveOptionStr = moveOptionStr &_
						"<option value=',"& typeexe("IT_ID") &",'>"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
						""
							Else
						moveOptionStr = moveOptionStr &_
						"<optgroup label='"& typeNum &"、"& typeexe("IT_theme") &"' style='font-weight:normal;'></optgroup>"&_
						""
							End If
							response.write(_
							"<option value='"& typeexe("IT_ID") &"' "& IsInstrSelected(refTypeStr,","& typeexe("IT_ID") &",") &">"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
							"")
							Do Until type2exe.EOF
								moveOptionStr = moveOptionStr &_
								"<option value=',"& typeexe("IT_ID") &","& type2exe("IT_ID") &",'>&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								""
								response.write(_
								"<option value='"& type2exe("IT_ID") &"' "& IsSelected(refTypeStr,","& type2exe("IT_ID") &",") &">&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								"")
							type2exe.movenext()
							Loop
						type2exe.close

					typeexe.movenext()
					Loop
				typeexe.close
				Set typeexe=Nothing
				response.write(_
				"</select>&nbsp;"&_
			"</td>"&_
			"<td style='width:25%;'>"&_
				"来源：<input type='text' name='refSource' size='14' value='"& refSource &"' />"&_
			"</td>"&_
			"<td style='width:40%;'>"&_
				"属性："&_
				"<select id='refAddition' name='refAddition'>"&_
				"<option value=''></option>"&_
				"<option value='audit1' style='color:#0066CC;' "& IsSelected(refAddition,"audit1") &">已审核√</option>"&_
				"<option value='audit0' style='color:#707070;' "& IsSelected(refAddition,"audit0") &">已审核ㄨ</option>"&_
				"<option value='new1' style='color:#0066CC;' "& IsSelected(refAddition,"new1") &">最新消息√</option>"&_
				"<option value='new0' style='color:#707070;' "& IsSelected(refAddition,"new0") &">最新消息ㄨ</option>"&_
				"<option value='homeThumb1' style='color:#0066CC;' "& IsSelected(refAddition,"homeThumb1") &">首页缩略图√</option>"&_
				"<option value='homeThumb0' style='color:#707070;' "& IsSelected(refAddition,"homeThumb0") &">首页缩略图ㄨ</option>"&_
				"<option value='thumb1' style='color:#0066CC;' "& IsSelected(refAddition,"thumb1") &">缩略图√</option>"&_
				"<option value='thumb0' style='color:#707070;' "& IsSelected(refAddition,"thumb0") &">缩略图ㄨ</option>"&_
				"<option value='flash1' style='color:#0066CC;' "& IsSelected(refAddition,"flash1") &">幻灯片√</option>"&_
				"<option value='flash0' style='color:#707070;' "& IsSelected(refAddition,"flash0") &">幻灯片ㄨ</option>"&_
				"<option value='img1' style='color:#0066CC;' "& IsSelected(refAddition,"img1") &">滚动图片√</option>"&_
				"<option value='img0' style='color:#707070;' "& IsSelected(refAddition,"img0") &">滚动图片ㄨ</option>"&_
				"<option value='marquee1' style='color:#0066CC;' "& IsSelected(refAddition,"marquee1") &">滚动信息√</option>"&_
				"<option value='marquee0' style='color:#707070;' "& IsSelected(refAddition,"marquee0") &">滚动信息ㄨ</option>"&_
				"<option value='recom1' style='color:#0066CC;' "& IsSelected(refAddition,"recom1") &">推荐√</option>"&_
				"<option value='recom0' style='color:#707070;' "& IsSelected(refAddition,"recom0") &">推荐ㄨ</option>"&_
				"<option value='top1' style='color:#0066CC;' "& IsSelected(refAddition,"top1") &">置顶√</option>"&_
				"<option value='top0' style='color:#707070;' "& IsSelected(refAddition,"top0") &">置顶ㄨ</option>"&_
				"</select>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;状态："&_
				"<select id='refState' name='refState'>"&_
				"<option value=''></option>"&_
				"<option value='1' "& IsSelected(refState,1) &">显示</option>"&_
				"<option value='0' "& IsSelected(refState,0) &">隐藏</option>"&_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标题：<input type='text' name='refTheme' size='20' value='"& refTheme &"' />"&_
			"</td>"&_
			"<td>"&_
				"作者：<input type='text' name='refWriter' size='14' value='"& refWriter &"' />"&_
			"</td>"&_
			"<td>"&_
				"发布日期：<input type='text' name='refDate1' size='10' value='"& refDate1 &"' onfocus=""WdatePicker()"" />&nbsp;"&_
				"至&nbsp;<input type='text' name='refDate2' size='10' value='"& refDate2 &"' onfocus=""WdatePicker()"" />"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='center' style='padding:5px;padding-top:20px' colspan='3'>"&_
				"<input type='image' src='images/button_refer.gif' />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<img src='images/button_reset.gif' onclick=""document.location.href='?mudi="& mudi &"&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"'"" style='cursor:pointer' alt='' />"&_
			"</td>"&_
		"</tr>"&_
		"</table>"&_
		"</form>"&_
		"")

	Call ShareTableBottom()


	response.write(_
	"<br />"&_

	"<form id='listForm' name='listForm' method='post' action='info_deal.asp?mudi=moreDel' onsubmit='return CheckListForm()'>"&_
	"<script language='javascript' type='text/javascript'>document.write (""<input type='hidden' name='URL' value='""+ document.location.href +""' />"")</script>"&_
	"<input type='hidden' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"")

	Call ShareTableTop2("share_list.gif","",dataTypeCN &"列表")
	response.write(_
	"<colsgroup>"&_
		"<col>"&_
		"<col>"&_
		"<col>"&_
		"<col>"&_
		"<col>"&_
		"<col>"&_
		"<col>"&_
		"<col style='display:;'>"&_
	"</colsgroup>"&_
	"")
	Call ShareTableItemTitle("4%,5%,5%,26%,13%,13%,10%,6%,6%,13%","<input type='checkbox' name='selAll' onclick='CheckBoxAll()' />,序号,"& ShowArrow("ID","ID",orderName,orderSort) &","& ShowArrow("标题","theme",orderName,orderSort) &",属性,分类,"& ShowArrow("发布日期","time",orderName,orderSort) &","& ShowArrow("查看数","readNum",orderName,orderSort) &","& ShowArrow("状态","state",orderName,orderSort) &",预览&nbsp;修改&nbsp;删除")


	Set showrec=server.CreateObject("ADODB.recordset")
	showrec.open SQLstr &" order by IF_"& orderName &" "& orderSort &"",conobj,3,1
		If showrec.EOF Then
			response.write("</table><br /><center class='font1_1'>暂无内容</center>")
			response.End
		End If
			showPageSize=memberexe("MB_itemNum")		'每页条数
			showrec.pagesize=showPageSize	
			showPageCount=showrec.pagecount
			showCount=showrec.recordcount
			page=ToGetInt("page")
			if page < 1 Or page > showPageCount Then page=1
			showrec.absolutepage=page


		response.write(_
		"<tbody class='tabBody padd3'>"&_
		"")
		number=1+(page-1)*showPageSize
		For i=1 To showPageSize
			If showrec.EOF Then Exit For
			If i Mod 2 = 0 Then bgcolor="class='tabColorTr'" Else bgcolor=""
			If Len(""& showrec("IF_img"))>0 Then
				If Left(showrec("IF_img"),7)="http://" Then
					imgStr="&nbsp;<a href='"& showrec("IF_img") &"' target='_blank'><img src='images/imgAlt2.gif' alt='远程缩略图' /></a>"
				Else
					imgStr="&nbsp;<a href='"& InfoImgAdminDir & showrec("IF_img") &"' target='_blank'><img src='images/imgAlt.gif' alt='本地缩略图' /></a>"
				End If
			Else
				imgStr=""
			End If

		response.write(_
		"<tr "& bgcolor &" id='data"& showrec("IF_ID") &"'>"&_
			"<td align='center'><input type='checkbox' name='selDataID' value='"& showrec("IF_ID") &"' /></td>"&_
			"<td align='center'>"& number &"</td>"&_
			"<td align='center'>"& showrec("IF_ID") &"</td>"&_
			"<td align='left' style='color:"& showrec("IF_themeColor") &"'>"& showrec("IF_theme") & imgStr &"</td>"&_
			"<td align='center' style='line-height:1.4;'>"& Info_AddiBtn(showrec("IF_ID"),showrec("IF_isAudit"),showrec("IF_isNew"),showrec("IF_isHomeThumb"),showrec("IF_isThumb"),showrec("IF_isImg"),showrec("IF_isFlash"),showrec("IF_isMarquee"),showrec("IF_isRecom"),showrec("IF_isTop")) &"<br /></td>"&_
			"<td align='left'>"& Info_TypeStrCN(showrec("IF_typeStr")) &"<br /></td>"&_
			"<td align='center'>"& showrec("IF_time") &"<br /></td>"&_
			"<td align='center'>"& showrec("IF_readNum") &"<br /></td>"&_
			"<td align='center'>"& ItemSwitch("OT_info",showrec("IF_ID"),showrec("IF_state"),"state","") &"<br /></td>"&_
			"<td align='center'>"&_
				"<img src='images/img_det.gif' style='cursor:pointer' onclick=""window.open('../newsShow.asp?dataID="& showrec("IF_ID") &"')"" alt='' />&nbsp;&nbsp;"&_
				"<img src='images/img_rev.gif' style='cursor:pointer' onclick=""document.location.href='?mudi=rev&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataID="& showrec("IF_ID") &"&backURL='+ escape(document.location.href)"" alt='' />&nbsp;&nbsp;"&_
				"<img src='images/img_del.gif' style='cursor:pointer' onclick=""if(confirm('你确定要删除？')==true){DataDeal.location.href='info_deal.asp?mudi=del&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&theme="& server.URLEncode(showrec("IF_theme")) &"&dataID="& showrec("IF_ID") &"'}"" alt='' />"&_
			"</td>"&_
		"</tr>"&_
		"")
		showrec.movenext
		number=number+1
		Next
		response.write(_
		"</tbody>"&_
		"")
		response.write(_
		"<tr class='tabColorB padd5'>"&_
			"<td align='left' colspan='20'>"&_
				"<input type='button' value='全选' onclick='AllSelBox()' class='form_button1' />"&_
				"<input type='button' value='反选' onclick='RevSelBox()' class='form_button1' />"&_
				"&nbsp;"&_
				"<input type='submit' value='批量删除' />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<select id='moreMoveTo' name='moreMoveTo' onchange='MoreMoveTo()'><option value=''>批量移动到...</option>"& moveOptionStr &"</select>"&_
				"<input type='hidden' id='moreMoveToCN' name='moreMoveToCN' value='' />"&_
			"</td>"&_
		"</tr>"&_
		"")
	showrec.close
	Set showrec=Nothing
	response.write(_
	"</form>")

	Call ShareTableBottom2()
End Sub






'查询信息
Private Sub manage2()
	dataMode	= ToGetStr("dataMode")
	dataModeStr	= ToGetStr("dataModeStr")

	refTypeStr	= ToGetStr("refTypeStr")
		If refTypeStr<>"" And refTypeStr<>"announ" Then refTypeStr=","& RegExpStr(refTypeStr,"sql") &","
	refAddition	= ToGetRegExpStr("refAddition","sql")
	refState	= ToGetInt2("refState",-1)
	refTheme	= ToGetRegExpStr("refTheme","sql")
	refDate1	= ToGetStr("refDate1")
		If IsDate(refDate1)=False Then refDate1=""
	refDate2	= ToGetStr("refDate2")
		If IsDate(refDate2)=False Then refDate2=""

'	SQLstr="select IF.*,UE.UE_username,UE.UE_realname from (select * from OT_info where IF_type='"& SqlForStr(dataType) &"' and IF_userID>=1) as IF left join OT_users as UE on IF.IF_userID=UE.UE_ID where (1=1)"
	SQLstr="select IF.*,UE.UE_username,UE.UE_realname from (select IF_ID,IF_time,IF_theme,IF_img,IF_themeColor,IF_typeStr,IF_isAudit,IF_isNew,IF_isHomeThumb,IF_isThumb,IF_isFlash,IF_isImg,IF_isMarquee,IF_isRecom,IF_isTop,IF_state,IF_readNum,IF_userID from OT_info where IF_userID>=1) as IF left join OT_users as UE on IF.IF_userID=UE.UE_ID where (1=1)"

	If refTypeStr<>"" Then SQLstr=SQLstr &" and IF_typeStr like '%"& SqlForStr(refTypeStr) &"%'"
	If refAddition<>"" Then
		Select Case refAddition
			Case "audit1"
				SQLstr=SQLstr &" and IF_isAudit=1"
			Case "audit0"
				SQLstr=SQLstr &" and IF_isAudit=0"
			Case "new1"
				SQLstr=SQLstr &" and IF_isNew=1"
			Case "new0"
				SQLstr=SQLstr &" and IF_isNew=0"
			Case "homeThumb1"
				SQLstr=SQLstr &" and IF_isHomeThumb=1"
			Case "homeThumb0"
				SQLstr=SQLstr &" and IF_isHomeThumb=0"
			Case "thumb1"
				SQLstr=SQLstr &" and IF_isThumb=1"
			Case "thumb0"
				SQLstr=SQLstr &" and IF_isThumb=0"
			Case "flash1"
				SQLstr=SQLstr &" and IF_isFlash=1"
			Case "flash0"
				SQLstr=SQLstr &" and IF_isFlash=0"
			Case "img1"
				SQLstr=SQLstr &" and IF_isImg=1"
			Case "img0"
				SQLstr=SQLstr &" and IF_isImg=0"
			Case "marquee1"
				SQLstr=SQLstr &" and IF_isMarquee=1"
			Case "marquee0"
				SQLstr=SQLstr &" and IF_isMarquee=0"
			Case "recom1"
				SQLstr=SQLstr &" and IF_isRecom=1"
			Case "recom0"
				SQLstr=SQLstr &" and IF_isRecom=0"
			Case "top1"
				SQLstr=SQLstr &" and IF_isTop=1"
			Case "top0"
				SQLstr=SQLstr &" and IF_isTop=0"
		End Select
	End If
	If refState>-1 Then SQLstr=SQLstr &" and IF_state="& refState
	If refTheme<>"" Then SQLstr=SQLstr &" and IF_theme like '%"& SqlForStr(refTheme) &"%'"
	If refDate1<>"" Then SQLstr=SQLstr &" and IF_time>="& SqlForTime(refDate1)
	If refDate2<>"" Then SQLstr=SQLstr &" and IF_time<="& SqlForTime(DateAdd("d",1,refDate2))
	'If refDate2<>"" Then SQLstr=SQLstr &" and IF_time<="&SQLpartTime & refDate2 & SQLpartTime

	orderName=ToGetStr("orderName")
		If orderName<>"theme" And orderName<>"readNum" And orderName<>"typeStr" And orderName<>"state" And orderName<>"time" And orderName<>"ID" Then orderName="time"
	orderSort=ToGetStr("orderSort")
		If orderSort<>"ASC" Then orderSort="DESC"

	'response.write SQLstr
	'response.end

	moveOptionStr = ""
	Call ShareTableTop("share_refer.gif","",dataTypeCN &"查询")
		response.write(_
		"<form name='refForm' method='get' action=''>"&_
		"<input type='hidden' name='mudi' value='"& mudi &"' />"&_
		"<input type='hidden' name='dataType' value='"& dataType &"' />"&_
		"<input type='hidden' name='dataTypeCN' value='"& dataTypeCN &"' />"&_

		"<table width='85%' align='center' border='0' cellSpacing='0' cellPadding='0' summary='' class='padd5'>"&_
		"<tr>"&_
			"<td style='width:50%;'>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分类："&_
				"<select id='refTypeStr' name='refTypeStr'>"&_
				"<option value=''></option>"&_
				"<option value='announ' "& IsSelected(refTypeStr,"announ") &">0、"& SYS_homeAnnounName &"</option>"&_
				"")
				moveOptionStr = moveOptionStr &_
				"<option value='announ'>0、"& SYS_homeAnnounName &"</option>"&_
				""
				typeNum = 0
				Set typeexe=conobj.execute("select * from OT_infoType where IT_level=1 order by IT_rank ASC")
					Do Until typeexe.EOF
						typeNum = typeNum + 1
						Set type2exe=conobj.execute("select * from OT_infoType where IT_level=2 and IT_fatID="& typeexe("IT_ID") &" order by IT_rank ASC")
							If type2exe.EOF Then
						moveOptionStr = moveOptionStr &_
						"<option value=',"& typeexe("IT_ID") &",'>"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
						""
							Else
						moveOptionStr = moveOptionStr &_
						"<optgroup label='"& typeNum &"、"& typeexe("IT_theme") &"' style='font-weight:normal;'></optgroup>"&_
						""
							End If
							response.write(_
							"<option value='"& typeexe("IT_ID") &"' "& IsInstrSelected(refTypeStr,","& typeexe("IT_ID") &",") &">"& typeNum &"、"& typeexe("IT_theme") &"</option>"&_
							"")
							Do Until type2exe.EOF
								moveOptionStr = moveOptionStr &_
								"<option value=',"& typeexe("IT_ID") &","& type2exe("IT_ID") &",'>&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								""
								response.write(_
								"<option value='"& type2exe("IT_ID") &"' "& IsSelected(refTypeStr,","& type2exe("IT_ID") &",") &">&nbsp;&nbsp;&nbsp;┣&nbsp;"& type2exe("IT_theme") &"</option>"&_
								"")
							type2exe.movenext()
							Loop
						type2exe.close

					typeexe.movenext()
					Loop
				typeexe.close
				Set typeexe=Nothing
				response.write(_
				"</select>&nbsp;"&_
			"</td>"&_
			"<td style='width:50%;'>"&_
				"审核："&_
				"<select id='refAddition' name='refAddition'>"&_
				"<option value=''></option>"&_
				"<option value='audit1' "& IsSelected(refAddition,"audit1") &">已审核</option>"&_
				"<option value='audit0' "& IsSelected(refAddition,"audit0") &">未审核</option>"&_
				"</select>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;状态："&_
				"<select id='refState' name='refState'>"&_
				"<option value=''></option>"&_
				"<option value='1' "& IsSelected(refState,1) &">显示</option>"&_
				"<option value='0' "& IsSelected(refState,0) &">隐藏</option>"&_
				"</select>"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td>"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标题：<input type='text' name='refTheme' size='20' value='"& refTheme &"' />"&_
			"</td>"&_
			"<td>"&_
				"发布日期：<input type='text' name='refDate1' size='10' value='"& refDate1 &"' onfocus=""WdatePicker()"" />&nbsp;"&_
				"至&nbsp;<input type='text' name='refDate2' size='10' value='"& refDate2 &"' onfocus=""WdatePicker()"" />"&_
			"</td>"&_
		"</tr>"&_
		"<tr>"&_
			"<td align='center' style='padding:5px;padding-top:20px' colspan='3'>"&_
				"<input type='image' src='images/button_refer.gif' />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<img src='images/button_reset.gif' onclick=""document.location.href='?mudi="& mudi &"&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"'"" style='cursor:pointer' alt='' />"&_
			"</td>"&_
		"</tr>"&_
		"</table>"&_
		"</form>"&_
		"")

	Call ShareTableBottom()


	response.write(_
	"<br />"&_

	"<form name='listForm' method='post' action='info_deal.asp?mudi=moreDel' onsubmit='return CheckListForm()'>"&_
	"<script language='javascript' type='text/javascript'>document.write (""<input type='hidden' name='URL' value='""+ document.location.href +""' />"")</script>"&_
	"<input type='hidden' name='dataType' value='"& dataType &"' />"&_
	"<input type='hidden' name='dataTypeCN' value='"& dataTypeCN &"' />"&_
	"")

	Call ShareTableTop2("share_list.gif","",dataTypeCN &"列表")
	Call ShareTableItemTitle("4%,5%,5%,26%,16%,10%,14%,7%,13%","<input type='checkbox' name='selAll' onclick='CheckBoxAll()' />,序号,"& ShowArrow("ID","ID",orderName,orderSort) &","& ShowArrow("标题","theme",orderName,orderSort) &",分类,"& ShowArrow("发布日期","time",orderName,orderSort) &","& ShowArrow("会员(姓名)","username",orderName,orderSort) &","& ShowArrow("审核","username",orderName,orderSort) &",预览&nbsp;修改&nbsp;删除")


	Set showrec=server.CreateObject("ADODB.recordset")
	showrec.open SQLstr &" order by IF_"& orderName &" "& orderSort &"",conobj,3,1
		If showrec.EOF Then
			response.write("</table><br /><center class='font1_1'>暂无内容</center>")
			response.End
		End If
			showPageSize=memberexe("MB_itemNum")		'每页条数
			showrec.pagesize=showPageSize	
			showPageCount=showrec.pagecount
			showCount=showrec.recordcount
			page=ToGetInt("page")
			if page < 1 Or page > showPageCount Then page=1
			showrec.absolutepage=page


		response.write(_
		"<tbody class='tabBody padd3'>"&_
		"")
		number=1+(page-1)*showPageSize
		For i=1 To showPageSize
			If showrec.EOF Then Exit For
			If i Mod 2 = 0 Then bgcolor="class='tabColorTr'" Else bgcolor=""
			If Len(""& showrec("IF_img"))>0 Then
				If Left(showrec("IF_img"),7)="http://" Then
					imgStr="&nbsp;<a href='"& showrec("IF_img") &"' target='_blank'><img src='images/imgAlt2.gif' alt='远程缩略图' /></a>"
				Else
					imgStr="&nbsp;<a href='"& InfoImgAdminDir & showrec("IF_img") &"' target='_blank'><img src='images/imgAlt.gif' alt='本地缩略图' /></a>"
				End If
			Else
				imgStr=""
			End If

		response.write(_
		"<tr "& bgcolor &" id='data"& showrec("IF_ID") &"'>"&_
			"<td align='center'><input type='checkbox' name='selDataID' value='"& showrec("IF_ID") &"' /></td>"&_
			"<td align='center'>"& number &"</td>"&_
			"<td align='center'>"& showrec("IF_ID") &"</td>"&_
			"<td align='left' style='color:"& showrec("IF_themeColor") &"'>"& showrec("IF_theme") & imgStr &"</td>"&_
			"<td align='left'>"& Info_TypeStrCN(showrec("IF_typeStr")) &"<br /></td>"&_
			"<td align='center'>"& showrec("IF_time") &"<br /></td>"&_
			"<td align='center'>"& showrec("UE_username") &"("& showrec("UE_realname") &")<br /></td>"&_
			"<td align='center'>"& ItemSwitchAddi("OT_info",showrec("IF_ID"),"已审核",showrec("IF_isAudit"),"isAudit","") &"<br /></td>"&_
			"<td align='center'>"&_
				"<img src='images/img_det.gif' style='cursor:pointer' onclick=""window.open('../newsShow.asp?dataID="& showrec("IF_ID") &"')"" alt='' />&nbsp;&nbsp;"&_
				"<img src='images/img_rev.gif' style='cursor:pointer' onclick=""document.location.href='?mudi=rev&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&dataMode="& dataMode &"&dataModeStr="& dataModeStr &"&dataID="& showrec("IF_ID") &"&backURL='+ escape(document.location.href)"" alt='' />&nbsp;&nbsp;"&_
				"<img src='images/img_del.gif' style='cursor:pointer' onclick=""if(confirm('你确定要删除？')==true){DataDeal.location.href='info_deal.asp?mudi=del&dataType="& dataType &"&dataTypeCN="& server.URLEncode(dataTypeCN) &"&theme="& server.URLEncode(showrec("IF_theme")) &"&dataID="& showrec("IF_ID") &"'}"" alt='' />"&_
			"</td>"&_
		"</tr>"&_
		"")
		showrec.movenext
		number=number+1
		Next
		response.write(_
		"</tbody>"&_
		"")
		response.write(_
		"<tr class='tabColorB padd5'>"&_
			"<td align='left' colspan='20'>"&_
				"<input type='button' value='全选' onclick='AllSelBox()' class='form_button1' />"&_
				"<input type='button' value='反选' onclick='RevSelBox()' class='form_button1' />"&_
				"&nbsp;"&_
				"<input type='submit' value='批量删除' />"&_
				"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&_
				"<select id='moreMoveTo' name='moreMoveTo' onchange='MoreMoveTo()'><option value=''>批量移动到...</option>"& moveOptionStr &"</select>"&_
				"<input type='hidden' id='moreMoveToCN' name='moreMoveToCN' value='' />"&_
			"</td>"&_
		"</tr>"&_
		"")
	showrec.close
	Set showrec=Nothing
	response.write(_
	"</form>")

	Call ShareTableBottom2()
End Sub

%>